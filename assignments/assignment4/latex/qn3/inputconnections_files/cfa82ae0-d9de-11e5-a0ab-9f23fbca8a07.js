(function(b,a){b.Contacts=a.extend(b.Contacts,{Apps:{},Models:{},Collections:{},Views:{},Routers:{},Templates:{},DataStore:{},Lix:{},Adapters:{}})})(window,_);(function(b,c){function f(h){var j=b.location.host,k=b.location.protocol,i="//"+j,g=k+i;return(h===g||h.slice(0,g.length+1)===g+"/")||(h===i||h.slice(0,i.length+1)===i+"/")||!(/^(\/\/|http:|https:).*/.test(h))}function e(g){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(g))}function a(h){var g=(c.readCookie("JSESSIONID")||"").replace(/"/g,"");h.setRequestHeader("X_CSRF_TOKEN",g);h.setRequestHeader("X_CONTEXT_ID",(window.Contacts.Lix.get("context-id")||"").replace(/"/g,""))}$(b).ajaxSend(function(h,i,g){if(!e(g.type)&&f(g.url)){a(i)}});var d=Backbone.sync;Backbone.sync=function(i,h,g){g.beforeSend=function(j){if(!e(i)&&f(_.result(h,"url"))){a(j)}};return d(i,h,g)}})(document,LI);(function(){var a={LINKEDIN_INTERNAL:"LinkedIn Internal",TWITTER_PUBLIC:"Twitter Public",FACEBOOK_PUBLIC:"Facebook Public",OUTLOOK_EWS:"Outlook Ews",OUTLOOK_CONTACTS:"Outlook Contacts",OUTLOOK_CALENDAR:"Outlook Calendar",OUTLOOK_MAIL:"Outlook Mail",GMAIL:"Gmail",GOOGLE:"Google",EMAIL:"Email",GOOGLE_CONTACTS:"Google Contacts",GOOGLE_CALENDAR:"Google Calendar",YAHOO:"Yahoo",YAHOO_CONTACTS:"Yahoo! Contacts",YAHOO_MAIL:"Yahoo! Mail"};var b={APPS_TAG_CONTACTS:"contacts-apps-tag-contacts",APPS_UNTAG_CONTACTS:"contacts-apps-untag-contacts",SERVICES_MERGED_CONTACTS:"contacts-services-merge-contacts",SEARCH:"contacts-search",CONTACTS:"contacts-contacts",MORE_CONTACTS:"contacts-more-contacts",APP_TAG_CREATE:"contacts-apps-tag-create",APP_TAG_ITEM:"contacts-apps-tag-item",APP_UNTAG_ITEM:"contacts-apps-untag-item",ENGAGE_EVENT_COMPLETE:"contacts-engage-event-complete",ENGAGE_EVENT_SKIP:"contacts-engage-event-skip",ENGAGE_EVENTS_SEE_MORE:"contacts-engage-events-see-more",DAILY_PEOPLE_NEWS_ARTICLE_LINK:"contacts-daily-people-news-article-link",DAILY_PROMO:"contacts-daily-promo",SERVICES_REMOVE_TAG:"contacts-services-remove-tag",SERVICES_RENAME_TAG:"contacts-services-rename-tag",MANAGE_SOURCES:"contacts-manage-sources",SERVICES_ADD_CONTACT:"contacts-services-add-contact",SYNC_PROMO:"contacts-sync-promo",SYNC_PROMO_IMPRESSION:"contacts-sync-promo-impression",SYNC_PROMO_CLOSE:"contacts-sync-promo-close",SYNC_PROMO_SYNC:"contacts-sync-promo-sync",SYNC_PROMO_LEARN_PROMO:"contacts-sync-promo-learn-more",TOUR_PROMO_STEP:"contacts-tour-promo-step",TOUR_PROMO_NEXT:"contacts-tour-promo-next",TOUR_PROMO_CLOSE:"contacts-tour-promo-close",TOUR_PROMO_END:"contacts-tour-promo-end",TOUR_PROMO_SYNC:"contacts-tour-promo-sync",TOUR_PROMO_CANCEL:"contacts-tour-promo-cancel",MOBILE_PROMO:"contacts-promo-connected",MOBILE_PROMO_IMPRESSION:"contacts-promo-connected-impression",MOBILE_PROMO_CLOSE:"contacts-promo-connected-close",MOBILE_PROMO_SEND:"contacts-promo-connected-send"};Contacts.Constants.SourceType=a;Contacts.Constants.PageKey=b})();(function(_t_){_t_["agenda/dialog"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="meetings-panel">\n</div>\n<div class="details-panel">\n</div>'}return __p};_t_["agenda/dialog/header"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="agendia-dialog-header">\n  <h3>'+((__t=(meeting.title))==null?"":_.escape(__t))+"</h3>\n  <div>\n    ";if(meeting.location){__p+='\n      <span class="location">'+((__t=(meeting.location))==null?"":_.escape(__t))+"</span>\n    "}__p+="\n    ";if(meeting.location){__p+='\n      <span class="pipe">&#65073;</span>\n    '}__p+="\n    ";var str="invitees";__p+="\n    ";if(meeting.contacts.length==1){__p+="\n      ";str="invitee";__p+="\n    "}__p+='\n    <span class="invitees">'+((__t=(meeting.contacts.length))==null?"":_.escape(__t))+" "+((__t=(str))==null?"":_.escape(__t))+' </span>\n    <span class="time">'+((__t=(moment(meeting.start_time).format("h:mm A")))==null?"":_.escape(__t))+" &#8211; "+((__t=(moment(meeting.end_time).format("h:mm A")))==null?"":__t)+"</span>\n  </div>\n</div>"}return __p};_t_["agenda/dialog/meeting"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="'+((__t=(meeting.index))==null?"":_.escape(__t))+'">\n  <span class="time">'+((__t=(moment(meeting.start_time).format("h:mm A")))==null?"":_.escape(__t))+" &#8211; "+((__t=(moment(meeting.end_time).format("h:mm A")))==null?"":_.escape(__t))+'</span>\n  <h4 class="subject">'+((__t=(meeting.title))==null?"":_.escape(__t))+"</h4>\n\n  ";if(meeting.location){__p+='\n    <span class="location">'+((__t=(meeting.location))==null?"":_.escape(__t))+"</span>\n  "}__p+="\n\n  ";if(meeting.location){__p+='\n    <span class="pipe">&#65073;</span>\n  '}__p+="\n\n  ";var str="invitees";__p+="\n  ";if(meeting.contacts.length===1){__p+="\n  ";str="invitee";__p+="\n  "}__p+='\n  <span class="invitees">'+((__t=(meeting.contacts.length))==null?"":_.escape(__t))+" "+((__t=(str))==null?"":_.escape(__t))+" </span>\n</li>"}return __p};_t_["contacts/contact"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";if(showCheckbox){__p+='\n<div class="checkbox-container">\n  <input class="checkbox" type="checkbox" autocomplete="off"><label>&nbsp;</label>\n</div>\n'}__p+='\n<div class="right-container">\n  ';if(last_interaction){__p+="\n  <span>"+((__t=(last_interaction))==null?"":_.escape(__t))+"</span>\n  "}__p+='\n  <span class="divider">&nbsp;</span>\n  <div class="source-container">\n    ';for(var i=0;i<Math.min(display_sources.length,3);i++){__p+='\n    <a href="#?source='+((__t=(display_sources[i].source_name))==null?"":_.escape(__t))+'" data-li-item-id="'+((__t=(display_sources[i].name))==null?"":_.escape(__t))+'" title="See all '+((__t=(display_sources[i].name))==null?"":_.escape(__t))+' contacts" class="contact-source" title="See all '+((__t=(display_sources[i].name))==null?"":_.escape(__t))+' contacts">\n      <span class="icon icon-'+((__t=(display_sources[i].name.toLowerCase().replace(/ /g,"_").replace(/!/g,"")))==null?"":_.escape(__t))+'-small"></span>\n    </a>\n    '}__p+="\n  </div>\n</div>\n";var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk=contacts-contacts-list-contact_name-0",id);__p+='\n<a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n  ';if(profile_image_url){__p+='\n  <img src="'+((__t=(profile_image_url))==null?"":_.escape(__t))+'" />\n  '}else{__p+='\n  <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n  '}__p+='\n</a>\n<div class="body">\n  <h3 class="name"><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></h3>\n  ";if(isConnection){__p+='\n  <abbr title="'+((__t=(name))==null?"":_.escape(__t))+' is your connection" class="degree-icon ">1<sup>st</sup></abbr>\n  '}__p+='\n  <p class="headline">\n    ';if(title&&company){__p+='\n    <a class="title">'+((__t=(title))==null?"":_.escape(__t))+'</a> at <a class="company">'+((__t=(company.name))==null?"":_.escape(__t))+"</a>\n    "}else{if(title){__p+='\n    <a class="title">'+((__t=(title))==null?"":_.escape(__t))+"</a>\n    "}else{if(company){__p+='\n    <a class="company">'+((__t=(company.name))==null?"":_.escape(__t))+"</a>\n    "}}}__p+="\n  </p>\n  ";if(location){__p+='\n  <a class="location">'+((__t=(location.name))==null?"":_.escape(__t))+"</a>\n  "}__p+='\n</div>\n<div class="bottom-container">\n  ';if(tags&&tagTemplate){__p+='\n  <ul class="tag-list">\n    ';for(var i=0;i<tags.length;i++){__p+="\n      "+((__t=(tagTemplate(tags[i])))==null?"":__t)+"\n    "}__p+="\n  </ul>\n  "}__p+='\n  <div class="action-menu-container">\n  </div>\n</div>\n'}return __p};_t_["contacts/contact/action-menu"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="tag">\n  <dl class="dropdown tag-dropdown">\n    <dt class="dropdown-anchor">\n      <a class="trigger">\n        <span class="glyph tag"></span>\n        <label class="link">Tag</label>\n      </a>\n    </dt>\n    <dd class="dropdown-content"></dd>\n  </dl>\n</li>\n<li data-li-item-id="message">\n  <a class="trigger">\n    <span class="glyph envelope"></span>\n    <label class="link">Message</label>\n  </a>\n</li>\n';if(canConnect){__p+='\n<li data-li-item-id="connect">\n  <a class="trigger">\n    <span class="glyph follow"></span>\n    <label class="link">Connect</label>\n  </a>\n</li>\n'}__p+='\n<li data-li-item-id="more">\n  <dl class="dropdown more-dropdown">\n    <dt class="dropdown-anchor">\n      <a class="trigger" href="#" role="button" aria-haspopup="true">\n        <label class="link">More</label>\n        <span class="arrow-down" aria-hidden="true"></span>\n      </a>\n    </dt>\n    <dd class="dropdown-content"></dd>\n  </dl>\n</li>'}return __p};_t_["contacts/contact/action-menu/tag-menu"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<ul class="items">\n  ';_.each(items,function(item){__p+="\n  "+((__t=(itemTemplate(item)))==null?"":__t)+"\n  "});__p+='\n</ul>\n<ul class="settings">\n <li data-li-item-id="new">\n   <a href="#">\n     <span class="plus-sign"></span>\n     <label>Add New Tags</label>\n   </a>\n </li>\n <li data-li-item-id="save">\n   <input class="new-tag-textbox" type="text" placeholder="New tag">\n   <button class="new-tag-save-button" disabled="disabled">Save</button>\n </li>\n <li data-li-item-id="manage">\n   <a href="#">\n     <span class="cog"></span>\n     <label>Manage Tags</label>\n   </a>\n </li>\n</ul>\n<span class="loader"></span>'}return __p};_t_["contacts/contact/action-menu/tag-menu/tag"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="'+((__t=(id))==null?"":_.escape(__t))+'">\n  <div class="checkbox-container">\n   <input class="checkbox" type="checkbox" autocomplete="off">\n   <label>&nbsp;</label>\n  </div>\n <label class="link">'+((__t=(name))==null?"":_.escape(__t))+"</label>\n</li>"}return __p};_t_["contacts/contact/tag-pills/tag"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-tag-id="'+((__t=(id))==null?"":_.escape(__t))+'">\n  <a href="#?tag='+((__t=(id))==null?"":_.escape(__t))+'"><span class="glyph tag"></span>'+((__t=(name))==null?"":_.escape(__t))+"</a>\n</li>"}return __p};_t_["contacts/dialogs/contact"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<a href="/contacts/view?id='+((__t=(id))==null?"":_.escape(__t))+'" target="_blank">'+((__t=(displayName))==null?"":_.escape(__t))+"</a>"}return __p};_t_["contacts/dialogs/manage-tags"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<span class="li-label">Edit or delete your tags</span>\n<div>\n  <ul id="tag-items-list" class="items dialog-list editable">\n  </ul>\n</div>'}return __p};_t_["contacts/dialogs/manage-tags/item"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="li-item-container">\n  <strong class="list-text">'+((__t=(name))==null?"":_.escape(__t))+'</strong>\n  <input type="text" value="'+((__t=(name))==null?"":_.escape(__t))+'" />\n</div>\n<span class="command-container">\n  <span class="action-container">\n    <span class="icon-edit"></span>\n    <span class="remove icon-remove-off"></span>\n  </span>\n  <span class="button-container">\n    <input type="button" name="save" value="Save" class="btn-linkedin save-btn" />\n    <input type="button" name="delete" value="Delete" class="btn-linkedin delete-btn" />\n    <input type="button" name="cancel" value="Cancel" class="btn-quaternary" />\n  </span>\n</span>\n<label class="renamed-label"><span class="icon-checkmark-small"></span>Tag edited</label>\n<label class="deleted-label"><span class="icon-checkmark-small"></span>Tag deleted</label>'}return __p};_t_["contacts/dialogs/merge-confirmation"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="li-dialog">\n  <span class="li-label">Are you sure you want to merge all the selected contacts into one single contact?</span>\n  <div>\n    <button class="yes-button">Yes</button>\n    <button class="no-button">No</button>\n  </div>\n</div>'}return __p};_t_["contacts/dialogs/message-confirmation"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="li-dialog">\n    <p class="li-label force-wrap">\n     ';var others=_.map(others,function(contact){__p+="\n     ";return Contacts.Templates["contacts/dialogs/contact"](contact);__p+="\n     "});__p+="\n     ";if(others.length===1){__p+="\n     "+((__t=(others[0]))==null?"":__t)+"\n     "}else{if(others.length===2){__p+="\n     "+((__t=(others.join(" and ")))==null?"":__t)+"\n     "}else{__p+="\n     "+((__t=(others.splice(0,others.length-1).join(", ")+", and "+others[others.length-1]))==null?"":__t)+"\n     "}}__p+='\n     will not be included in this group message because you are not connected to them on LinkedIn.\n    </p>\n    <div style="margin-top:10px;">\n      <button type="button" class="ok-button">Okay</button>\n    </div>\n</div>'}return __p};_t_["contacts/dialogs/message-yield"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div style="width:480px;">\n    <div style="padding: 11px; padding-left: 20px; background-color:#EEE; font-weight: bold; line-height:20px;">\n        <span style="top:3px; padding-right:2px;" class="glyph warning-sign"></span>\n        <span>Can\'t send group message</span>\n    </div>\n    <div style="padding:15px; padding-top:20px;">\n        <p class="li-label force-wrap">You can\'t group message\n         ';var others=_.map(others,function(contact){__p+="\n         ";return Contacts.Templates["contacts/dialogs/contact"](contact);__p+="\n         "});__p+="\n         ";if(others.length===1){__p+="\n         "+((__t=(others[0]))==null?"":__t)+"\n         "}else{if(others.length===2){__p+="\n         "+((__t=(others.join(" and ")))==null?"":__t)+"\n         "}else{__p+="\n         "+((__t=(others.splice(0,others.length-1).join(", ")+", and "+others[others.length-1]))==null?"":__t)+"\n         "}}__p+='\n          because you are not connected to them on LinkedIn. You still can message them individually\n        </p>\n        <div style="margin-top:10px;">\n           <button type="button" class="ok-button">Okay</button>\n        </div>\n    </div>\n</div>'}return __p};_t_["contacts/dialogs/push-app"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="push_me_the_app">\n\n    <div class="alert '+((__t=(alert_status))==null?"":_.escape(__t))+'" role="alert">'+((__t=(alert_text))==null?"":_.escape(__t))+'</div>\n\n    <div class="text-container '+((__t=(push_type))==null?"":_.escape(__t))+'">\n      <div class="push-text">\n        <h1>Want an easy way to do this right from your phone?</h1>\n        <p class="hdr-description">Try Linkedin\'s new Connected app, a smart way to keep up with your connections. <a href="https://www.linkedin.com/mobile" target="_blank">Learn More</a></p>\n      </div>\n      <section class="btn-container-'+((__t=(push_type))==null?"":_.escape(__t))+'">\n        ';if(push_type==="push_app"){__p+='\n          <button type="button" class="btn-push-app-'+((__t=(push_type))==null?"":_.escape(__t))+'">Get the app now</button>\n          <p class="btn-text-'+((__t=(push_type))==null?"":_.escape(__t))+"\">We'll send a push notification to your phone.</p>\n        "}else{__p+='\n          <p class="btn-text-'+((__t=(push_type))==null?"":_.escape(__t))+'">Enter your phone number and we\'ll text you a link to download the app.</p>\n          <input type="text" class="smsapp-phone-number" aria-describedby="text-input-error-msg" placeholder="(555) 567 1234"/>\n          <button type="button" class="btn-push-app-'+((__t=(push_type))==null?"":_.escape(__t))+'">Get the app now</button>\n        '}__p+='\n      </section>\n    </div>\n\n    <section class="phone_container">\n      <div class="phone-display" alt="phone display for connected app" />\n      <p class="phone-text">Currently available for iOS only</p>\n    </section>\n\n</div>\n'}return __p};_t_["contacts/dialogs/remove"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div id="remove-contact-dialog" class="remove-contact-dialog li-dialog">\n  ';if(isBulk){__p+='\n    <h4 class="title">Remove from Contacts</h4>\n  '}else{if(contact.isConnection){__p+='\n    <h4 class="title">Remove '+((__t=((contact&&!contact.displayName)?"":contact.displayName))==null?"":_.escape(__t))+" as a connection</h4>\n  "}else{__p+='\n    <h4 class="title">Remove '+((__t=((contact&&!contact.displayName)?"":contact.displayName))==null?"":_.escape(__t))+" from Contacts</h4>\n  "}}__p+='\n\n  <div class="dialog-container">\n    <div class="header">\n      ';if(isBulk){__p+="\n        <h2> Are you sure you want to remove these contacts?</h2>\n      "}else{if(contact.isConnection){__p+="\n        <h2> Are you sure you want to remove "+((__t=(contact.displayName))==null?"":_.escape(__t))+" as a connection?</h2>\n      "}else{__p+="\n        <h2> Are you sure you want to remove this contact?</h2>\n      "}}__p+='\n    </div>\n    <div class="dialog-content">\n      <div class="content-wrapper">\n        <ul class="contacts-to-delete js-contacts-to-delete">\n          ';if(removeContacts.length>1){__p+="\n            ";for(var i=0;i<removeContacts.length;i++){__p+="\n              ";var removed=removeContacts[i];__p+='\n              <li data-item-id="'+((__t=(removed.id))==null?"":_.escape(__t))+'" data-item-name="'+((__t=(removed.displayName))==null?"":_.escape(__t))+'">\n                <a href="/contacts/view?id='+((__t=(removed.id))==null?"":_.escape(__t))+'">'+((__t=(removed.displayName))==null?"":_.escape(__t))+"</a>\n              </li>\n            "}__p+="\n          "}__p+="\n        </ul>\n        <p>You'll lose:</p>\n        <ul>\n          <li>Your relationship notes</li>\n          ";if(contact&&contact.isConnection&&!isBulk){__p+="\n            <li>The ability to send "+((__t=(contact.displayName))==null?"":_.escape(__t))+" messages</li>\n            <li>Notifications about job changes</li>\n            <li>"+((__t=(contact.displayName))==null?"":_.escape(__t))+"'s updates and shared content</li>\n            <li>All endorsements and recommendations exchanged between the two of you</li>\n          "}else{__p+="\n            <li>All contact information about this person</li>\n          "}__p+='\n        </ul>\n      </div>\n    </div>\n    <div class="li-dialog-action-container">\n      <div class="button-group">\n        <button class="ok-button">Remove</button>\n        <button class="cancel-button">Cancel</button>\n      </div>\n    </div>\n  </div>\n</div>'}return __p};_t_["contacts/header"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<!-- Top navigation -->\n<nav id="contact-list-navigation">\n  <ul id="contact-list-organizer-menu">\n    <li class="sort">\n      <dl class="dropdown sort-dropdown">\n        <dt class="dropdown-anchor">\n          <label>Sort by <strong>Recent Conversation</strong><span class="arrow-down"></span></label>\n        </dt>\n        <dd class="dropdown-content"></dd>\n      </dl>\n    </li>\n\n    <li class="alphabet" style="display:none;">\n      <dl class="dropdown alphabet-dropdown">\n        <dt class="dropdown-anchor">\n          <label><strong>aZ</strong><span class="arrow-down"></span></label>\n        </dt>\n        <dd class="dropdown-content"></dd>\n      </dl>\n    </li>\n\n    <li class="filter">\n      <dl class="dropdown filter-dropdown">\n        <dt class="dropdown-anchor">\n          <label>Filter by <strong>All Contacts</strong><span class="arrow-down"></span></label>\n        </dt>\n        <dd class="dropdown-content"></dd>\n      </dl>\n    </li>\n  </ul>\n  <ul id="contact-list-top-menu">\n    <li class="action-search">\n      <div class="search-input with-search-icon">\n        <input type="text" placeholder="Search" />\n        <a class="search-clear">Clear</a>\n      </div>\n    </li>\n  </ul>\n</nav>\n<!-- Bottom navigation -->\n<section id="contact-list-action-section">\n  <div id="select-all-checkbox-container" class="checkbox-container">\n    <input class="checkbox" id="select-checkbox" type="checkbox" autocomplete="off"><label>&nbsp;</label>\n    <label class="label-text link" for="select-checkbox">Select All</label>\n  </div>\n  <!-- Action Menu (template) -->\n  <a class="scroll-to-top"><span></span>Top</a>\n</section>'}return __p};_t_["contacts/header/action-menu"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="tag">\n  <dl class="dropdown tag-dropdown">\n    <dt class="dropdown-anchor">\n      <a class="trigger">\n        <span class="glyph tag"></span>\n        <label class="link">Tag</label>\n      </a>\n    </dt>\n    <dd class="dropdown-content"></dd>\n  </dl>\n</li>\n<li data-li-item-id="message">\n  <a class="trigger">\n    <span class="glyph envelope"></span>\n    <label class="link">Message</label>\n  </a>\n</li>\n';if(!isLinkedinOnlyProfile){__p+='\n<li data-li-item-id="merge">\n  <a class="trigger">\n    <span class="icon icon-merge"></span>\n    <label class="link">Combine</label>\n  </a>\n</li>\n'}__p+='\n<li data-li-item-id="more">\n  <dl class="dropdown more-dropdown">\n    <dt class="dropdown-anchor">\n      <a class="trigger" href="#" role="button" aria-haspopup="true">\n        <label class="link">More</label>\n        <span class="arrow-down" aria-hidden="true"></span>\n      </a>\n    </dt>\n    <dd class="dropdown-content"></dd>\n  </dl>\n</li>\n'}return __p};_t_["contacts/header/count"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<span class="contacts-count">'+((__t=(title))==null?"":_.escape(__t))+" <strong>("+((__t=(count))==null?"":_.escape(__t))+")</strong></span>"}return __p};_t_["contacts/header/filter"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";_.each(top,function(item){__p+='\n<li class="item" data-li-item-id="'+((__t=(item.id))==null?"":_.escape(__t))+'">\n  <div class="checkmark"></div>\n  <label class="link">'+((__t=(item.text))==null?"":_.escape(__t))+"</label>\n</li>\n"});__p+="\n";_.each(filters,function(item,index){__p+="\n  ";var className="item";__p+="\n  ";if(index===0){__p+="\n  ";className+=" separator";__p+="\n  "}__p+='\n<li class="'+((__t=(className))==null?"":_.escape(__t))+'" data-li-item-id="'+((__t=(item.id))==null?"":_.escape(__t))+'">\n  <div class="checkmark"></div>\n  <label class="link more">'+((__t=(item.text))==null?"":_.escape(__t))+'</label>\n  <span class="next" />\n</li>\n'});__p+="\n";_.each(others,function(item,index){__p+="\n  ";var className="item";__p+="\n  ";if(index===0){__p+="\n  ";className+=" separator";__p+="\n  "}__p+='\n<li class="'+((__t=(className))==null?"":_.escape(__t))+'" data-li-item-id="'+((__t=(item.id))==null?"":_.escape(__t))+'">\n  <div class="checkmark"></div>\n  <label class="link">'+((__t=(item.text))==null?"":_.escape(__t))+"</label>\n</li>\n"});__p+=""}return __p};_t_["contacts/header/filter/sub-filter"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";_.each(items,function(item){__p+="\n"+((__t=(Contacts.Templates["contacts/header/filter/sub-filter/item"](item)))==null?"":__t)+"\n"});__p+="\n";if(showSearch){__p+='\n<li class="item search" data-li-item-id="search">\n  <div class="search-input">\n    <input type="text" placeholder="'+((__t=(placeholder))==null?"":_.escape(__t))+'" value="'+((__t=(defaultSearchQuery))==null?"":_.escape(__t))+'"/>\n    <a class="search-clear">Clear</a>\n  </div>\n</li>\n'}__p+=""}return __p};_t_["contacts/header/filter/sub-filter/item"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li class="item" data-li-item-id="'+((__t=(id))==null?"":_.escape(__t))+'">\n  <div class="checkmark"></div>\n  <label class="link">'+((__t=(text))==null?"":_.escape(__t))+"</label>\n</li>"}return __p};_t_["contacts/header/list-remove"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li class="remove">\n  <div class="checkmark"></div>\n  <label class="link"><span class="remove" /></label>\n</li>'}return __p};_t_["contacts/header/sort/list-item"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="'+((__t=(id))==null?"":_.escape(__t))+'">\n  <div class="checkmark"></div>\n  <label class="link">'+((__t=(name))==null?"":_.escape(__t))+"</label>\n</li>"}return __p};_t_.dropdown=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<dt class="dropdown-anchor">\n</dt>\n<dd class="dropdown-content">\n</dd>'}return __p};_t_.engagement=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong>\n  </header>\n  <p class="content">\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    <button class="action-button">\n      <label><span class="comment-glyph"></span>Congratulate</label>\n    </button>\n    <button class="dismiss-button">\n      <label><span class="dismiss-glyph"></span>Skip</label>\n    </button>\n  </div>\n</div>'}return __p};_t_["engagement/birthday"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    Celebrate <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a>\'s</strong> birthday.\n  </header>\n  <p class="content">\n    ';if(numDays>=1){__p+="\n      "+((__t=(displayName))==null?"":_.escape(__t))+" had a birthday on "+((__t=(sentDate))==null?"":__t)+".\n    "}else{__p+="\n      "+((__t=(moment(new Date()).format("[Today], MMMM DD")))==null?"":__t)+".\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="envelope-glyph"></span>Say happy birthday\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/contact-you-may-know"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    Connect with <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong>";if(contact.title&&contact.company){__p+=", "+((__t=(contact.title))==null?"":_.escape(__t))+" at "+((__t=(contact.company.name))==null?"":_.escape(__t))+" "+((__t=(contact.last_interaction_source))==null?"":_.escape(__t))+""}else{if(contact.title){__p+="\n    >, "+((__t=(contact.title))==null?"":_.escape(__t))+""}else{if(contact.company){__p+=", at "+((__t=(contact.company.name))==null?"":_.escape(__t))+" "+((__t=(contact.last_interaction_source))==null?"":_.escape(__t))+""}}}__p+='\n  </header>\n  <p class="content">\n    ';if(last_interaction_source&&last_interaction_date){__p+="\n      ";if(last_interaction_type=="message"){__p+="\n        Emailed via "+((__t=(last_interaction_source))==null?"":_.escape(__t))+" on "+((__t=(moment(last_interaction_date).format("MMMM DD, YYYY")))==null?"":_.escape(__t))+"\n      "}else{if(last_interaction_type=="call"){__p+="\n        Called on "+((__t=(moment(last_interaction_date).format("MMMM DD, YYYY")))==null?"":_.escape(__t))+"\n      "}else{if(last_interaction_type=="calendar_event"){__p+="\n        ";if(last_interaction_title){__p+="\n          Met at "+((__t=(last_interaction_title))==null?"":_.escape(__t))+", "+((__t=(moment(last_interaction_date).format("MMMM DD, YYYY")))==null?"":_.escape(__t))+"\n        "}else{__p+="\n          Met on "+((__t=(moment(last_interaction_date).format("MMMM DD, YYYY")))==null?"":_.escape(__t))+"\n        "}__p+="\n      "}}}__p+="\n    "}else{if(contact_source_type){__p+="\n      In your "+((__t=(contact_source_type))==null?"":_.escape(__t))+"\n    "}}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="follow-glyph"></span>\n      ';if(show_add_to_network&&!is_linkedin_internal){__p+="\n        Add to Network\n      "}else{__p+="\n        Connect\n      "}__p+='\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/job-change"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&slType=NPU-JC&slSrcId=activity:{1}&trk={2}",contact.id,thread_id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong> has a new job.\n  </header>\n  <p class="content">\n    Now\n    ';if(title&&company_name){__p+='\n    <a class="title link" href="#?title='+((__t=(title))==null?"":_.escape(__t))+'">'+((__t=(title))==null?"":_.escape(__t))+"</a> at "+((__t=(company_name))==null?"":_.escape(__t))+".\n    "}else{if(title){__p+='\n    <a class="title link" href="#?title='+((__t=(title))==null?"":_.escape(__t))+'">'+((__t=(title))==null?"":_.escape(__t))+"</a>.\n    "}else{if(company_name){__p+="\n    at "+((__t=(company_name))==null?"":_.escape(__t))+".\n    "}}}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="envelope-glyph"></span>Congratulated\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="comment-glyph"></span>Say congrats\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/location-change"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong> recently moved:\n    <div class="location-places">'+((__t=(old_location))==null?"":_.escape(__t))+' <span class="right-arrow"></span> '+((__t=(new_location.name))==null?"":_.escape(__t))+'.</div>\n  </header>\n  <p class="content">\n    Share who you know in '+((__t=(new_location.name))==null?"":_.escape(__t))+'.\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="envelope-glyph"></span>Reach out\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/meetings"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';if(contact){__p+="\n    ";var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk=contacts-touch-contact_name-0",contact.id);__p+='\n    <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image" title="'+((__t=(contact.displayName))==null?"":_.escape(__t))+'">\n      ';if(contact.profile_image_url){__p+='\n      <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" class="';if(others.length){__p+="with-side-images"}__p+='" />\n      '}else{__p+='\n      <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" class="';if(others.length){__p+="with-side-images"}__p+='" />\n      '}__p+="\n    </a>\n    ";_.each(others,function(item,index){__p+="\n    ";profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk=contacts-touch-contact_name-0",item.id);__p+='\n    <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" title="'+((__t=(item.displayName))==null?"":_.escape(__t))+'">\n      ';if(item.profile_image_url){__p+='\n      <img src="'+((__t=(item.profile_image_url))==null?"":_.escape(__t))+'" class="side-image-'+((__t=(index))==null?"":_.escape(__t))+'" alt="'+((__t=(item.displayName))==null?"":_.escape(__t))+'" title="'+((__t=(item.displayName))==null?"":_.escape(__t))+'"/>\n      '}else{__p+='\n      <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" class="side-image-'+((__t=(index))==null?"":_.escape(__t))+'" alt="'+((__t=(item.displayName))==null?"":_.escape(__t))+'" title="'+((__t=(item.displayName))==null?"":_.escape(__t))+'"/>\n      '}__p+="\n    </a>\n    "});__p+="\n  "}else{__p+='\n  <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n  '}__p+='\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    ';if(contact){__p+="\n    ";profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk=contacts-touch-contact_name-0",contact.id);var contactWording="others today.";if(contactsCount===1){contactWording="other today."}__p+="\n    You're meeting with <strong><a href=\""+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(contact.displayName))==null?"":_.escape(__t))+"</a></strong> and <span>"+((__t=(contactsCount))==null?"":_.escape(__t))+"</span> "+((__t=(contactWording))==null?"":_.escape(__t))+"\n    "}else{__p+="\n    You have "+((__t=(count))==null?"":_.escape(__t))+" meetings today.\n    "}__p+='\n  </header>\n  <p class="content">\n    ';if(contact){__p+="\n    Get ready by seeing latest about them\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    <a class="action-button">\n      <span class="list-glyph"></span>See today\'s meetings\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n  </div>\n</div>'}return __p};_t_["engagement/mobile-promo"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<section class="mobile-promo">\n  <div class="promo-logo"></div>\n  <h3>You\'ve made connections. Now stay connected.</h3>\n  <p class="download">Download our new Connected app</p>\n\n  <p class="error-text">Sorry, something went wrong.<br/>Please try again.</p>\n  <p class="success-promo-text">Text message sent.</p>\n\n  <button class="close" title="close"></button>\n</section>\n<section class="footer">\n  <div class="footer-elements">\n    <p class="">Text the download link to your iPhone</p>\n    <label for="mobile-promo-phone" class="mobile-promo-phone-label">1 (555) 555 5555</label>\n    <input id="mobile-promo-phone" type="tel" placeholder="1 (555) 555 - 5555" class="mobile-promo-phone">\n    <button type="button" class="continue medium spotlight">Send</button>\n  </div>\n</section>'}return __p};_t_["engagement/news"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong> was mentioned in the news.\n  </header>\n  ";var article=articles[0];__p+='\n  <p class="content article-title">\n    <a class="article-link link" href="'+((__t=(article.url))==null?"":_.escape(__t))+'" target="_blank">'+((__t=(article.title))==null?"":_.escape(__t))+"</a>\n  </p>\n  ";if(article.source){__p+='\n  <p class="source">\n    <a class="link" href="'+((__t=(article.url))==null?"":_.escape(__t))+'" target="_blank">'+((__t=(article.source))==null?"":_.escape(__t))+"</a>\n  </p>\n  "}__p+='\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="share-glyph"></span>Tell your network\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/people-you-may-know"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/profile/view?id={0}",linkedin_id);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(profile_image_url){__p+='\n    <img src="'+((__t=(profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    Connect with <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(name))==null?"":_.escape(__t))+"</a></strong>";if(headline){__p+=", "+((__t=(headline))==null?"":_.escape(__t))+""}__p+='\n  </header>\n  <p class="content">\n    ';if(first_common_entity_first_name&&first_common_entity_last_name){__p+="\n      In common: "+((__t=(first_common_entity_first_name))==null?"":_.escape(__t))+" "+((__t=(first_common_entity_last_name))==null?"":_.escape(__t))+"\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="follow-glyph"></span>Connect\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/poncho-post"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&slType=NPU-PP&slSrcId=activity:{1}&trk={2}",contact.id,thread_id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong> published a new post:\n  </header>\n  <p class="content">\n    <a class="title link" href="'+((__t=(post_url))==null?"":_.escape(__t))+'">'+((__t=(post_title))==null?"":_.escape(__t))+'</a>\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Commented\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="comment-glyph"></span>Send your thoughts\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/recently-met"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    ';if(numDays===0){__p+='\n      <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong> met with you yesterday.\n    "}else{if(numDays>5){__p+='\n      <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong> met with you "+((__t=(parseInt(numDays+1)))==null?"":__t)+" days ago.\n    "}else{__p+='\n      <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong> met with you on "+((__t=(metDate))==null?"":__t)+".\n    "}}__p+='\n  </header>\n  <p class="content">\n    ';if(event_title){__p+="\n    You met at: "+((__t=(event_title))==null?"":_.escape(__t))+".\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Done\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="follow-glyph"></span>Connect\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/reminder"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    Reminder for <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong>\n  </header>\n  <p class="content">\n    ';if(text&&text.length){__p+="\n    "+((__t=(text))==null?"":_.escape(__t))+".\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Completed\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="ok-sign-glyph"></span>Mark as complete\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/sync-promo-a"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<section class="type-a">\n  <h3>Want to get more of these?</h3>\n  <h4>Bring your email, contacts, and calendar in one place.</h4>\n  <input type="text" value="'+((__t=(email))==null?"":_.escape(__t))+'" class="sync-promo-email">\n  <button type="button" class="continue medium spotlight">Sync now</button>\n  <p class="privacy-text">\n    <span class="lock"></span>We won\'t use your contacts without consent. <a class="learn-more" href="http://linkedin.custhelp.com/app/answers/global/id/36951/ft/eng" target="_blank">Learn more</a>\n  </p>\n  <button class="close" title="close"></button>\n</section>\n<div class="engagement-sync-arrow"></div>'}return __p};_t_["engagement/sync-promo-b"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<section class="type-b">\n  <h3>Ready, set, sync.</h3>\n  <h4>Bring your email, contacts, and calendar in one place and always stay in touch.</h4>\n  <input type="text" value="'+((__t=(email))==null?"":_.escape(__t))+'" class="sync-promo-email">\n  <button type="button" class="continue medium spotlight">Sync now</button>\n  <p class="privacy-text">\n    <span class="lock"></span>We won\'t use your contacts without consent. <a class="learn-more" href="http://linkedin.custhelp.com/app/answers/global/id/36951/ft/eng" target="_blank">Learn more</a>\n  </p>\n  <button class="close" title="close"></button>\n</section>'}return __p};_t_["engagement/upcoming-trip"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&trk={1}",contact.id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    Visit <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+"</a></strong> while in "+((__t=(destination))==null?"":_.escape(__t))+'\n  </header>\n  <p class="content">\n    You\'re traveling to '+((__t=(destination))==null?"":_.escape(__t))+"\n    ";if(start_date&&end_date){__p+='\n    <span class="dates">'+((__t=(moment(start_date).format("MMMM DD")))==null?"":_.escape(__t))+" - "+((__t=(moment(end_date).format("MMMM DD")))==null?"":_.escape(__t))+"</span>.\n    "}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Meeting planned\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="envelope-glyph"></span>Plan to meet\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_["engagement/work-anniversary"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="engagement-body-left">\n  ';var profile_url=String.formatWithUriEscape("/contacts/view?id={0}&slType=NPU-A&slSrcId=activity:{1}&trk={2}",contact.id,thread_id,profileTrk);__p+='\n  <a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'" class="image">\n    ';if(contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+='\n  </a>\n</div>\n<div class="engagement-body-right">\n  <header class="header">\n    <strong><a href="'+((__t=(profile_url))==null?"":_.escape(__t))+'">'+((__t=(displayName))==null?"":_.escape(__t))+'</a></strong> is having a work anniversary.\n  </header>\n  <p class="content">\n    ';if(number_of_years&&since_month){__p+="\n    ";var years=number_of_years===1?"year":"years";__p+="\n    ";var monthName=moment().month(since_month-1).format("MMMM");__p+="\n    "+((__t=(number_of_years))==null?"":_.escape(__t))+" "+((__t=(years))==null?"":_.escape(__t))+" this "+((__t=(monthName))==null?"":_.escape(__t))+"\n      ";if(company_name){__p+=" at "+((__t=(company_name))==null?"":_.escape(__t))+""}__p+=".\n    "}else{if(company_name){__p+="\n    At "+((__t=(company_name))==null?"":_.escape(__t))+".\n    "}}__p+='\n  </p>\n</div>\n<div class="engagement-action-container">\n  <div class="button-wrapper">\n    ';if(completed){__p+='\n    <a class="done">\n      <span class="ok-glyph"></span>Congratulated\n    </a>\n    '}else{__p+='\n    <a class="action-button">\n      <span class="comment-glyph"></span>Say congrats\n    </a>\n    <a class="dismiss-button">\n      <span class="dismiss-glyph"></span>Skip\n    </a>\n    '}__p+="\n  </div>\n</div>"}return __p};_t_.engagements=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<ul class="items">\n</ul>\n<div class="more-bar-container">\n  <div class="ruler"></div>\n  <div class="more-bar-wrapper"></div>\n</div>'}return __p};_t_["engagements/more-bar"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="<ul>\n  ";_.each(contacts,function(contact){__p+="\n  <li>\n    ";if(contact&&contact.profile_image_url){__p+='\n    <img src="'+((__t=(contact.profile_image_url))==null?"":_.escape(__t))+'" />\n    '}else{__p+='\n    <img src="'+((__t=(defaultImageUrl))==null?"":_.escape(__t))+'" />\n    '}__p+="\n  </li>\n  "});__p+="\n</ul>\n<p><label>See more people to contact</label></p>\n<span></span>"}return __p};_t_["hopscotch-sync-promo"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<strong class="error"></strong>\n<input type="text" value="'+((__t=(email))==null?"":_.escape(__t))+'" class="sync-promo-email">\n<button type="button" class="next hopscotch-nav-button sync-button">Sync Now</button>\n';if(showCancel){__p+='\n  <button type="button" class="prev hopscotch-nav-button cancel-button">Cancel</button>\n'}__p+=""}return __p};_t_.list=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";_.each(items,function(item){__p+="\n"+((__t=(itemTemplate(item)))==null?"":__t)+"\n"});__p+=""}return __p};_t_["list/item"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li data-li-item-id="'+((__t=(id))==null?"":_.escape(__t))+'">\n <a class="link" href="#" role="button">'+((__t=(name))==null?"":_.escape(__t))+"</a>\n</li>"}return __p};_t_["page/dialogs/profile-organizer"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="profile-organizer-dialog-content">\n  <div>\n    We moved all your saved information from Profile Organizer to LinkedIn Contacts, a new, more powerful tool for tracking important details. Heres a quick guide:\n  </div>\n  <img src="'+((__t=(Contacts.Constants.STATIC_URL))==null?"":_.escape(__t))+'contacts/images/linkedin/AssetProOrg_flat.png" />\n</div>'}return __p};_t_["page/header/menu"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<li class="action-add-contact">\n  <dl class="dropdown">\n    <dt class="dropdown-anchor">\n      <a title="Add Contact"><span></span></a>\n    </dt>\n    <dd class="dropdown-content">\n      <ul class="items">\n        <!-- <li data-li-item-id="sync">\n          <label class="link">Sync contacts from email</label>\n        </li> -->\n        <li data-li-item-id="add">\n          <label class="link">Add contact</label>\n        </li>\n      </ul>\n    </dd>\n  </dl>\n</li>\n<li class="action-settings">\n  <a href="'+((__t=(secureBaseUrl))==null?"":_.escape(__t))+'/contacts/manage_sources/" title="Settings"><span></span></a>\n</li>\n\n\n'}return __p};_t_["sync-promo"]=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='<div class="wrapper-container">\n  <div class="outer-container">\n    <button class="close" title="close"></button>\n    <div class="inner-container">\n      <h3>'+((__t=(name))==null?"":_.escape(__t))+', sync your contacts. Stay in touch.</h3>\n      <h4>Bring your email, contacts, and calendar in one place.</h4>\n      <input type="text" value="'+((__t=(email))==null?"":_.escape(__t))+'" class="sync-promo-email">\n      <button type="button" class="continue medium spotlight">Continue</button>\n      <p>\n        <span class="lock"></span>Youre in control of your data. We wont message your contacts without your permission. <a class="learn-more" href="http://linkedin.custhelp.com/app/answers/global/id/36951/ft/eng" target="_blank">Learn more</a>\n      </p>\n    </div>\n    <img src="'+((__t=(Contacts.Constants.STATIC_URL))==null?"":_.escape(__t))+'contacts/images/sync-promo.png"/>\n  </div>\n</div>'}return __p}})(Contacts.Templates);(function(b,a){var c=a.getElementById("lnkd-contacts-base-page-config");b.Contacts.Lix={get:function(d){var f=d.replace("data-","");var e=c.getAttribute("data-"+f);e=e&&e.toLowerCase();if(e==="true"){return true}if(e==="false"){return false}if(!isNaN(e)){return parseFloat(e)}return e},isEnabled:function(d){return true}}})(window,document);(function(b,d,a){var c=d.Model.extend({urlRoot:"/contacts/api/contacts/",url:function(){return d.Model.prototype.url.call(this)+"/"},tagUrl:function(){return this.url()+"tags/"},defaults:function(){return{title:null,location:null,company:null,profile_image_url:null,last_interaction:null,tags:new d.Collection(),sources:new d.Collection(),display_sources:new d.Collection(),emails:new d.Collection()}},definitions:function(){return{company:Contacts.Models.Company,location:Contacts.Models.Location,tags:d.Collection,sources:d.Collection,display_sources:d.Collection,emails:d.Collection}},toJSON:function(f){var e=d.Model.prototype.toJSON.call(this,f);a.each(this.definitions(),a.bind(function(h,g){if(this.get(g)){e[g]=h.prototype.toJSON.call(this.get(g))}},this));return e},isConnection:function(){return !!this.get("sources").get("LinkedIn")},canConnect:function(){return !this.isConnection()&&a.some(a.pluck(this.get("sources").models,"id"),function(e){return a.contains(["LinkedIn Public","LinkedIn Internal"],e)})},removeConnection:function(){var f=this.get("sources");var e=f.get("LinkedIn");if(e){f.remove(e)}},parse:function(h){if(h.contact_data){h=h.contact_data}if(h.company){var j=Contacts.DataStore.companies.get(h.company.id);if(!j){Contacts.DataStore.companies.add(h.company);j=Contacts.DataStore.companies.get(h.company.id)}h.company=j}if(h.geo_location){var k=h.geo_location;Contacts.DataStore.locations.add(k,{parse:true});delete h.geo_location;var l;if(k.geo_region_code){l=k.geo_region_code+"-"+k.name}else{l=k.name}h.location=Contacts.DataStore.locations.get(l)}if(h.tags){var m=[];a.each(h.tags,function(o){var n=Contacts.DataStore.tags.get(o.id);if(!n){Contacts.DataStore.tags.add(o);n=Contacts.DataStore.tags.get(o.id)}m.push(n)});h.tags=new Contacts.Collections.Tags(m)}if(h.sources){var e=[];a.each(h.sources,function(n){var o=Contacts.DataStore.sources.get({name:n});if(!o){Contacts.DataStore.sources.add({name:n},{parse:true});o=Contacts.DataStore.sources.get(n)}e.push(o)});h.sources=new d.Collection(e)}if(h.display_sources){var g=[];a.each(h.display_sources,function(n){var o=Contacts.DataStore.sources.get(n);g.push(o)});h.display_sources=new d.Collection(g)}if(h.emails){var i=a.map(h.emails,function(n){return new Contacts.Models.Email(n)});h.emails=new d.Collection(i)}if(h.last_interaction){h.last_interaction*=1000}if(h.generation_time){delete h.generation_time}if(h.secure_profile_image_url){h.profile_image_url=h.secure_profile_image_url}for(var f in h){if(h[f]===null||h[f]===undefined||(a.isArray(h[f])&&!h[f].length)){delete h[f]}}return h},displayName:function(){var g=this.get("name");if(g&&g.length>0){return g}var h=this.get("first_name");var f=this.get("last_name");if(h&&f){return h+" "+f}if(h){return h}var i=this.get("emails");if(i.length){return i.first().get("email")}var e=this.get("company");if(e){return e.get("name")}return""},tag:function(f){var f=a.extend({},{added:[],removed:[]},f);var e=this.get("tags");if(f.added){e.add(f.added)}if(f.removed){e.remove(f.removed)}return $.ajax({url:this.tagUrl(),type:"POST",data:JSON.stringify({tag_ids:a.pluck(a.isArray(f.added)?f.added:[f.added],"id"),untag_ids:a.pluck(a.isArray(f.removed)?f.removed:[f.removed],"id")}),cache:false})},hide:function(){this.set("hidden",true);return $.ajax({url:this.url(),type:"PUT",cache:false,data:JSON.stringify({hidden:true})})},unhide:function(){this.set("hidden",false);return $.ajax({url:this.url(),type:"PUT",cache:false,data:JSON.stringify({hidden:false})})}});Contacts.Models.Contact=c})(window,Backbone,_);(function(b,d,a){var c=d.Model.extend({});Contacts.Models.Company=c})(window,Backbone,_);(function(b,e,a,d){var c=e.Model.extend({url:function(){return e.Model.prototype.url.call(this)+"/"},rename:function(h){var g=this;var f=d.ajax({url:this.url(),type:"PUT",cache:false,data:JSON.stringify({name:h})});f.done(function(i){if(i.hasOwnProperty("new_tag_id")){g.set("id",i.new_tag_id)}g.set("name",h)});return f},destroy:function(f){f=f?a.clone(f):{url:this.url()};return e.Model.prototype.destroy.call(this,f)},parse:function(f){return{name:f.name,id:f.id||f.tag_id}}});Contacts.Models.Tag=c})(window,Backbone,_,jQuery);(function(c,g,h){var e=Contacts.Constants.SourceType;var f={};f[e.EMAIL.toLowerCase()]=e.GMAIL;f[e.OUTLOOK_EWS.toLowerCase()]=e.OUTLOOK_CONTACTS;var b={};b[e.GMAIL.toLowerCase()]=e.EMAIL;b[e.GOOGLE.toLowerCase()]=[e.EMAIL,e.GOOGLE_CONTACTS,e.GOOGLE_CALENDAR].join(",");b[e.OUTLOOK_EWS.toLowerCase()]=[e.OUTLOOK_CONTACTS,e.OUTLOOK_CALENDAR,e.OUTLOOK_MAIL].join(",");b[e.YAHOO.toLowerCase()]=[e.YAHOO_CONTACTS,e.YAHOO_MAIL].join(",");var i=function(j){return f[j.toLowerCase()]||j};var d=function(j){return b[j.toLowerCase()]||j};var a=g.Model.extend({idAttribute:"name",parse:function(j){var k=j.name;return{name:i(k),source_name:d(k)}}});a.getDisplayName=i;a.getSourceName=d;Contacts.Models.Source=a})(window,Backbone,_);(function(b,d,a){var c=d.Model.extend({});Contacts.Models.Email=c})(window,Backbone,_);(function(b,d,a){var c=d.Model.extend({parse:function(f){var e={};if(f.geo_region_code){e.id=f.geo_region_code+"-"+f.name;e.region_code=f.geo_region_code}else{e.id=f.name;e.region_code=f.name}e.name=f.name;return e}});Contacts.Models.Location=c})(window,Backbone,_);(function(l,o,p){var a={BIRTHDAY:"birthday",JOB_CHANGE:"job_change",WORK_ANNIVERSARY:"work_anniversary",LOCATION_CHANGE:"location_change",YESTERDAYS_ACQUAINTANCE:"yesterdays_acquaintance",NEWS_ABOUT_NETWORK:"news_about_network",UPCOMING_TRIP:"upcoming_trip",REMINDER:"reminder",CONTACT_YOU_MAY_KNOW:"contact_you_may_know",PEOPLE_YOU_MAY_KNOW:"people_you_may_know",PONCHO_POST:"poncho_post"};var m={};m.Activity={commentUrl:function(){return String.format("/contacts/api/activities/{0}/comment/",this.get("thread_id"))},like:function(){this.complete()},comment:function(r){return $.ajax({url:this.commentUrl(),type:"POST",data:JSON.stringify({message:r}),cache:false}).done(p.proxy(function(){this.complete()},this))}};var c=o.Model.extend({type:null,idAttribute:"engage_event_id",keys:["engage_event_id","completed","sent_date","score","model_id","request_id"],toJSON:function(s){var r=o.Model.prototype.toJSON.call(this,s);r.contact=this.get("contact").toJSON();r.profileTrk=this.getProfileTrk();return r},getProfileTrk:function(){return"contacts-touch-contact_name-0"},_complete:function(r){var s="";if(this.get("request_id")!==undefined){s=this.get("request_id")}return $.ajax({url:this.collection.url,type:"POST",data:JSON.stringify({engage_event_id:this.id,dismiss_event:r,request_id:s}),cache:false})},complete:function(){return this._complete(false).done(p.bind(function(){this.set("completed",true)},this))},dismiss:function(){return this._complete(true)},parse:function(t){var u={};p.each(this.keys,function(v){u[v]=t[v];delete t[v]});var s=Contacts.DataStore.contacts.get(t.id);if(!s){s=new Contacts.Models.Contact(t,{parse:true});Contacts.DataStore.contacts.add(s,{merge:true})}s.set("linkedin_id",t.linkedin_id);var r;if(u.company){r=u.company.name}u.company_name=r;u.contact=s;return u},getSentDate:function(){return new Date(this.get("sent_date")*1000)},getSentDateFormatter:function(){return moment(new Date(this.get("sent_date")*1000))},getDayBeforeSendDateFormatter:function(){return moment(new Date((this.get("sent_date")-86400)*1000))},getHowManyDaysAgo:function(){var s=this.getSentDate(),r=new Date(),t=r.getDate()-s.getDate();if(t<0){return this.getDaysInMonth(s.getFullYear(),s.getMonth())-s.getDate()+r.getDate()}return t},getDaysInMonth:function(r,s){return new Date(r,s,0).getDate()}});c.Constants=Contacts;var k=c.extend({type:a.BIRTHDAY});var q=c.extend({type:a.LOCATION_CHANGE,keys:c.prototype.keys.concat(["update_time","new_location","old_location"]),toJSON:function(s){var r=c.prototype.toJSON.call(this,s);r.new_location=this.get("new_location").toJSON();return r},parse:function(r){r=c.prototype.parse.call(this,r);var s=r.new_location;Contacts.DataStore.locations.add({id:s,name:s},{parse:true});r.new_location=Contacts.DataStore.locations.get(s);return r}});var b=c.extend(p.extend({type:a.JOB_CHANGE,keys:c.prototype.keys.concat(["thread_id","company","title"])},m.Activity));var j=c.extend(p.extend({type:a.WORK_ANNIVERSARY,keys:c.prototype.keys.concat(["thread_id","number_of_years","since_month","company"])},m.Activity));var d=c.extend(p.extend({type:a.PONCHO_POST,keys:c.prototype.keys.concat(["thread_id","post_description","post_id","post_title","post_url","post_image"])},m.Activity));var i=c.extend({type:a.YESTERDAYS_ACQUAINTANCE,keys:c.prototype.keys.concat(["is_full_day_event","event_title","event_time"])});var h=c.extend({type:a.NEWS_ABOUT_NETWORK,keys:c.prototype.keys.concat(["articles"])});var g=c.extend({type:a.UPCOMING_TRIP,keys:c.prototype.keys.concat(["contacts","count","start_date","end_date","is_primary","destination"]),parse:function(s){var t=c.prototype.parse.call(this,s),r=new Date();t.start_date=new Date(t.start_date+"/"+r.getFullYear());t.end_date=new Date(t.end_date+"/"+r.getFullYear());return t}});var n=c.extend({type:a.CONTACT_YOU_MAY_KNOW,keys:c.prototype.keys.concat(["last_interaction_source","last_interaction_date","last_interaction_type","last_interaction_title","contact_source_type","is_linkedin_internal","show_add_to_network"]),parse:function(r){var s=c.prototype.parse.call(this,r);s.last_interaction_date=new Date(s.last_interaction_date*1000);return s}});var f=c.extend({idAttribute:"custom_id",type:a.PEOPLE_YOU_MAY_KNOW,keys:c.prototype.keys.concat(["custom_id","linkedin_id","name","first_name","profile_image_url","headline","type","first_common_entity_first_name","first_common_entity_last_name","auth_value","auth_name"]),_complete:function(r){return $.ajax({url:this.collection.url,type:"POST",data:JSON.stringify({type:this.type,dismiss_event:r,dismissed_member_id_list:[this.get("linkedin_id")]}),cache:false})},parse:function(r){r.custom_id=r.linkedin_id+"_"+this.type;return c.prototype.parse.call(this,r)}});var e=c.extend({idAttribute:"reminderId",type:a.REMINDER,keys:["reminderId","completed","start_date","text","recurring","date","type","score"],url:function(){return String.format("/contacts/api/contacts/{0}/reminders/{1}/",this.get("contact").id,this.id)},_complete:function(r){return $.ajax({url:this.url(),type:"PUT",data:JSON.stringify({completed:true}),cache:false})},parse:function(r){r.reminderId=r.id;r.id=r.contact_id;delete r.contact_id;return c.prototype.parse.call(this,r)}});Contacts.Models.Engagement=c;Contacts.Models.BirthdayEngagement=k;Contacts.Models.JobChangeEngagement=b;Contacts.Models.WorkAnniversaryEngagement=j;Contacts.Models.LocationChangeEngagement=q;Contacts.Models.RecentlyMetEngagement=i;Contacts.Models.NewsAboutNetworkEngagement=h;Contacts.Models.UpcomingTripEngagement=g;Contacts.Models.ReminderEngagement=e;Contacts.Models.ContactYouMayKnowEngagement=n;Contacts.Models.PeopleYouMayKnowEngagement=f;Contacts.Models.PonchoPostEngagement=d})(window,Backbone,_);(function(b,d,a){var c=d.Model.extend({parse:function(e){e.start_time=new Date(e.start_time*1000);e.end_time=new Date(e.end_time*1000);var f=a.map(e.contacts,function(h){var g=Contacts.DataStore.contacts.get(h.id);if(!g){g=new Contacts.Models.Contact(h,{parse:true});Contacts.DataStore.contacts.add(g,{merge:true})}return g});e.contacts=new d.Collection(f);return e}});Contacts.Models.Meeting=c})(window,Backbone,_);(function(b,d,a){var c=d.Model.extend({url:"/contacts/api/user_settings/",_dfd:null,fetch:function(e){if(this._dfd){return this._dfd.promise()}this._dfd=$.Deferred();d.Model.prototype.fetch.call(this,a.extend({cache:false,parse:true},e)).always(this._dfd.resolve);return this._dfd.promise()},parse:function(e){var g=e.user_details;var f=g.services;a.each(f,function(h){a.each(h,function(i){Contacts.DataStore.sources.add({name:i},{parse:true})})});delete g.services;delete g.services_data;return g}});Contacts.Models.User=c})(window,Backbone,_);(function(f,h,g,c){var d={RECENT:"-last_interaction",ALPHABETICAL:"name",CREATED:"-created",FIRST_NAME:"first_name",LAST_NAME:"last_name"};var e={RECENT:"recent",ALPHABETICAL:"alphabetical",CREATED:"new",FIRST_NAME:"first_name",LAST_NAME:"last_name"};var a={NONE:null,TAG:"tag_id",COMPANY:"company_id",LOCATION:"location",TITLE:"title",SOURCE:"source",STARTS_WITH:"starts_with"};var b=h.Collection.extend({model:Contacts.Models.Contact,url:"/contacts/api/contacts/",loadMoreUrl:"/contacts/api/contacts/more/",sortFilterUrl:"/contacts/api/contacts/full/",searchUrl:"/contacts/api/contacts/search/",potentialMergesUrl:"/contacts/services/potential_merges/",autocompleteUrl:"/contacts/services/get_search_contacts/",_contactFields:(function(){var i=["id","name","first_name","last_name","company","title","geo_location","tags","emails","sources","display_sources","last_interaction"];i.push(f.location.protocol==="https:"?"secure_profile_image_url":"profile_image_url");return i.join(",")})(),_start:0,_contactsPerPage:Contacts.Lix.get("page-count"),_sortOrder:d.RECENT,_filter:a.NONE,_hasNext:true,_clear:function(){this._start=0;this._hasNext=true},getSortOrder:function(){return this._sortOrder},getSortOrderKey:function(){var i=this._sortOrder;if(!i){return}switch(i){case d.RECENT:i=e.RECENT;break;case d.ALPHABETICAL:i=e.ALPHABETICAL;break;case d.CREATED:i=e.CREATED;break;case d.FIRST_NAME:i=e.FIRST_NAME;break;case d.LAST_NAME:i=e.LAST_NAME;break;default:i=e.RECENT;break}return i},setSortOrder:function(i){this._clear();this._sortOrder=i},clearFilter:function(){this._clear();this._filter=null},getFilter:function(){return this._filter},setFilter:function(i){this._clear();this._filter=i;this._searchQuery=null},getSearchQuery:function(){return this._searchQuery},setSearchQuery:function(i){this._clear();this._searchQuery=i;this._filter=null},hasNext:function(){return this._hasNext},next:function(j){var i=this.fetchContacts({trackTarget:j});this._start+=this._contactsPerPage;return i},fetchContacts:function(k){var l={start:this._start,count:this._contactsPerPage,fields:this._contactFields,sort:this._sortOrder},j,i;k=c.extend({trackTarget:false},k);if(l.sort===d.FIRST_NAME){l.sort=d.ALPHABETICAL}if(this._filter){c.extend(l,this._filter)}if(this._searchQuery){c.extend(l,this._searchQuery)}if(!k.trackTarget){j=this._searchQuery?this.searchUrl:this.url}else{switch(k.trackTarget){case Contacts.Constants.PageKey.MORE_CONTACTS:j=this.loadMoreUrl;break;case Contacts.Constants.PageKey.CONTACTS:j=this.sortFilterUrl;break;case Contacts.Constants.PageKey.SEARCH:j=this.searchUrl;break;default:throw new Error("Invalid track target is provided!")}}var i=g.Deferred();g.ajax({url:j,type:"GET",data:l,cache:false}).done(c.bind(function(m){this._parsePagingInfo(m);var n;switch(l.visible){case"hidden":n=true;break;default:n=false}var o=c.map(this.parse(m),function(q){this.add(q,{merge:true});var p=this.get(q.id);p.set("hidden",n);return p},this);this._hasNext=(this.paging.start+o.length)<this.paging.total;this.currentModels=o;i.resolve(o)},this)).fail(i.reject);return i.promise()},fetchAutocompleteContacts:function(){var i=g.Deferred();g.ajax({url:this.autocompleteUrl,type:"GET",data:{},cache:false}).done(c.bind(function(j){i.resolve(j.contacts)},this)).fail(i.reject);return i.promise()},fetchPotentialMerges:function(){var j={fields:this._contactFields};this._clearPaging();var i=g.Deferred();g.ajax({url:this.potentialMergesUrl,type:"GET",data:j,cache:false}).done(c.bind(function(k){var m=0;var l=c.map(k.potential_merges,function(n){return c.map(n,function(o){this.add(this.model.prototype.parse(o));m++;return this.get(o.id)},this)},this);this._hasNext=false;this.totalContacts=m;this.trigger("change:total-contacts",m);i.resolve(l)},this)).fail(i.reject);return i.promise()},bulkTag:function(k,i){var i=c.extend({},{added:[],removed:[]},i);var j=c.isArray(i.added)?i.added:[i.added];var l=c.isArray(i.removed)?i.removed:[i.removed];c.each(k,function(m){var n=m.get("tags");n.add(j);n.remove(l)});return g.ajax({url:this.url+c.pluck(k,"id").join(",")+"/tags/",type:"POST",cache:false,data:JSON.stringify({tag_ids:c.pluck(j,"id"),untag_ids:c.pluck(l,"id")})})},bulkRemove:function(i){return g.ajax({url:this.url+c.pluck(i,"id").join(",")+"/",type:"DELETE",cache:false}).done(c.bind(function(){this.remove(i)},this))},bulkHide:function(j,i){var i=c.extend({remove:true},i);return this._bulkHideUnhide(j,true,i)},bulkUnhide:function(j,i){var i=c.extend({remove:true},i);return this._bulkHideUnhide(j,false,i)},_bulkHideUnhide:function(k,j,i){return g.ajax({url:this.url+c.pluck(k,"id").join(",")+"/",type:"PUT",cache:false,data:JSON.stringify({hidden:j})}).done(c.bind(function(){if(i.remove){this.remove(k)}},this))},merge:function(j){var i=g.Deferred();g.ajax({url:"/contacts/services/merge_contacts/",type:"POST",data:{contact_ids:c.pluck(j,"id").join(",")},cache:false}).done(c.bind(function(l){var k=new Contacts.Models.Contact({id:l.merged_contact_id});k.fetch({data:{fields:this._contactFields}}).done(c.bind(function(){this.remove(j);this.add(k);i.resolve(k)},this))},this)).fail(i.reject);return i.promise()},mergeSets:function(j){var i=g.Deferred();var k=[];k=Array.prototype.concat.apply(k,j);g.ajax({url:"/contacts/services/merge_pairs/",type:"POST",data:{merge_pairs:(c.map(j,function(l){return c.pluck(l,"id").join(",")})).join(";")},cache:false}).done(c.bind(function(){this.remove(k);i.resolve()},this));return i.promise()},parse:function(i){return c.map(i.contacts,c.bind(function(j){return this.model.prototype.parse(j)},this))},_parsePagingInfo:function(i){var j=i.paging;this.totalContacts=j.total;this.paging=j;this.trigger("change:total-contacts",j.total)},_clearPaging:function(){this.totalContacts=0;this.paging={};this.trigger("change:total-contacts")}});b.SortOrder=d;b.SortOrderKey=e;b.Filter=a;Contacts.Collections.Contacts=b})(window,Backbone,jQuery,_);(function(b,d,a){var c=d.Collection.extend({model:Contacts.Models.Company,url:"/contacts/services/get_top_companies/",comparator:function(e){return -e.get("count")||10000},fetch:function(e){if(this._dfd){return this._dfd.promise()}this._dfd=$.Deferred();d.Collection.prototype.fetch.call(this,a.extend({cache:false},e)).always(this._dfd.resolve);return this._dfd.promise()}});Contacts.Collections.Companies=c})(window,Backbone,_);(function(c,d,b){var a=d.Collection.extend({model:Contacts.Models.Location,url:"/contacts/services/get_top_locations/",comparator:function(e){return -e.get("count")||10000},fetch:function(e){if(this._dfd){return this._dfd.promise()}this._dfd=$.Deferred();d.Collection.prototype.fetch.call(this,b.extend({cache:false},e)).always(this._dfd.resolve);return this._dfd.promise()}});Contacts.Collections.Locations=a})(window,Backbone,_);(function(c,e,d,b){var a=e.Collection.extend({model:Contacts.Models.Tag,url:"/contacts/api/tags/",comparator:"name",_dfd:null,initialize:function(g,f){f=b.extend({isDataStore:false},f);if(!f.isContactItemTags){this.on("remove",function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.APP_UNTAG_ITEM,{pageType:MetricsTracker.PageType.AJAX})})}},fetch:function(f){if(this._dfd){return this._dfd.promise()}this._dfd=d.Deferred();e.Collection.prototype.fetch.call(this,b.extend({cache:false},f)).always(this._dfd.resolve);return this._dfd.promise()},hasTagWithName:function(f){f=(d.trim(f)).toLowerCase();for(var h=0;h<this.length;h++){var g=this.models[h].get("name").toLowerCase();if(g===f){return true}}return false},parse:function(f){return f.tags}});Contacts.Collections.Tags=a})(window,Backbone,jQuery,_);(function(b,e,c,a){var d=e.Collection.extend({model:Contacts.Models.Source,comparator:function(f){return f.get("name")}});Contacts.Collections.Sources=d})(window,Backbone,jQuery,_);(function(c,d,b){var a=d.Collection.extend({model:Contacts.Models.Engagement,url:"/contacts/api/engagements/",is_engagement_from_ropod_enabled:false,comparator:function(e){if(this.is_engagement_from_ropod_enabled){return e.get("score")}else{return this.configs[e.type].ordinal}},fields:(function(){var e=["id","name","company","title","location","emails","first_name","last_name"];e.push(c.location.protocol==="https:"?"secure_profile_image_url":"profile_image_url");return e.join(",")})(),getByType:function(f){var e=[];this.each(function(g){if(b.contains(f,g.type)){e.push(g)}});return e},configs:{yesterdays_acquaintance:{ordinal:1,model:Contacts.Models.RecentlyMetEngagement,build:function(e){return[new Contacts.Models.RecentlyMetEngagement(e,{parse:true})]}},job_change:{ordinal:2,model:Contacts.Models.JobChangeEngagement,build:function(e){return[new Contacts.Models.JobChangeEngagement(e,{parse:true})]}},birthday:{ordinal:3,model:Contacts.Models.BirthdayEngagement,build:function(e){return[new Contacts.Models.BirthdayEngagement(e,{parse:true})]}},news_about_network:{ordinal:4,model:Contacts.Models.NewsAboutNetworkEngagement,build:function(e){return[new Contacts.Models.NewsAboutNetworkEngagement(e,{parse:true})]}},work_anniversary:{ordinal:5,model:Contacts.Models.WorkAnniversaryEngagement,build:function(e){return[new Contacts.Models.WorkAnniversaryEngagement(e,{parse:true})]}},location_change:{ordinal:6,model:Contacts.Models.LocationChangeEngagement,build:function(e){return[new Contacts.Models.LocationChangeEngagement(e,{parse:true})]}},reminder:{ordinal:7,model:Contacts.Models.ReminderEngagement,build:function(e){return[new Contacts.Models.ReminderEngagement(e,{parse:true})]}},upcoming_trip:{ordinal:8,model:Contacts.Models.UpcomingTripEngagement,build:function(j){var g=[],h,f,e=j.contacts.length;for(h=0;h<e;h++){f=b.extend({},j,j.contacts[h]);g.push(new Contacts.Models.UpcomingTripEngagement(f,{parse:true}))}return g}},contact_you_may_know:{ordinal:9,model:Contacts.Models.ContactYouMayKnowEngagement,build:function(e){return[new Contacts.Models.ContactYouMayKnowEngagement(e,{parse:true})]}},people_you_may_know:{ordinal:10,model:Contacts.Models.PeopleYouMayKnowEngagement,build:function(e){return[new Contacts.Models.PeopleYouMayKnowEngagement(e,{parse:true})]}},poncho_post:{ordinal:11,model:Contacts.Models.PonchoPostEngagement,build:function(e){return[new Contacts.Models.PonchoPostEngagement(e,{parse:true})]}}},fetch:function(e){var e=b.extend({refresh:false,data:{fields:this.fields}},e);if(this._dfd&&!e.refresh){return this._dfd.promise()}this._dfd=$.Deferred();$.ajax({url:this.url,type:"GET",data:e.data,cache:false}).done(b.bind(function(f){var h=this.parse(f);var g=[];this.is_engagement_from_ropod_enabled=f.is_engagement_from_ropod_enabled;b.each(h,function(j){var i=!!this.get(j.id);this.add(j);if(!i){g.push(j)}},this);this._dfd.resolve(g)},this));return this._dfd.promise()},parse:function(g){var l=g.engagements,n=[],j=[],r=[],p=this.configs,u,h,m,q,f,s,k,o;var e=g.is_engagement_from_ropod_enabled;for(s in l){if(l.hasOwnProperty(s)){q=l[s];o=q.length;f=p[s];if(e===true){for(k=0;k<o;k++){n=n.concat(f.build(q[k]))}}else{for(k=0;k<o;k++){if(q[k].sent_date===undefined){j=j.concat(f.build(q[k]))}else{u=(new Date(q[k].sent_date*1000)).getDate();h=(new Date()).getDate();if(u===h){j=j.concat(f.build(q[k]))}else{r=r.concat(f.build(q[k]))}}}}}}var t=this;if(e===true){n.sort(function(v,i){return i.get("score")-v.get("score")});return n}else{j.sort(function(v,i){return t.configs[v.type].ordinal-t.configs[i.type].ordinal});r.sort(function(v,i){return t.configs[v.type].ordinal-t.configs[i.type].ordinal});return j.concat(r)}}});Contacts.Collections.Engagements=a})(window,Backbone,_);(function(c,d,b){var a=d.Collection.extend({model:Contacts.Models.Meeting,url:"/contacts/api/agenda/",_contactFields:(function(){var e=["id","name","company","title","location","sources","display_sources","first_name","last_name","emails"];e.push(c.location.protocol==="https:"?"secure_profile_image_url":"profile_image_url");return e.join(",")})(),fetch:function(e){if(this._dfd){return this._dfd.promise()}var e=b.extend({data:{contact_fields:this._contactFields}},e);this._dfd=$.Deferred();d.Collection.prototype.fetch.call(this,b.extend({cache:false},e)).always(this._dfd.resolve);return this._dfd.promise()},parse:function(e){return e.agenda}});Contacts.Collections.Agenda=a})(window,Backbone,_);(function(c,a){var b=c.View.extend({initialize:function(){this.subViews=[]},addSubView:function(d){this.subViews.push(d)},dispose:function(){this.trigger("dispose");a.each(this.subViews,function(d){d.dispose()});this.remove()}});Contacts.Views.BaseView=b})(Backbone,_);(function(d,c,b){var a=Contacts.Views.BaseView.extend({events:{"click li[data-li-item-id]":"onItemClicked"},tagName:"ul",className:"items",$itemList:null,template:null,itemTemplate:null,isVisible:false,itemMap:null,initialize:function(e){Contacts.Views.BaseView.prototype.initialize.call(this);this.itemMap={};this._viewMap={};this._data={};this._childViews=[];var e=b.extend({},e);if(e.template){this.template=e.template}if(e.itemTemplate){this.itemTemplate=e.itemTemplate}if(e.className){this.className=e.className}if(e.tagName){this.tagName=e.tagName}if(e.prefix){this.prefix=c(e.prefix)}},_mapItem:function(e){var f=e.data("li-item-id");this.itemMap[f]={$el:e};this.trigger("map",f,e)},_createMap:function(){this.$el.find("li[data-li-item-id]").each(b.bind(function(f,e){this._mapItem(c(e))},this))},renderItemView:function(e){var h=this.$itemList;var g=e.index;if(g>-1){var f=h.children();var i=f.length;if(g<0){g=Math.max(0,i+1+g)}if(g<i){f.eq(g).before(e.$el)}else{h.append(e.$el)}}else{h.append(e.$el)}if(e.view&&e.view.postRender){e.view.postRender(e.$el)}},viewForItem:function(e){return c(this.itemTemplate(e))},_addItem:function(h,f){var e;if(h instanceof d.View){e=h}else{e=this.viewForItem(h,f)}var g;if(e instanceof d.View){this.addSubView(e);this._childViews.push(e);this.listenTo(e,"dispose",function(){delete this.itemMap[e.cid]});g=e.render().$el;g.data("li-item-id",e.cid);g.attr("data-li-item-id",e.cid)}else{g=c(e)}this._mapItem(g,h);return{view:e,$el:g}},addItem:function(g,f){var f=b.defaults({},f,{render:true,index:-1});var e=this._addItem(g,f);e.index=f.index;if(f.render){this.renderItemView(e)}return e},inserItemAt:function(h,g,f){var g=b.defaults({},g,{render:true});var e=this._addItem(h,g);e.index=f;if(g.render){this.renderItemView(e)}return e},removeItem:function(e){this.itemMap[e.id].$el.remove()},getPrefix:function(){return this.prefix},getData:function(){return this._data},setData:function(e){this.clear();this._data=e},clear:function(){this.itemMap={};b.each(this._childViews,function(e){e.dispose()});this._childViews.length=0;if(this.$itemList){this.$itemList.empty()}},render:function(){var e=(this.template&&this.template(this.getData()))||"";if(this.prefix){this.$el.append(this.prefix)}this.$el.append(e);this.$itemList=this.$el.filter(".items").add(this.$el.find(".items"));this._createMap();this.afterRender();return this},afterRender:function(){},onItemClicked:function(g,f){var e=c(g.target);var i=e.closest("li");var h=i.data("li-item-id");this.trigger("click",{id:h,target:i});if(h==="remove"||h==="hide"||h==="unhide"){g.preventDefault()}}});Contacts.Views.ListView=a})(Backbone,jQuery,_);(function(c,e,d,a){var b=Contacts.Views.ListView.extend({events:{"click > li[data-li-item-id] .trigger":"onItemClicked"},className:[Contacts.Views.ListView.prototype.className,"action-menu"].join(" "),_currentMenu:null,_currentAnchor:null,_configs:null,$body:null,initialize:function(f){Contacts.Views.ListView.prototype.initialize.call(this);this._configs={};this.template=this.template||f.template},render:function(){Contacts.Views.ListView.prototype.render.call(this);this.$body=d(document.body);return this},configure:function(f){a.each(f,function(h,g){this._configs[g]=a.extend({loaded:false},h)},this);return this},onItemClicked:function(h){var f=d(h.target);var k=f.closest("li");var j=k.data("li-item-id");var g=this._configs[j];if(g){var i;if(!g.loaded){i=g.menu();g.loaded=true}if(i){i.show()}}this.trigger("menu:clicked",j);if(j==="more"){h.preventDefault()}},hide:function(){this.isVisible=false;this.$el.hide();this.trigger("hidden");return this},show:function(){if(this.isVisible){return}this.isVisible=true;this.$el.show();this.trigger("shown");return this},showMerge:function(){this.$el.find("li[data-li-item-id='merge']").show()},hideMerge:function(){this.$el.find("li[data-li-item-id='merge']").hide()}});Contacts.Views.ActionMenuView=b})(window,Backbone,jQuery,_);(function(d,c,a){var b=Contacts.Views.BaseView.extend({isVisible:null,events:{"click .dropdown-anchor":"onAnchorClicked"},$body:null,$content:null,_hideFn:null,contentView:null,initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);this.isVisible=false;if(this.options.contentView){this.contentView=this.options.contentView}if(this.options.template){this.template=this.options.template}},render:function(){Contacts.Views.BaseView.prototype.render.call(this);if(this.template){this.$el.append(this.template())}this.$body=c(document.body);this.$anchor=this.$el.find(".dropdown-anchor");this.$content=this.$el.find(".dropdown-content");var e=this.contentView;if(e){if(e instanceof d.View){e=e.render().$el}this.$content.append(e)}return this},onAnchorClicked:function(f,e){if(this.isVisible){this.hide()}else{this.show()}},hide:function(){this.isVisible=false;this.$el.removeClass("selected");this.$content.hide();this.trigger("hidden");this.$body.off("click.dropdown:"+this.cid);return this},show:function(){if(this.isVisible){return}this.isVisible=true;this.$el.addClass("selected");this.$content.show().attr("tabindex",-1).focus();this.trigger("shown");this.$body.on("click.dropdown:"+this.cid,this._getHideFunction());return this},_getHideFunction:function(){return this._hideFn||(this._hideFn=a.bind(function(e){if(c(e.target).closest(this.$el).length!==1){this.hide()}},this))}});Contacts.Views.DropdownView=b})(Backbone,jQuery,_);(function(d,f,e,c){var a=Contacts.Views.BaseView.extend({events:{"click .menu-navigation-header":"onBackButtonClicked"},el:e.trim(['<div class="menu-navigation">',"  <ul></ul>","</div>"].join("")),itemTemplate:c.template(e.trim(['<li class="menu-view-container">',"  <% if (title) { %>",'  <header class="menu-navigation-header">',"     <span />","     <h4><%- title %></h4>","  </header>","  <% } %>","</li>"].join(""))),pageWidth:200,transitionDuration:300,isVisible:false,$body:null,_path:null,_selectionMap:null,initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);this._path=[];this._selectionMap={};this.$viewList=this.$el.find("ul");this.pushView(this.options.root,{animate:false})},setPath:function(m,h){this._path=Array.prototype.slice.call(m);var h=c.extend({navigate:true,silent:false},h);this._selectionMap={};if(h.navigate){while(this.subViews.length!==1){this.popView({animate:false})}}var l,k,g;var m=this._path;var g=this.subViews[0].view;var j=0;while(g&&j<m.length){l=m[j];if(g.type===l.type){if(l.id&&g.exists(l.id)){k=g.getItem(l.id);g.select(k);j++;if(h.navigate){g.navigate(k)}}else{g.deselect();g.selectItemWithValue(l)}}g=g.next}if(!h.silent){this.trigger("path:change")}},getPath:function(){var h=[];var g=this.subViews[0].view;while(g&&g.selection){h.push(g.selection);g=g.next}return h},pushView:function(g,i){var i=c.extend({animate:true},i);if(e("html").hasClass("ie7")&&this.subViews.length){this.subViews[this.subViews.length-1].node.css({visibility:"hidden"})}var h=e(this.itemTemplate({title:g.title})).append(g.render().$el);this.subViews.push({view:g,node:h});g.navigationView=this;var j=this._selectionMap[g.type+"-"+g.id];if(j&&g.exists(j.id)){var k=g.getItem(j.id);g.select(k)}else{if(j){g.selectItemWithValue(j)}}this.$viewList.append(h);if(i.animate){this.$viewList.animate({left:"-="+this.pageWidth},{duration:this.transitionDuration})}else{this.$viewList.css("left","-="+this.pageWidth)}},popView:function(g){if(this.subViews.length<=1){return}var h=this.subViews[this.subViews.length-1];if(h.view.previous){h.view.previous.next=null}var g=c.extend({animate:true},g);if(g.animate){this.$viewList.animate({left:"+="+this.pageWidth},{duration:this.transitionDuration,done:c.bind(function(){var i=this.subViews.pop();i.view.dispose();i.node.remove();if(e("html").hasClass("ie7")&&this.subViews.length){this.subViews[this.subViews.length-1].node.css({visibility:""})}},this)})}else{var h=this.subViews.pop();h.view.dispose();h.node.remove();this.$viewList.css("left","+="+this.pageWidth)}},onBackButtonClicked:function(){this.popView(true)}});var b=Contacts.Views.BaseView.extend({tagName:"div",className:"menu-view",navigationView:null,type:null,title:null,selection:null,previous:null,next:null,initialize:function(g){if(g){this.title=g.title}},exists:function(g){return false},getItem:function(){return null},navigate:function(){},deselect:function(){this.selection=null},selectItemWithValue:function(){},select:function(){var g=this.previous;if(g&&g.selection&&g.exists(g.selection.id)){g.select(g.getItem(g.selection.id))}this.navigationView._selectionMap[this.type+"-"+this.id]=this.selection},triggerChange:function(){this.navigationView.trigger("change",{title:this.title,data:this.selection})},pushView:function(g,h){this.next=g;g.previous=this;this.navigationView.pushView(g,h)}});Contacts.Views.MenuNavigationView=a;Contacts.Views.MenuView=b})(window,Backbone,jQuery,_);(function(d,c,b){var a=Contacts.Views.BaseView.extend({sortStep:{title:"Stay on top of your conversations.",content:"<p>See where you left off with each of your contacts. Sort by recent conversation, alphabetically, or by new contacts.</p>",target:".sort-dropdown",orientation:"bottom",width:320,zindex:10},filterStep:{title:"Quickly find who you're looking for.",content:"<p>Keep your contacts organized.  Filter them by company, location, or personalized tags.</p>",target:".filter",orientation:"right",yOffset:-15,zindex:10,width:325},syncStep:{title:"See more ways to keep in touch.",content:"<p>Sync your email and calendar to get the latest updates about all your connections so you never miss an opportunity to reach out.</p>",target:".contacts-list-view > li .name",xOffset:50,yOffset:-20,width:315,zindex:10,showNextButton:false,orientation:"right",onShow:function(){var g=c(".contact-item-view"),e=c(".hopscotch-bubble-content"),f=new Contacts.Views.HopscotchSyncPromoView({cancelButton:"disabled",redirectOnSuccess:"enabled"});if(g.length){c("#hopscotch-done").hide();if(g.first().find(".name a").length){e.find("h3").html("See more ways to keep in touch with "+g.first().find(".name a").html()+".")}f.render()}else{}}},engagementStep:{title:"Never miss a chance to say hello.",content:"<div class=\"engagement-step-content\"><p>Get notified about all the important milestones in your contacts' lives for a smarter way to stay in touch.</p><p class='sync-contacts-text'><a id='sync-contacts-link'>Sync your contacts</a> to get started.</p></div>",target:".engagement-list .items > li .action-button",orientation:"right",yOffset:-15,width:310,zindex:10,onShow:function(){c("#sync-contacts-link").click(function(){c(".hopscotch-content .engagement-step-content").fadeOut(500,function(){c("<p class='hopscotch-sync-promo-text'>Enter your email address to sync your contacts.</p>").hide().fadeIn(500).appendTo(c(".hopscotch-content"));c(".hopscotch-bubble-container").addClass("active");var e=new Contacts.Views.HopscotchSyncPromoView({cancelButton:"enabled",redirectOnSuccess:"disabled"});e.render();e.listenTo(e,"canceled",function(){c(".hopscotch-content .hopscotch-sync-promo-text").fadeOut(500,function(){c(".hopscotch-content .hopscotch-sync-promo-text").remove();c(".hopscotch-content .engagement-step-content").fadeIn(500).show();c(".hopscotch-bubble-container").removeClass("active")})});e.listenTo(e,"success",function(){c(".hopscotch-title").html("Contacts Synced.");c(".hopscotch-sync-promo-text").html("We'll notify you whenever there are opportunities to reach out.  Continue the tour to see what else you can do with Contacts.");c(".hopscotch-bubble-container").removeClass("active").addClass("success")})})})},onNext:function(){c(".hopscotch-bubble-container").removeClass("success")}},engagementTourId:"contacts-engagements-tour",defaultTourId:"contacts-tour",started:false,currentTour:null,hasStarted:function(){return this.started},refresh:function(){this.currentTour.showStep(this.currentTour.getCurrStepNum())},closeTour:function(){this._handleClose();this.currentTour.endTour(false)},startTour:function(e){if(hopscotch&&!this.hasStarted()){this.currentTour=hopscotch.startTour(this._createTour(e));this.started=true}},_createTour:function(e){var f={bubblePadding:0,showPrevButton:false,scrollTopMargin:100};if(e){f.id=this.engagementTourId;f.steps=[this.engagementStep,this.sortStep,b.extend(this.filterStep,{showNextButton:false})]}else{f.id=this.defaultTourId;f.steps=[this.sortStep,this.filterStep,this.syncStep]}f.steps=this._setupTrackingForSteps(f);f.onClose=b.bind(this._handleClose,this);f.onEnd=b.bind(this._handleEnd,this);f.onNext=b.bind(this._handleOnNextTracking,this);return f},_setupTrackingForSteps:function(k){var m=k.id,e=k.steps,f=[],h,j,l;for(var g=0;g<e.length;g++){h=e[g];if(h.onShow){j=h.onShow;h.onShow=this._attachImpressionTrackingOnShow(m,g,j)}else{h.onShow=this._attachImpressionTrackingOnShow(m,g)}f[g]=h}return f},_attachImpressionTrackingOnShow:function(g,f,e){return function(){if(e){e()}Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_STEP,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{tour_id:g,step_number:f}})}},_handleOnNextTracking:function(){var e=this.currentTour.getCurrStepNum(),f=this.currentTour.getCurrTour().id;Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_STEP,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{tour_id:f,step_number_from:e-1,step_number_to:e}})},_handleClose:function(){var e=this.currentTour.getCurrStepNum(),f=this.currentTour.getCurrTour().id;Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_CLOSE,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{tour_id:f,step_closed:e}});this._setState(f,e)},_handleEnd:function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_END,{pageType:MetricsTracker.PageType.AJAX});this._setState()},_setState:function(l,j){var f=c.Deferred(),g="/services/close_promo/",e="ct_onboarding_count",k,h;if(l===this.engagementTourId&&j==0){h="ct_onboarding_partial_close"}else{h="ct_onboarding_close"}k={promo_close_key:h,promo_count_key:e};g=(window.url_path||"")+(window.CONNECTED_SERVICE_PREFIX||"")+g;function i(m){if(m.status==="success"){f.resolve(m)}else{f.reject(m.status_details||"An unspecified error occured")}}c.ajax({url:g,type:"GET",data:k,cache:false,success:i,error:i});f.promise()}});Contacts.Views.TourView=a})(Backbone,jQuery,_);(function(b,a){a.Notification={};_.extend(a.Notification,b.Events)})(Backbone,Contacts);(function(e,f,c){var a={batchSize:5,shouldSendIfUnloaded:true,interval:10000};var b=Object.prototype.toString;function d(g){this.options=c.extend({},a,g);this.queue=[];this.enabled=true;this.init()}d.url="/contacts/api/trackings/";d.EventType={PAGE_VIEW:"pageViewEventType",UNIFIED_IMPRESSION_EVENT_TYPE:"unifiedImpressionEventType",UNIFIED_ACTION_EVENT_TYPE:"unifiedActionEventType"};d.PageType={FULL:"full",AJAX:"ajax"};d.EventAction={CLICK:"CLICK",SHARE:"SHARE",SEND_MESSAGE:"SEND_MESSAGE",HIDE:"HIDE",COMMENT:"COMMENT",LIKE:"LIKE",CONNECT:"CONNECT"};d.Keys=["event_type","pageKey","trackingCode","trackingInfo","pageType"].join(",");d.prototype.init=function(){if(this.options.shouldSendIfUnloaded){f(e).unload(c.bind(this.send,this))}};d.prototype._startTimer=function(){this.timer=e.setTimeout(c.bind(this.send,this),this.options.interval)};d.prototype._stopTimer=function(){e.clearTimeout(this.timer)};d.prototype.send=function(){if(!this.queue.length){return}this._stopTimer();(function g(){if(!this.queue.length){return}var l=Array.prototype.splice.call(this.queue,0,this.options.batchSize);var o=Array.prototype.slice.call(l);for(var m=0;m<o.length;m++){var k=o[m];for(var n in k){if(k.hasOwnProperty(n)&&d.Keys.indexOf(n)===-1){delete k[n]}}var j=k.trackingInfo;if(j){for(var n in j){if(j.hasOwnProperty(n)&&b.call(j[n])!=="[object String]"){j[n]=JSON.stringify(j[n])}}}}var h=f.ajax({url:d.url,type:"POST",data:JSON.stringify(o),cache:false});h.fail(c.bind(function(){this.queue=this.queue.concat(l);this.queue.sort(function(p,i){return p.time>i.time});g.call(this)},this));h.done(c.bind(function(){g.call(this)},this))}).call(this)};d.prototype.add=function(h,g){if(!this.enabled){return}g=c.extend({eventType:d.EventType.PAGE_VIEW,pageKey:h},g,{time:(new Date()).getTime()});g.event_type=g.eventType;delete g.eventType;this.queue.push(g);this._startTimer();if(this.queue.length>=this.options.batchSize){this.send()}};e.MetricsTracker=d})(window,jQuery,_);(function(e,c,a){var b=Contacts.Views.BaseView.extend({tagName:"li",template:Contacts.Templates["contacts/dialogs/manage-tags/item"],events:{"click span.icon-edit":"onEditState","click span.icon-remove-off":"onRemoveState",'click input[name="save"]':"onSaveButtonClicked",'click input[name="delete"]':"onRemoveButtonClicked",'click input[name="cancel"]':"onCancelButtonClicked"},$itemContainer:null,$tagTextbox:null,$tagLabel:null,delegate:null,_state:null,protocol:["canSaveTagWithName"],render:function(){this.$el.append(this.template(this.model.toJSON()));this.$itemContainer=this.$el.find(".li-item-container");this.$tagTextbox=this.$itemContainer.find('input[type="text"]');this.$tagLabel=this.$itemContainer.find("strong");return this},onEditState:function(){this.$el.addClass("state-editing");this._state="edit"},onRemoveState:function(){this.$el.addClass("state-removing");this._state="remove"},onRemoveButtonClicked:function(){this.trigger("remove");this.destroy()},onSaveButtonClicked:function(){this.trigger("save");var f=this.$tagTextbox.val();if(f===this.model.get("name")){setTimeout(a.bind(function(){this.$el.removeClass("state-edited")},this),1000);return}if(this.delegate.canSaveTagWithName(f)){this.rename()}},onCancelButtonClicked:function(){this.trigger("cancel");if(this._state==="edit"){this.$tagTextbox.val(this.model.get("name"))}this.$el.removeClass("state-editing");this.$el.removeClass("state-removing")},destroy:function(){this.dispose();this.model.destroy();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SERVICES_REMOVE_TAG,{pageType:MetricsTracker.PageType.AJAX})},rename:function(){if(this._state!=="edit"){return}var f=this.$tagTextbox.val();this.$el.addClass("state-edited").removeClass("state-editing");this.$tagTextbox.attr("disabled",true);this.$tagLabel.text(f);this.model.rename(f).done(a.bind(function(){this.$el.removeClass("state-edited");this.$tagTextbox.removeAttr("disabled")},this));Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SERVICES_RENAME_TAG,{pageType:MetricsTracker.PageType.AJAX})}});var d=Contacts.Views.ListView.extend({events:null,tagName:"div",className:"li-dialog",template:Contacts.Templates["contacts/dialogs/manage-tags"],initialize:function(f){Contacts.Views.ListView.prototype.initialize.call(this,f);this.collection=Contacts.DataStore.tags},viewForItem:function(g){var f=new b({model:g});f.delegate=this;return f},render:function(){this.$el.attr("id","manageTagsDialog");Contacts.Views.ListView.prototype.render.call(this);var f=[];this.collection.each(function(h){var g=this.addItem(h,{render:false});f.push(g.$el)},this);this.$itemList.append(f);this.dialog=new UIControls.Dialog(this.$el,{title:"Manage Tags"});return this},open:function(){this.dialog.open()},close:function(){this.dialog.close()},afterRender:function(){this.collection.on("add",function(f){this.addItem(f)},this)},onItemClicked:function(f){},canSaveTagWithName:function(f){var g=!!this.collection.findWhere({name:f});if(g){var h=String.formatWithHtmlEscape("{0} already exists.  Please enter a different tag name.",f);this._createError(h)}return !g},_createError:function(f){var g=new UIControls.Alert({message:f,type:"error"});this.$el.prepend(g.$el);window.setTimeout(function(){g.close()},3000);return g}});Contacts.Views.ManageTagsDialogView=d})(Backbone,jQuery,_);(function(e,c,a){var b=Contacts.Views.ListView.extend({tagName:"div",className:"tag-dropdown-list",events:{"click .items > li[data-li-item-id]":"onItemClicked","click .new-tag-save-button":"onSaveTagButtonClicked","keyup .new-tag-textbox":"onNewTagTextBoxKeyUp","click .settings li[data-li-item-id]":"onSettingClicked"},template:Contacts.Templates["contacts/contact/action-menu/tag-menu"],itemTemplate:Contacts.Templates["contacts/contact/action-menu/tag-menu/tag"],$newTagTextBox:null,$loader:null,selectedTagsCollection:null,initialize:function(f){Contacts.Views.ListView.prototype.initialize.call(this);this.selectedTagsCollection=f.selectedTagsCollection||new e.Collection()},getData:function(){return{items:this.collection.toJSON(),itemTemplate:this.itemTemplate}},viewForItem:function(f){return c(this.itemTemplate(f.toJSON()))},getSaveTagNode:function(){return this.itemMap.save.$el},getNewTagNode:function(){return this.itemMap["new"].$el},getNewTagText:function(){return c.trim(this.$newTagTextBox.val())},render:function(){Contacts.Views.ListView.prototype.render.call(this);this.$loader=this.$el.find(".loader").hide();var f=this.getSaveTagNode();f.hide();this.$newTagTextBox=f.find(".new-tag-textbox");this.$newTagSaveButton=f.find(".new-tag-save-button");var g=this.selectedTagsCollection;a.each(this.itemMap,function(h,i){h.$el.find('input[type="checkbox"]').prop("checked",!!g.get(i))});this.listenTo(g,"add",this.onTagAddedToSelectedCollection);this._checkCount();return this},onTagAddedToSelectedCollection:function(f){this.itemMap[f.id].$el.find('input[type="checkbox"]').prop("checked",true)},afterRender:function(){this.collection.on("add",function(f){this.addItem(f,{index:this.collection.indexOf(f)});this.bindTagEvents(f);this._checkCount()},this);this.collection.on("remove",function(f){this.removeItem(f);this._checkCount()},this);this.collection.each(function(f){this.bindTagEvents(f)},this)},bindTagEvents:function(f){this.listenTo(f,"change:id",function(g){this.onTagIdChanged(g)});this.listenTo(f,"change:name",function(g){this.updateItemText(g)})},updateItemText:function(f){this.itemMap[f.id].$el.find("> label").text(f.get("name"))},onTagIdChanged:function(f){var g=this.itemMap[f.previousAttributes()["id"]];delete this.itemMap[f.previousAttributes()["id"]];g.$el.replaceWith(this.viewForItem(f));this.itemMap[f.id]=g},onItemClicked:function(i){var f=c(i.target);var k=f.closest("li");var g=k.find('input[type="checkbox"]');var j=k.data("li-item-id");var h;if(f.is(".checkbox")){h=g.prop("checked")}else{h=!g.prop("checked");g.prop("checked",h)}this.trigger(h?"tagged":"untagged",this.collection.get(j))},onSettingClicked:function(h){var f=c(h.target);var j=f.closest("li");var i=j.data("li-item-id");switch(i){case"new":this.getSaveTagNode().show();this.getNewTagNode().hide();break;case"manage":var g=new Contacts.Views.ManageTagsDialogView();g.render().open();this.trigger("manage");break}return false},onNewTagTextBoxKeyUp:function(){var g=this.getNewTagText();var l=[function(){return g.length>0},a.bind(function(){return !this.collection.hasTagWithName(g)},this)];var k=true,j;for(var h=0,f=l.length;h<f;h++){j=l[h];if(!j()){k=false;break}}this._setSaveButtonEnabled(k)},_setSaveButtonEnabled:function(f){if(f){this.$newTagSaveButton.removeAttr("disabled")}else{this.$newTagSaveButton.attr("disabled","disabled")}},onSaveTagButtonClicked:function(){var f=this.getNewTagText();this.showSpinner();Contacts.DataStore.tags.create({name:f},{wait:true,success:a.bind(function(g){this.hideSpinner();this.getSaveTagNode().hide();this.getNewTagNode().show();this.$newTagTextBox.val("");this._setSaveButtonEnabled(false);this.trigger("tagged",g)},this)});Contacts.MetricsTracker.add(Contacts.Constants.PageKey.APP_TAG_CREATE,{pageType:MetricsTracker.PageType.AJAX})},showSpinner:function(){this.$loader.show();return this},hideSpinner:function(){this.$loader.hide();return this},_checkCount:function(){var f=!!this.collection.length;if(f){this.$el.removeClass("no-tags")}else{this.$el.addClass("no-tags")}}});var d=Contacts.Views.DropdownView.extend({template:null,$link:null,initialize:function(){Contacts.Views.DropdownView.prototype.initialize.apply(this,arguments);this.tagMenuView=new b({collection:Contacts.DataStore.tags,selectedTagsCollection:this.options.selectedTagsCollection});this.listenTo(this.tagMenuView,"manage",this.onTagMenuManage);this.contentView=this.tagMenuView;this.addSubView(this.contentView)},show:function(){Contacts.Views.DropdownView.prototype.show.call(this);this.tagMenuView.showSpinner();Contacts.DataStore.tags.fetch().always(a.bind(this.tagMenuView.hideSpinner,this.tagMenuView))},onTagMenuManage:function(){this.hide()}});Contacts.Views.TagDropdownView=d})(Backbone,jQuery,_);(function(g,j,e,k){var c=Fiber.extend(function(){return{collection:null,get:function(){return e.Deferred().resolve(k.map(this.collection.models,this.format)).promise()},find:function(m){if(!this.collection.length){return null}return this.format(this.collection.findWhere({id:m}))},format:function(){}}});k.extend(c.prototype,j.Events);var f=c.extend(function(m){return{init:function(){this.collection=Contacts.DataStore.companies;this.collection.on("add",function(n){this.trigger("add",this.format(n))},this)},get:function(){var n=e.Deferred();this.collection.fetch({remove:false}).done(k.bind(function(){n.resolve(k.map(this.collection.models,this.format))},this));return n.promise()},format:function(n){if(!n){return}var o=n.get("id");return{type:"company",id:o,text:n.get("name"),query:{company_id:o}}}}});var a=c.extend(function(m){return{init:function(){this.collection=Contacts.DataStore.tags},get:function(){var n=e.Deferred();this.collection.fetch().done(k.bind(function(){n.resolve(k.map(this.collection.models,this.format))},this));return n.promise()},format:function(n){if(!n){return}var o=n.get("id");return{type:"tag",id:o,text:n.get("name"),query:{tag_id:o}}},find:function(n){return m.find.call(this,n)}}});var b=c.extend(function(m){return{init:function(){this.collection=Contacts.DataStore.sources},ignore:[Contacts.Constants.SourceType.LINKEDIN_INTERNAL,Contacts.Constants.SourceType.TWITTER_PUBLIC,Contacts.Constants.SourceType.FACEBOOK_PUBLIC],get:function(){var n=e.Deferred();Contacts.DataStore.user.fetch().done(k.bind(function(){var o=[];this.collection.each(k.bind(function(p){if(!k.contains(this.ignore,p.id)){o.push(this.format(p))}},this));n.resolve(o)},this));return n.promise()},find:function(n){if(!this.collection.length){return null}return this.format(this.collection.findWhere({name:n}))},format:function(o){if(!o){return}var n=o.get("name");return{type:"source",id:n,text:n,query:{source:o.get("source_name")}}}}});var d=c.extend(function(m){return{init:function(){this.collection=Contacts.DataStore.toplocations;this.collection.fetch();this.collection.on("add",function(n){this.trigger("add",this.format(n));Contacts.DataStore.locations.add(n)},this)},get:function(){var n=e.Deferred();this.collection.fetch({remove:false}).done(k.bind(function(){n.resolve(k.map(this.collection.models,this.format))},this));return n.promise()},format:function(o){if(!o){return}var n=o.get("name"),p=o.get("region_code");return{type:"location",id:p?p:n,text:n,query:{location:o.get("region_code")}}}}});var l=c.extend(function(m){return{init:function(){this._existenceMap={};this.collection=Contacts.DataStore.contacts;this.collection.on("add",function(o){var n=this._addIfNotExists(o);if(n){this.trigger("add",n)}},this)},_addIfNotExists:function(o){var q=o.get("title");if(q){var p=this._existenceMap[q];if(!p){var n=this.format(q);this._existenceMap[q]=true;return n}}return null},get:function(){var n=[];k.each(this.collection.models,function(p){var o=this._addIfNotExists(p);if(o){n.push(o)}},this);return e.Deferred().resolve(n).promise()},find:function(n){return this.format(n)},format:function(n){return{type:"title",id:n,text:n,query:{title:n}}}}});var i=Contacts.Views.MenuView.extend({template:Contacts.Templates["contacts/header/filter"],type:"filter",events:{"click .item":"onItemSelected"},listView:null,_dataSource:null,_flattenedData:null,initialize:function(){Contacts.Views.MenuView.prototype.initialize.call(this);this._dataSource=this.dataSource();this._flattenedData=this._dataSource.filters.concat(this._dataSource.top).concat(this._dataSource.others);this.filtersIds=k.pluck(this._dataSource.filters,"id");this.listView=new Contacts.Views.ListView({template:this.template});this.listView.setData(this._dataSource);this.listenTo(this.listView,"map",this.onListViewItemMapped)},onListViewItemMapped:function(n,m){this.listView.itemMap[n].$checkmark=m.find(".checkmark");this.listView.itemMap[n].data=k.findWhere(this._flattenedData,{id:n})},exists:function(m){return !!this.listView.itemMap[m]},getItem:function(m){return this.listView.itemMap[m]},dataSource:function(){var o,r;var w=[{id:"all",text:"All Contacts"},{id:"connections",text:"Connections Only",query:{source:"LinkedIn"}}];var n={key:"filter:company",id:"company",text:"Company",filter:f,options:{maxItems:5,placeholder:"Enter company"}};var x={id:"tag",text:"Tag",filter:a,options:{showSearch:false}};var u={id:"location",text:"Location",filter:d,options:{maxItems:5,placeholder:"Enter location"}};var t={key:"filter:title",id:"title",text:"Title",filter:l,options:{maxItems:5,placeholder:"Enter title"}};var p={id:"source",text:"Source",filter:b,options:{showSearch:false}};var s={id:"saved",text:"Saved",query:{bookmarked:true}};var m={key:"filter:hidden",id:"hidden",text:"Hidden",query:{visible:"hidden"}};var v={key:"filter:duplicates",id:"duplicates",text:"Potential duplicates"};if(Contacts.Lix.get("is-linkedin-only")){o=[n,x,u,t,p];r=[s]}else{o=[n,x,u,t,p];r=[s,m,v]}var q={top:w,filters:o,others:r};k.each(q,function(y,z){k.each(y,function(B,A){if(B.key&&!Contacts.Lix.isEnabled(B.key)){y.splice(A,1)}})});return q},onItemSelected:function(o){var m=e(o.target);var q=m.closest("li");var p=q.data("li-item-id");var n=this.listView.itemMap[p];this.selection=n.data;if(k.indexOf(this.filtersIds,p)!==-1){this.navigate(n)}else{this.select(n);this.triggerChange()}},navigate:function(o){if(k.indexOf(this.filtersIds,o.data.id)===-1){return}var m=k.extend({},{filter:new o.data.filter(),title:o.data.text,id:o.data.id},o.data.options);var n=new Contacts.Views.SubFilterMenuView(m);this.pushView(n)},deselect:function(){Contacts.Views.MenuView.prototype.deselect.call(this);if(this._previousCheckmark){this._previousCheckmark.removeClass("checked");this._previousCheckmark=null}},select:function(m){this.selection=m.data;Contacts.Views.MenuView.prototype.select.call(this);if(this._previousCheckmark){this._previousCheckmark.removeClass("checked")}m.$checkmark.addClass("checked");this._previousCheckmark=m.$checkmark},render:function(){this.$el.append(this.listView.render().$el);return this}});var h=Contacts.Views.MenuView.extend({events:{"click .item":"onItemSelected"},type:"sub-filter",className:[Contacts.Views.MenuView.prototype.className,"sub-filter-menu-view"].join(" "),template:Contacts.Templates["contacts/header/filter/sub-filter"],$loader:null,listView:null,filter:null,_dataSource:null,defaults:{showSearch:true,maxItems:-1},initialize:function(){Contacts.Views.MenuView.prototype.initialize.apply(this,arguments);this.options=k.extend({},this.defaults,this.options);this.filter=this.options.filter;this.checkmarkMap={};this.listView=new Contacts.Views.ListView({template:this.template,itemTemplate:Contacts.Templates["contacts/header/filter/sub-filter/item"]});this.listenTo(this.listView,"map",this.onListViewItemMapped);this._itemsRenderedDfd=e.Deferred()},onItemAdded:function(n){this.listView.inserItemAt(n,null,this._dataSource.items.length);this.listView.itemMap[n.id].data=n;var m=this.listView.itemMap[n.id];if(this.selection&&this.selection.id===n.id){this._check(m);this.selection=n;this.navigationView.trigger("path:change")}},exists:function(m){return !!this.listView.itemMap[m]},getItem:function(m){return this.listView.itemMap[m]},onListViewItemMapped:function(n,m){this.listView.itemMap[n].$checkmark=m.find(".checkmark");this.listView.itemMap[n].data=k.findWhere(this._dataSource.items,{id:n})},getUrlQueryStrings:function(){var p=[],o;var m=g.location.href.slice(g.location.href.indexOf("?")+1).split("&");for(var n=0;n<m.length;n++){o=m[n].split("=");p.push(o[0]);p[o[0]]=o[1]}return p},getDefaultSearchQuery:function(m){var n=this.getUrlQueryStrings();if(n.searchQueryType===m&&n.searchQuery){return n.searchQuery}},dataSource:function(){var m=e.Deferred();this.filter.get().done(k.bind(function(n){var o=n;if(this.options.maxItems!==-1){o=n.slice(0,this.options.maxItems)}m.resolve({items:o,placeholder:this.options.placeholder,showSearch:this.options.showSearch,defaultSearchQuery:this.getDefaultSearchQuery(this.options.id)})},this));return m.promise()},onItemSelected:function(o){var m=e(o.target);var q=m.closest("li");var p=q.data("li-item-id");var n=this.listView.itemMap[p];if(p==="search"){return}this.select(n);this.triggerChange()},deselect:function(){Contacts.Views.MenuView.prototype.deselect.call(this);if(this._previousCheckmark){this._previousCheckmark.removeClass("checked");this._previousCheckmark=null}},select:function(m){this.selection=m.data;this._check(m)},_check:function(m){Contacts.Views.MenuView.prototype.select.call(this);this._clearCheck();m.$checkmark.addClass("checked");this._previousCheckmark=m.$checkmark},_clearCheck:function(){if(this._previousCheckmark){this._previousCheckmark.removeClass("checked")}},onReady:function(m){this._itemsRenderedDfd.done(k.bind(m,this))},selectItemWithValue:function(m){if(!m.id){this.selection=m;this.onReady(function(){if(this.searchInputView){this.searchInputView.setValue(this.selection.text)}});return}this.selection=this.filter.find(m.id);if(!this.selection){this.selection=m;this.filter.get().done(k.bind(function(n){var o=this.filter.find(m.id);if(o){this.selection=o}},this))}this.onReady(function(){var n=this.listView.itemMap[m.id];if(n){this._check(n);this.selection=n.data;this.navigationView.trigger("path:change")}else{if(this.filter.find(m.id)){if(this.searchInputView){this.searchInputView.setValue(this.filter.find(m.id).text);this.selection=this.filter.find(m.id);this.navigationView.trigger("path:change")}}}})},render:function(){this.$loader=e('<span class="loader"></span>').hide();this.$loader.appendTo(this.$el);this._showSpinner();this.dataSource().done(k.bind(function(m){this._afterDataReady(m);this._itemsRenderedDfd.resolve()},this));return this},_afterDataReady:function(m){this._dataSource=m;this.listView.setData(this._dataSource);this.$el.append(this.listView.render().$el);this.listenTo(this.filter,"add",this.onItemAdded);this._hideSpinner();if(this.options.showSearch){this._renderSearch()}if(this.options.showSearch){this._renderSearch()}},_renderSearch:function(){this.searchInputView=new Contacts.Views.SearchInputView({autoClear:false,autocomplete:false});this.searchInputView.setElement(this.$el.find(".search-input"));this.searchInputView.render();this.searchInputView.expand();this.listenTo(this.searchInputView,"change",this.onSearchChange)},onSearchChange:function(n){this.selection={text:n};var m={};m[this.previous.selection.id]=n;this._clearCheck();Contacts.Views.MenuView.prototype.select.call(this);this.navigationView.trigger("search",m);return false},_showSpinner:function(){this.$loader.show();return this},_hideSpinner:function(){this.$loader.hide();return this}});Contacts.Views.FilterMenuView=i;Contacts.Views.SubFilterMenuView=h})(window,Backbone,jQuery,_);(function(d,c,a){var b=Contacts.Views.BaseView.extend({$body:null,loadingContacts:false,initialize:function(e){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);e||(e={});this.autoClear=(e.autoClear===void 0)?true:e.autoClear;this.autocomplete=(e.autocomplete===void 0)?false:e.autocomplete},render:function(){Contacts.Views.BaseView.prototype.render.call(this);this.$body=c(document.body);this.$searchInput=this.$el.find("input");this.$searchInput.placeholderFix();this.$searchClose=this.$el.find(".search-clear");this.bindEvents();return this},bindEvents:function(){this.$searchInput.on("click",a.bind(this.onInputClicked,this));this.$searchInput.on("keyup",a.bind(this.onInputKeyUp,this));this.$searchInput.on("keydown",a.bind(this.onInputKeyDown,this));this.$searchClose.on("click",a.bind(this.onClearClicked,this))},onInputKeyDown:function(f){f.stopPropagation();var e=f.which;switch(e){case 13:f.preventDefault();if(this.$searchInput.val()===""){this.$body.trigger("click.search-input:"+this.cid)}else{this.trigger("change",this.$searchInput.val());this.collapse()}break}},onInputClicked:function(){if(this.autocomplete){this.loadAutocompleteData(true)}this.expand()},onInputKeyUp:function(f){var e=this.$searchInput.val().length>0;if(e){this.showClose()}else{this.hideClose()}f.preventDefault()},onClearClicked:function(){this.$body.trigger("click.search-input:"+this.cid);this.$searchInput.val("");this.hideClose();event.preventDefault()},showClose:function(){this.$searchClose.show()},hideClose:function(){this.$searchClose.hide()},clear:function(){if(this.autoClear){this.$searchInput.val("")}if(this.$searchInput.val().length<=0){this.hideClose()}this.trigger("clear")},setValue:function(e){this.$searchInput.val(decodeURIComponent(e));this.showClose()},expand:function(){this.$searchInput.addClass("active");this.$body.on("click.search-input:"+this.cid,this._getHideFunction())},collapse:function(){this.clear();this.$searchInput.removeClass("active");this.$searchInput.blur();this.$body.off("click.search-input:"+this.cid)},_getHideFunction:function(){return this._hideFn||(this._hideFn=a.bind(function(e){if(c(e.target).closest(this.$el).length!==1){this.collapse()}},this))},loadAutocompleteData:function(e){if(!e&&this.loadingContacts){return}this.loadingContacts=true;Contacts.DataStore.contacts.fetchAutocompleteContacts().done(a.bind(function(f){this._setupAutocomplete(f)},this))},_setupAutocomplete:function(g){var f,e={searchTypeahead:true,selectFirst:false,width:"213px",scrollHeight:280,formatMatch:function(h){return h.name},formatResult:function(h){return h.name},formatItem:function(h){return String.formatWithHtmlEscape(f,((h.profile_image_url&&h.profile_image_url.length>0)?h.profile_image_url:Contacts.Constants.DEFAULT_IMAGE_URL),h.name)}};if(!!window.CONNECTED_SERVICE_PREFIX){f=['<img src="{0}" />','<h4 class="item-headline">{1}</h4>','<p class="item-subline"></p>'];e=c.extend(e,{width:"213px",max:5})}else{f=['<div style="float:left">','<img src="{0}" height="40px" width="40px" />',"</div>",'<div style="padding-left:40px; margin-left:5px;">{1}</div>']}f=f.join("");this.$searchInput.unautocomplete().autocomplete(g,e).result(a.bind(this._goToProfile,this));this.bindEvents()},_goToProfile:function(f,e){if(e&&e.id){window.location=String.formatWithUriEscape("/contacts/view?id={0}&trk=contacts-contacts-list-contact_name-0",e.id)}}});Contacts.Views.SearchInputView=b})(Backbone,jQuery,_);(function(d,c,a){var b=Contacts.Views.DropdownView.extend({template:null,initialize:function(){Contacts.Views.DropdownView.prototype.initialize.apply(this,arguments);var e=new Contacts.Views.FilterMenuView();this.navigationView=new Contacts.Views.MenuNavigationView({root:e});this.listenTo(this.navigationView,"change",this.onFilterNavigationViewChanged);this.listenTo(this.navigationView,"search",this.onFilterNavigationSearch);this.listenTo(this.navigationView,"path:change",this.onFilterNavigationViewPathChanged);this.contentView=this.navigationView;this.addSubView(this.contentView)},render:function(){Contacts.Views.DropdownView.prototype.render.call(this);this.$strong=this.$anchor.find("strong");this.navigationView.setPath([{type:"filter",id:"all"}],{silent:true});return this},reset:function(){this.navigationView.setPath([{type:"filter",id:"all"}],{silent:true});this.setMenuSubtext(this._getNameFromPath())},updateMenuSubtext:function(){this.setMenuSubtext(this._getNameFromPath())},setMenuSubtext:function(e){this.$strong.text(decodeURIComponent(e))},onFilterNavigationViewChanged:function(e){this.setMenuSubtext(this._getNameFromPath());this.hide()},onFilterNavigationViewPathChanged:function(){this.setMenuSubtext(this._getNameFromPath())},onFilterNavigationSearch:function(){this.setMenuSubtext(this._getNameFromPath());this.hide()},_getNameFromPath:function(){return this.navigationView.getPath().pop().text}});Contacts.Views.ContactListFilterDropdownView=b})(Backbone,jQuery,_);(function(d,b,a){var c=Contacts.Views.DropdownView.extend({template:null,itemTemplate:Contacts.Templates["contacts/header/sort/list-item"],_$previousSelected:null,_$alphabetIndex:null,initialize:function(g){Contacts.Views.DropdownView.prototype.initialize.call(this);this.sortList=new Contacts.Views.ListView({template:Contacts.Templates.list,className:[Contacts.Views.ListView.prototype.className,"sort-dropdown"].join(" ")});var k={id:"recent",name:"Recent Conversation"};var i={id:"alphabetical",name:"Alphabetical"};var f={id:"first_name",name:"First Name"};var e={id:"last_name",name:"Last Name"};var h={id:"new",name:"New"};var j;if(Contacts.Lix.get("last-name-sort-enabled")){j=[k,e,f,h]}else{j=[k,i,h]}this.sortList.setData({items:j,itemTemplate:this.itemTemplate});this.listenTo(this.sortList,"click",this.onSortItemClickedChanged);this.contentView=this.sortList;this.addSubView(this.contentView)},render:function(){Contacts.Views.DropdownView.prototype.render.call(this);this.$strong=this.$anchor.find("strong");this.selectItem("recent");return this},selectItem:function(g){var f=this.sortList.itemMap[g];f.$el.find("div").addClass("checked");if(this._$previousSelected&&this._$previousSelected.id!==g){this._$previousSelected.item.$el.find("div").removeClass("checked")}this._$previousSelected={item:f,id:g};if(!this._$alphabetIndex||this._$alphabetIndex.length==0){this._$alphabetIndex=b("#contact-list-organizer-menu > li.alphabet")}if(Contacts.Lix.get("filter-by-letter-enabled")){var e=["first_name","last_name","alphabetical"];if(a.indexOf(e,g)>-1){this._$alphabetIndex.show()}else{this._$alphabetIndex.hide()}}},updateSortDisplay:function(f){var e=a.findWhere(this.sortList.getData().items,{id:f});this.selectItem(e.id);this.$strong.text(e.name)},onSortItemClickedChanged:function(e){this.selectItem(e.id);if(e.id){var f=a.findWhere(this.sortList.getData().items,{id:e.id});this.$strong.text(f.name);this.hide()}}});Contacts.Views.ContactListSortDropdownView=c})(Backbone,jQuery,_);(function(d,b,a){var c=Contacts.Views.DropdownView.extend({template:null,itemTemplate:Contacts.Templates["contacts/header/sort/list-item"],_$previousSelected:null,_$removeButton:null,_$scrubber:null,initialDropdownText:null,events:a.extend(Contacts.Views.DropdownView.prototype.events,{"click li.remove label":"removeAlphabetFilter"}),initialize:function(e){Contacts.Views.DropdownView.prototype.initialize.call(this);a.bindAll(this,"removeAlphabetFilter");this.alphabetList=new Contacts.Views.ListView({template:Contacts.Templates.list,className:[Contacts.Views.ListView.prototype.className,"alphabet-dropdown"].join(" "),prefix:Contacts.Templates["contacts/header/list-remove"]()});var f=a.map("abcdefghijklmnopqrstuvwxyz".split(""),function(g){return{id:g,name:g.toUpperCase()}});this.alphabetList.setData({items:f,itemTemplate:this.itemTemplate});this.listenTo(this.alphabetList,"click",this.onAlphabetIndexItemClickedChanged);this.contentView=this.alphabetList;this.addSubView(this.contentView);this._$removeButton=this.alphabetList.getPrefix()},render:function(){Contacts.Views.DropdownView.prototype.render.call(this);this.$strong=this.$anchor.find("strong");this.initialDropdownText=this.$strong.text();return this},removeAlphabetFilter:function(){if(this._$previousSelected){this._$previousSelected.item.$el.find("label").removeClass("selected");this._$removeButton.hide();this.trigger("clear",{});this.$strong.text(this.initialDropdownText);this.hide()}},resetAlphabetIndexDisplay:function(){if(this._$previousSelected){this._$previousSelected.item.$el.find("label").removeClass("selected");this._$removeButton.hide();this.$strong.text(this.initialDropdownText);this.hide()}},selectItem:function(f){var e=this.alphabetList.itemMap[f];e.$el.find("label").addClass("selected");if(this._$previousSelected&&this._$previousSelected.id!==f){this._$previousSelected.item.$el.find("label").removeClass("selected")}this._$previousSelected={item:e,id:f};this._$removeButton.show()},updateAlphabetIndexDisplay:function(f){var e=a.findWhere(this.alphabetList.getData().items,{id:f});this.selectItem(e.id);this.$strong.text(e.name)},onAlphabetIndexItemClickedChanged:function(e){if(e.id){if(e.id=="remove"){this.removeAlphabetFilter()}else{this.selectItem(e.id);var f=a.findWhere(this.alphabetList.getData().items,{id:e.id});this.$strong.text(f.name)}}this.hide()}});Contacts.Views.ContactListAlphabetIndexDropdownView=c})(Backbone,jQuery,_);(function(d,c,b){var a=Contacts.Views.BaseView.extend({tagName:"li",className:"contact-item-view",template:Contacts.Templates["contacts/contact"],tagTemplate:Contacts.Templates["contacts/contact/tag-pills/tag"],removeDialogTemplate:Contacts.Templates["contacts/dialogs/remove"],actionMenuView:null,$bottomContainer:null,$tagPills:null,$checkbox:null,$body:null,_tagPillMap:null,isSelected:false,events:{mouseover:"onMouseOver",mouseout:"onMouseOut","click .company":"onCompanyClicked","click .title":"onTitleClicked","click .location":"onLocationClicked","click .tag-list li a":"onTagClicked","click .source-container a":"onSourceClicked",'click input[type="checkbox"]':"onCheckboxClicked"},_lockActionMenu:false,_actionMenuVisible:false,defaults:{enableActionMenu:true,showCheckbox:true},initialize:function(){Contacts.Views.BaseView.prototype.initialize.call(this);this._tagPillMap={};this.options=b.extend({},this.defaults,this.options)},_createTagMap:function(){b.each(this.$tagPills.find("li"),b.bind(function(f){var e=c(f);this._tagPillMap[e.data("li-tag-id")]=e},this))},_addTagPill:function(e){var f=c(this.tagTemplate(e.toJSON()));this._tagPillMap[e.id]=f;this.$tagPills.append(f)},_rerenderTagPills:function(){var e=this.model.get("tags");this.$tagPills.off().empty();e.each(b.bind(function(f){this._addTagPill(f)},this))},_removeTagPill:function(e){var f=this._tagPillMap[e.id];if(!f){return}f.remove();delete this._tagPillMap[e.id]},_replaceTagPill:function(e){var h=e.previousAttributes().id;var g=(h!==e.id)?this._tagPillMap[h]:this._tagPillMap[e.id];var f=c(this.tagTemplate(e.toJSON()));g.replaceWith(f);g.remove();this._tagPillMap[e.id]=f},hide:function(){var e=c.Deferred();var f=this.$el.parent();f.css("overflow","hidden");this.$el.css({position:"relative",overflow:"hidden"}).animate({left:-this.$el.width(),opacity:0},200,b.bind(function(){f.css("overflow","");this.$el.animate({"padding-top":0,"padding-bottom":0,height:0},b.bind(function(){this.dispose();e.resolve()},this))},this));this.trigger("hidden");return e.promise()},unselect:function(){this.isSelected=false;this.$checkbox.prop("checked",false)},select:function(){if(!this.options.showCheckbox){return}this.isSelected=true;this.$checkbox.prop("checked",true)},format:function(){var e=this.model.get("last_interaction");return b.extend({},this.model.toJSON(),{displayName:this.model.displayName(),isConnection:this.model.isConnection(),defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL,last_interaction:e?moment(new Date(e)).fromNow():null,tagTemplate:this.tagTemplate,showCheckbox:this.options.showCheckbox})},render:function(){this.$body=c(document.body);this.$el.html(this.template(this.format()));this.$bottomContainer=this.$el.find(".bottom-container");this.$checkboxContainer=this.$el.find("> .checkbox-container");this.$checkbox=this.$checkboxContainer.find('input[type="checkbox"]');this.$tagPills=this.$bottomContainer.find(".tag-list");this.$sourceContainer=this.$el.find(".source-container");this.$actionMenuContainer=this.$el.find(".action-menu-container");this.$title=this.$el.find(".title");this.$company=this.$el.find(".company");this.$location=this.$el.find(".location");this._createTagMap();if(!this.options.showCheckbox){this.$checkboxContainer.css("visibility","hidden")}this.afterRender();return this},afterRender:function(){var e=this.model.get("tags");this.listenTo(e,"add",b.bind(this.onModelTagAdded,this));this.listenTo(e,"remove",b.bind(this.onModelTagRemoved,this));this.listenTo(Contacts.DataStore.tags,"remove",b.bind(this.onModelTagRemoved,this));e.each(function(f){this.bindTagEvents(f)},this);this.$el.find(".contact-source").tooltip()},bindTagEvents:function(e){this.listenTo(e,"change:name",function(f){this._replaceTagPill(f)});this.listenTo(e,"change:id",function(f){this._replaceTagPill(f)})},onCheckboxClicked:function(){this.isSelected=this.$checkbox.prop("checked");this.trigger("change:select",this.isSelected)},onModelTagAdded:function(e){this._rerenderTagPills();this.bindTagEvents(e);Contacts.MetricsTracker.add(Contacts.Constants.PageKey.APP_TAG_ITEM,{pageType:MetricsTracker.PageType.AJAX})},onModelTagRemoved:function(e){this._removeTagPill(e);this.stopListening(e)},_addActionMenu:function(){this.actionMenuView=new Contacts.Views.ActionMenuView({template:Contacts.Templates["contacts/contact/action-menu"]});this.actionMenuView.setData({canConnect:this.model.canConnect()});this.actionMenuView.render().hide().$el.appendTo(this.$actionMenuContainer);this.actionMenuView.configure({tag:{menu:b.bind(this._createTagDropdown,this)},more:{menu:b.bind(this._createMoreDropdown,this)}});this.actionMenuView.show();this.listenTo(this.actionMenuView,"menu:clicked",this.onActionMenuItemSelected);this.addSubView(this.actionMenuView)},_createTagDropdown:function(){var e=new Contacts.Views.TagDropdownView({selectedTagsCollection:this.model.get("tags")});e.setElement(this.actionMenuView.$el.find(".tag-dropdown"));e.render();this.listenTo(e.tagMenuView,"tagged",this.onTagMenuTagged);this.listenTo(e.tagMenuView,"untagged",this.onTagMenuUntagged);return e},_createMoreDropdown:function(){var f=new Contacts.Views.ListView({template:Contacts.Templates.list});var e=[];if(!Contacts.Lix.get("is-linkedin-only")){if(this.model.get("hidden")){e.push({id:"unhide",name:"Unhide"})}else{e.push({id:"hide",name:"Hide"})}}e.push({id:"remove",name:this._getRemoveText()});f.setData({items:e,itemTemplate:Contacts.Templates["list/item"]});this.listenTo(f,"click",this.onMoreMenuClicked);var g=new Contacts.Views.DropdownView({contentView:f});g.setElement(this.actionMenuView.$el.find(".more-dropdown"));g.render();return g},_getRemoveText:function(){return("Remove "+(this.model.isConnection()?"connection":"from Contacts"))},onTagMenuTagged:function(e){this.model.tag({added:e});this.bindTagEvents(e)},onTagMenuUntagged:function(e){this.model.tag({removed:e})},onActionMenuItemSelected:function(e){this.trigger("action-menu:anchored",this);this._lockActionMenu=true;switch(e){case"message":Connected.UI.Dialogs.openMessage(this.model.id);break;case"connect":Connected.UI.Dialogs.openLinkedInConnect(this.model.id);break}},onMoreMenuClicked:function(e){switch(e.id){case"hide":this.hide().done(b.bind(function(){this.model.hide();this.dispose()},this));break;case"unhide":this.hide().done(b.bind(function(){this.model.unhide();this.dispose()},this));break;case"remove":this.showRemoveDialog();break}},onTagClicked:function(g){var e=c(g.target);var f=e.closest("li").data("li-tag-id");this.trigger("tag:click",this.model.get("tags").get(f));g.preventDefault()},onSourceClicked:function(f){var e=c(f.target);var g=e.closest("a").data("li-item-id");this.trigger("source:click",this.model.get("sources").findWhere({name:g}));f.preventDefault()},onTitleClicked:function(e){e.preventDefault();this.trigger("title:click",this.model.get("title"))},onCompanyClicked:function(e){e.preventDefault();this.trigger("company:click",this.model.get("company"))},onLocationClicked:function(e){e.preventDefault();this.trigger("location:click",this.model.get("location"))},onMouseOver:function(){this.showActionMenu()},onMouseOut:function(){if(this._lockActionMenu){return}this.hideActionMenu()},showActionMenu:function(){if(!this.options.enableActionMenu){return}if(!this.actionMenuView){this._addActionMenu()}this.actionMenuView.show();this.$body.off("click.action-menu:"+this.cid).on("click.action-menu:"+this.cid,this._getHideFunction())},hideActionMenu:function(){if(!this.actionMenuView){return}this.actionMenuView.hide();this._lockActionMenu=false;this.$body.off("click.action-menu:"+this.cid)},showRemoveDialog:function(){var f={displayName:this.model.displayName(),isConnection:this.model.isConnection()};var g=c(this.removeDialogTemplate({contact:f,isBulk:false,removeContacts:[f]}));var h=this.model.isConnection()?"Remove {0} as a connection":"Remove {0} from Contacts";var e=new UIControls.Dialog(g,{title:String.format(h,this.model.displayName())});g.find(".ok-button").on("click",b.bind(function(){if(this.model.isConnection()){this.model.removeConnection()}e.close();this.hide().done(b.bind(function(){this.model.destroy();this.dispose()},this))},this));g.find(".cancel-button").on("click",function(){e.close()});e.open()},_getHideFunction:function(){return this._hideFn||(this._hideFn=b.bind(function(e){if(c(e.target).closest(this.$el).length!==1){this.hideActionMenu()}},this))}});Contacts.Views.ContactListItemView=a})(Backbone,jQuery,_);(function(b,e,c,a){var d=Contacts.Views.ListView.extend({className:[Contacts.Views.ListView.prototype.className,"contacts-list-view"].join(" "),_loading:false,_currentListItemView:null,contactListItemViews:null,contactListItemViewsMap:null,initialize:function(){Contacts.Views.ListView.prototype.initialize.call(this);this.contactListItemViews=[];this.contactListItemViewsMap={};this.listenTo(this.collection,"remove",this.onContactModelRemoved)},viewForItem:function(h,g){var g=a.extend({},g,{model:h});var f=new Contacts.Views.ContactListItemView(g);this.contactListItemViews.push(f);this.contactListItemViewsMap[h.id]=f;this.listenTo(f,"action-menu:anchored",this.onContactListViewItemActionMenuShown);this.listenTo(f,"source:click",function(i){this.trigger("source:click",i)});this.listenTo(f,"tag:click",function(i){this.trigger("tag:click",i)});this.listenTo(f,"company:click",function(i){this.trigger("company:click",i)});this.listenTo(f,"title:click",function(i){this.trigger("title:click",i)});this.listenTo(f,"location:click",function(i){this.trigger("location:click",i)});this.listenTo(f,"change:select",function(i){this.onContactListSelectChange(f,i)});this.listenTo(f,"hidden",function(){this.onContactListItemHidden(f)});this.listenTo(f,"remove",function(){this.onContactListItemRemove(f)});return f},onContactListItemHidden:function(f){this._removeContactListItemFromList(f)},onContactListItemRemove:function(f){this._removeContactListItemFromList(f)},_removeContactListItemFromList:function(g){for(var h=0,f=this.contactListItemViews.length;h<f;h++){var j=this.contactListItemViews[h];if(j===g){this.contactListItemViews.splice(h,1);break}}},onContactListSelectChange:function(f,g){this.trigger("change:select")},selectAll:function(){a.each(this.contactListItemViews,a.bind(function(f){f.select()},this))},unselectAll:function(){a.each(this.contactListItemViews,function(f){f.unselect()})},selectedViews:function(){return a.where(this.contactListItemViews,{isSelected:true})},onContactModelRemoved:function(g){var f=this.contactListItemViewsMap[g.id];if(f){f.hide()}},renderNextBatch:function(g){var h=[],f;g=a.extend({trackTarget:false},g);f=this.collection.next(g.trackTarget);return f.done(a.bind(function(i){a.each(i,a.bind(function(k){var j=this.addItem(k,{render:false});h.push(j.$el)},this));this.$el.append(h)},this))},render:function(){Contacts.Views.ListView.prototype.render.call(this);a.each(this.contactListItemViews,function(f){});return this},onContactListViewItemActionMenuShown:function(f){if(this._currentListItemView&&this._currentListItemView!==f){this._currentListItemView.hideActionMenu()}this._currentListItemView=f},clear:function(){a.each(this.contactListItemViews,function(f){f.dispose()});this.contactListItemViews.length=0}});Contacts.Views.ContactListView=d})(window,Backbone,jQuery,_);(function(c,e,d,b){var a=Contacts.Views.BaseView.extend({tagName:"header",className:"contact-list-header",template:Contacts.Templates["contacts/header"],countTemplate:Contacts.Templates["contacts/header/count"],events:{"click .action-add-contact a":"onMenuAddContactClick","click #select-checkbox":"onSelectedAllCheckboxClicked","click .scroll-to-top":"onScrollToTopClicked"},$contactListActionSection:null,$selectAllCheckbox:null,actionMenuView:null,tagDropdownView:null,moreDropdownView:null,initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);this.setupViews()},setupViews:function(){this._addActionMenuView();this._addContactsCountView()},_addActionMenuView:function(){this.actionMenuView=new Contacts.Views.ActionMenuView({template:Contacts.Templates["contacts/header/action-menu"]});this.actionMenuView.setData({isLinkedinOnlyProfile:Contacts.Lix.get("is-linkedin-only")});this.listenTo(this.actionMenuView,"menu:clicked",this.onActionMenuItemSelected);this.addSubView(this.actionMenuView)},_addContactsCountView:function(){this.listenTo(this.collection,"change:total-contacts",this.onContactsTotalChanged)},render:function(){this.$el.append(this.template());this.$contactListActionSection=this.$el.find("#contact-list-action-section");this.$contactListNavigation=this.$el.find("#contact-list-navigation");this.$selectAllCheckbox=this.$el.find("#select-checkbox");this.$organizerMenu=this.$el.find("#contact-list-organizer-menu");this.$topMenu=this.$el.find("#contact-list-top-menu");this.$scrollTop=this.$contactListActionSection.find(".scroll-to-top");this.$filterMenu=this.$organizerMenu.find(".filter");this.$sortMenu=this.$organizerMenu.find(".sort");this.$alphabetIndexMenu=this.$organizerMenu.find(".alphabet");this._renderSearch();this._renderSortDropdown();this._renderFilterDropdown();this._renderAlphabetIndexDropdown();this._renderActionMenu();return this},isSelectedAllChecked:function(){return this.$selectAllCheckbox.prop("checked")},clearSelection:function(){this.$selectAllCheckbox.prop("checked",false)},resetFilter:function(){this.filterDropdownView.reset()},selectCheckbox:function(){this.$selectAllCheckbox.prop("checked",true)},_renderSearch:function(){this.searchInputView=new Contacts.Views.SearchInputView({autocomplete:true});this.searchInputView.setElement(this.$el.find(".search-input"));this.searchInputView.render();this.listenTo(this.searchInputView,"change",this.onSearchChange)},_renderActionMenu:function(){this.actionMenuView.render().hide().$el.appendTo(this.$contactListActionSection);this.actionMenuView.configure({tag:{menu:b.bind(this._createTagDropdown,this)},more:{menu:b.bind(this._createMoreDropdown,this)}});this.listenTo(this.actionMenuView,"shown",this.onActionMenuShown);this.listenTo(this.actionMenuView,"hidden",this.onActionMenuHidden)},_createTagDropdown:function(){this.tagDropdownView=new Contacts.Views.TagDropdownView();this.tagDropdownView.setElement(this.actionMenuView.$el.find(".tag-dropdown"));this.tagDropdownView.render();this.listenTo(this.tagDropdownView.tagMenuView,"tagged",this.onTagMenuTagged);this.listenTo(this.tagDropdownView.tagMenuView,"untagged",this.onTagMenuUntagged);this.listenTo(this.tagDropdownView.tagMenuView,"manage",this.onTagMenuManage);return this.tagDropdownView},_createMoreDropdown:function(){var h=new Contacts.Views.ListView({template:Contacts.Templates.list});var g=[];if(!Contacts.Lix.get("is-linkedin-only")){g.push({id:"hide",name:"Hide"});g.push({id:"unhide",name:"Unhide"})}g.push({id:"remove",name:"Remove from Contacts"});h.setData({items:g,itemTemplate:Contacts.Templates["list/item"]});this.listenTo(h,"click",this.onMoreMenuClicked);this.moreDropdownView=new Contacts.Views.DropdownView({contentView:h});this.moreDropdownView.setElement(this.actionMenuView.$el.find(".more-dropdown"));this.moreDropdownView.render();var f=function(j){if(!h.itemMap.hasOwnProperty("unhide")){return}if(j){h.itemMap.unhide.$el.show();h.itemMap.hide.$el.hide()}else{h.itemMap.unhide.$el.hide();h.itemMap.hide.$el.show()}};var i=this.filterDropdownView.contentView.getPath();f(i.length&&i[0].id==="hidden");this.listenTo(this.filterDropdownView.contentView,"change",function(j){f(j.data.id==="hidden")});return this.moreDropdownView},_renderSortDropdown:function(){this.sortDropdownView=new Contacts.Views.ContactListSortDropdownView();this.sortDropdownView.setElement(this.$sortMenu.find(".dropdown"));this.sortDropdownView.render();this.listenTo(this.sortDropdownView.contentView,"click",this.onSortDropdownClick)},_renderFilterDropdown:function(){this.filterDropdownView=new Contacts.Views.ContactListFilterDropdownView();this.filterDropdownView.setElement(this.$filterMenu.find(".dropdown"));this.filterDropdownView.render();this.listenTo(this.filterDropdownView.contentView,"change",this.onFilterNavigationViewChange);this.listenTo(this.filterDropdownView.contentView,"search",this.onFilterNavigationViewSearch)},_renderAlphabetIndexDropdown:function(){this.alphabetIndexDropdownView=new Contacts.Views.ContactListAlphabetIndexDropdownView();this.alphabetIndexDropdownView.setElement(this.$alphabetIndexMenu.find(".dropdown"));this.alphabetIndexDropdownView.render();this.listenTo(this.alphabetIndexDropdownView.contentView,"click",this.onLetterChange);this.listenTo(this.alphabetIndexDropdownView,"clear",this.onLetterClear)},_updateCount:function(){var g=this.filterDropdownView.contentView.getPath();var f=this.countTemplate({title:g.length&&g[g.length-1].text,count:this.collection.totalContacts});if(this.$count){this.$count.remove()}this.$count=d(f).hide();this.$count.appendTo(this.$contactListActionSection)},onContactsTotalChanged:function(){this._updateCount()},onActionMenuShown:function(){this.hideCount()},onActionMenuHidden:function(){},onTagMenuTagged:function(f){this.trigger("action:tags:add",f)},onTagMenuUntagged:function(f){this.trigger("action:tags:remove",f)},onTagMenuManage:function(){this.trigger("action:tags:manage")},onActionMenuItemSelected:function(f){this.trigger("action:"+f)},onMoreMenuClicked:function(f){this.trigger("action:more:"+f.id)},onSelectedAllCheckboxClicked:function(){var f=this.$selectAllCheckbox.prop("checked");if(f){this.trigger("select-all");this.actionMenuView.show();if(this.collection.totalContacts>1){this.actionMenuView.showMerge()}else{this.actionMenuView.hideMerge()}}else{this.trigger("unselect-all");this.actionMenuView.hide()}},onSortDropdownClick:function(f){this.trigger("sort:change",f)},onLetterChange:function(f){this.trigger("alphabet:change",f)},onLetterClear:function(f){this.trigger("alphabet:clear",f)},onFilterNavigationViewChange:function(f){this.trigger("filter:change",f);this._updateCount()},onFilterNavigationViewSearch:function(f){this.trigger("filter:search",f)},onMenuAddContactClick:function(f){f.preventDefault();Connected.UI.Dialogs.openAddContact()},onSearchChange:function(f){this.trigger("search:change",{name:f})},onScrollToTopClicked:function(){this.trigger("click:scroll-top")},showCount:function(){if(this.$count){this.$count.show()}},hideCount:function(){if(this.$count){this.$count.hide()}},dock:function(){this.$el.addClass("docked");if(this.isGlobalNavVisible()){this.$el.addClass("global-nav-shown")}else{this.$el.removeClass("global-nav-shown")}this._updateCount();this.showCount()},undock:function(){this.$el.removeClass("docked");this.hideCount()},isGlobalNavVisible:function(){var f=d(".responsive-nav"),g="";if(f){g=f.css("position")}return g==="static"}});Contacts.Views.ContactListHeaderView=a})(window,Backbone,jQuery,_);(function(o,f,p){var d=Contacts.Views.BaseView.extend({tagName:"li",className:"engagement-card",numItemsPerRow:3,actionButtonSelector:"input.save-button:visible, input.btn-linkedin",template:Contacts.Templates.engagement,events:{"click .action-button":"onActionButtonClicked"},initialize:function(){this.bindEvents()},bindEvents:function(){this.listenTo(this.model,"change:completed",this.onModelChangeComplete)},format:function(){return p.extend({},this.model.toJSON(),{displayName:this.model.get("contact").displayName(),defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL})},render:function(){this.$el.html(this.template(this.format()));this.$actionButton=this.$el.find(".action-button");this.$actionButtonGlyph=this.$actionButton.find("span");return this},onModelChangeComplete:function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.ENGAGE_EVENT_COMPLETE,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{ee_type:this.model.type,position:this.$el.index()}});this.render();this.close()},getLinesLeft:function(s){var y=this.$el.find(".engagement-body-right"),x=y.height(),r=y.find(".header"),v=r.height(),A=parseInt(s.css("line-height"),10),w=parseInt(s.css("margin-top"),10)+parseInt(s.css("margin-bottom"),10),u=parseInt(s.css("padding-top"),10)+parseInt(s.css("padding-bottom"),10),z=x-(v+w+u),t=Math.floor(z/A);return t},onModelChangeDismiss:function(){},onActionButtonClicked:function(){},cancel:function(){},close:function(){var r=this.$el.position();this.trigger("closed",this,r)},calculateEventPosition:function(t){var r=(t)%this.numItemsPerRow;if(r===0){r=this.numItemsPerRow}var s=Math.ceil((t)/this.numItemsPerRow);var u=s+":"+r;return u},sendActionTrackingEvent:function(r,u,t){var w=document.getElementById("lnkd-contacts-base-page-config"),s=w.attributes.getNamedItem("module-key").value;var v="";if(t.get("request_id")!==undefined){v=t.get("request_id")}Contacts.MetricsTracker.add(Contacts.Constants.PageKey.ENGAGE_EVENT_COMPLETE,{pageType:MetricsTracker.PageType.AJAX,eventType:MetricsTracker.EventType.UNIFIED_ACTION_EVENT_TYPE,trackingInfo:f.extend({},{moduleKey:s,position:r,action:u,action_type:"single",engageEventId:t.get("engage_event_id"),activity:t.get("thread_id"),customProperties:{requestId:v,propType:t.type,alterMemberId:t.get("contact").get("linkedin_id"),alterContactId:t.get("contact").get("id")}})})}});var m={};m.Dialog={onActionButtonClicked:function(){d.prototype.onActionButtonClicked.call(this);this.showDialog()},showDialog:function(){this.dialog().done(p.bind(function(r){this.onDialogOpened(r)},this))},dialog:function(){throw new Error("<Mixing.Dialog::dialog> not implemented")},onDialogOpened:function(s,t){var r=this;if(t){s.actionButton.on("click",function(){var v=this.value,u;switch(v){case"Send Message":u=MetricsTracker.EventAction.SEND_MESSAGE;break;case"Send Email":u=MetricsTracker.EventAction.SEND_MESSAGE;break;case"Tweet":u=MetricsTracker.EventAction.SEND_MESSAGE;break;case"Post to Face Book Wall":u=MetricsTracker.EventAction.SEND_MESSAGE;break;case"Share":u=MetricsTracker.EventAction.SHARE;break;case"Comment":u=MetricsTracker.EventAction.COMMENT;break;case"Send Invitation":u=MetricsTracker.EventAction.CONNECT;break}m.Dialog.trackPosition.call(r,u)})}s.on("closed",p.bind(function(v,u){if(u&&u.action==="done"){this.model.complete(true)}else{this.cancel()}},this))},trackPosition:function(s){var r=this.$el.index(),t=d.prototype.calculateEventPosition(r+1);d.prototype.sendActionTrackingEvent(t,s,this.model)},onLikeButtonClicked:function(){this.model.complete(true);this.trackPosition(MetricsTracker.EventAction.LIKE)}};m.Dismiss={className:[d.prototype.className,"with-dimiss-button"].join(" "),events:p.extend({},d.prototype.events,{"click .dismiss-button":"onDismissButtonClicked","click .engagement-body-left a":"onProfileImageOrNameClicked","click .engagement-body-right a":"onProfileImageOrNameClicked"}),onDismissButtonClicked:function(){var t=this.trackActionEvent;if(t){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.ENGAGE_EVENT_SKIP,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{ee_type:this.model.type,position:this.$el.index()}});var r=this.$el.index(),s=d.prototype.calculateEventPosition(r+1);d.prototype.sendActionTrackingEvent(s,MetricsTracker.EventAction.HIDE,this.model)}this.model.dismiss();this.close()},onProfileImageOrNameClicked:function(){var x=this.trackActionEvent;var w=document.getElementById("lnkd-contacts-base-page-config"),r=w.attributes.getNamedItem("module-key").value;if(x){var s=this.$el.index(),t=d.prototype.calculateEventPosition(s+1);var v="";if(model.get("request_id")!==undefined){v=model.get("request_id")}var u={pageType:MetricsTracker.PageType.AJAX,pageKey:"profile-page-view-redirect",event_type:MetricsTracker.EventType.UNIFIED_ACTION_EVENT_TYPE,trackingInfo:f.extend({},{moduleKey:r,position:t,action:MetricsTracker.EventAction.CLICK,action_type:"single",engageEventId:this.model.get("engage_event_id"),activity:this.model.get("thread_id"),customProperties:{propType:this.model.type,requestId:v,alterMemberId:this.model.get("contact").get("linkedin_id"),alterContactId:this.model.get("contact").get("id")}})};return f.ajax({url:"/contacts/api/trackings/",type:"POST",data:JSON.stringify([u]),cache:false})}}};var e=d.extend(p.extend({template:Contacts.Templates["engagement/birthday"]},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{format:function(){return p.extend({},this.model.toJSON(),{displayName:this.model.get("contact").displayName(),defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL,numDays:this.model.getHowManyDaysAgo(),sentDate:this.model.getSentDateFormatter().format("MMMM, DD")})},trackActionEvent:true}));var l=d.extend(p.extend({template:Contacts.Templates["engagement/job-change"],onTitleClicked:function(r){r.preventDefault();Contacts.Notification.trigger("change:title",this.model.get("title"))},onCompanyClicked:function(r){r.preventDefault();Contacts.Notification.trigger("change:company",this.model.get("company"))}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true);r.on("like",p.bind(this.onLikeButtonClicked,this))}},m.Dismiss,{events:p.extend({},m.Dismiss.events,{"click .title":"onTitleClicked","click .company":"onCompanyClicked"}),trackActionEvent:true}));var a=d.extend(p.extend({template:Contacts.Templates["engagement/work-anniversary"],onCompanyClicked:function(r){r.preventDefault();Contacts.Notification.trigger("change:company",this.model.get("company"))}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true);r.on("like",p.bind(this.onLikeButtonClicked,this))}},m.Dismiss,{events:p.extend({},m.Dismiss.events,{"click .company":"onCompanyClicked"}),trackActionEvent:true}));var h=d.extend(p.extend({template:Contacts.Templates["engagement/poncho-post"],onCompanyClicked:function(r){}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true);r.on("like",p.bind(this.onLikeButtonClicked,this))}},m.Dismiss,{events:p.extend({},m.Dismiss.events,{}),trackActionEvent:true}));var q=d.extend(p.extend({template:Contacts.Templates["engagement/location-change"],postRender:function(t){var s=this.$el.find(".content"),r=this.getLinesLeft(s);if(r<1){s.hide()}else{if(r===1){s.html("Share <a class='location-link link' href='#'>who you know</a> there.")}else{if(r===2){s.ellipsis({row:2});s.html(s.html().replace("who you know","<a class='location-link link' href='#'>who you know</a>"))}else{s.ellipsis({row:3});s.html(s.html().replace("who you know","<a class='location-link link' href='#'>who you know</a>"))}}}},onLocationLinkClicked:function(r){r.preventDefault();Contacts.Notification.trigger("change:location",this.model.get("new_location"))}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openLocationChange(this.model.get("contact").id,this.model.type,this.model.get("update_time"),this.model.get("new_location").get("name"),this.model.get("old_location"),this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{events:p.extend({},m.Dismiss.events,{"click .location-link":"onLocationLinkClicked"}),trackActionEvent:true}));var k=d.extend(p.extend({template:Contacts.Templates["engagement/recently-met"],postRender:function(t){var s=this.$el.find(".content"),r=this.getLinesLeft(s);if(r<1){s.hide()}else{s.ellipsis({row:r})}}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openLinkedInConnect(this.model.get("contact").id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{format:function(){return p.extend({},this.model.toJSON(),{displayName:this.model.get("contact").displayName(),defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL,numDays:this.model.getHowManyDaysAgo(),metDate:this.model.getDayBeforeSendDateFormatter().format("MMMM, Do")})},trackActionEvent:true}));var c=d.extend(p.extend({template:Contacts.Templates["engagement/news"],postRender:function(r){this.$el.find(".article-link").ellipsis({row:3})},onArticleLinkClicked:function(r){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.DAILY_PEOPLE_NEWS_ARTICLE_LINK,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{articleId:this.model.get("articles")[0].articleId,member_id:this.model.get("contact").id}})},onShareButtonClicked:function(t){var r=this.$el.index(),s=d.prototype.calculateEventPosition(r+1);d.prototype.sendActionTrackingEvent(s,MetricsTracker.EventAction.SHARE,this.model)}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{events:p.extend({},m.Dismiss.events,{"click .article-link":"onArticleLinkClicked"}),trackActionEvent:true}));var i=d.extend(p.extend({template:Contacts.Templates["engagement/upcoming-trip"],postRender:function(t){var s=this.$el.find(".content"),u=this.$el.find(".engagement-body-right"),r=this.getLinesLeft(s);if(r<=1){s.hide()}else{if(r===2){s.html("You're traveling on <span class='dates'>"+u.find(".dates").html()+"</span>.")}}}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openMessageByEngageEventId(this.model.id,this.actionButtonSelector)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{trackActionEvent:true}));var j=d.extend(p.extend({template:Contacts.Templates["engagement/reminder"],postRender:function(t){var s=this.$el.find(".content"),r=this.getLinesLeft(s);if(r<1){s.hide()}else{s.ellipsis({row:r})}},onActionButtonClicked:function(){d.prototype.onActionButtonClicked.call(this);this.model.complete()}},m.Dismiss,{trackActionEvent:false}));var g=d.extend({template:Contacts.Templates["engagement/meetings"],initialize:function(){d.prototype.initialize.apply(this,arguments);this._dialogCache=null},bindEvents:function(){},format:function(){var s=[];var t=[];this.collection.each(function(u){p.each(u.get("contacts").models,function(v){var w=v.id;if(p.indexOf(s,w)===-1){s.push(w);t.push(v)}})});var r=t[0];return p.extend({},this.collection.toJSON(),{contact:r?p.extend(r.toJSON(),{displayName:r.displayName()}):null,defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL,contactsCount:s.length,count:this.collection.length,others:(function(){if(t.length>3){return p.map(t.slice(1,4),function(u){return p.extend(u.toJSON(),{displayName:u.displayName()})})}return[]})()})},onActionButtonClicked:function(){if(this._dialogCache){this._dialogCache.open();return}var r=new Contacts.Views.AgendaDialogView({collection:this.collection,title:String.format("Meetings for {0}",moment(new Date()).format("dddd, MMMM DD"))});r.render().open();r.setSelectedIndex(0);this._dialogCache=r}});var n=d.extend(p.extend({template:Contacts.Templates["engagement/contact-you-may-know"],postRender:function(t){var s=this.$el.find(".content"),r=this.getLinesLeft(s);if(r<1){s.hide()}else{s.ellipsis({row:r})}}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openLinkedInConnect(this.model.get("contact").id)},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{trackActionEvent:true}));var b=d.extend(p.extend({template:Contacts.Templates["engagement/people-you-may-know"],postRender:function(t){var s=this.$el.find(".content"),r=this.getLinesLeft(s);if(r<1){s.hide()}else{s.ellipsis({row:r})}}},m.Dialog,{dialog:function(){return Connected.UI.Dialogs.openLinkedInConnectWithoutContactId(this.model.get("linkedin_id"),this.model.get("auth_name"),this.model.get("auth_value"))},onDialogOpened:function(r){m.Dialog.onDialogOpened.call(this,r,true)}},m.Dismiss,{trackActionEvent:true}));Contacts.Views.EngagementListItemViewListItemView=d;Contacts.Views.BirthdayEngagementListItemView=e;Contacts.Views.JobChangeEngagementListItemView=l;Contacts.Views.WorkAnniversaryEngagementListItemView=a;Contacts.Views.LocationChangeEngagementListItemView=q;Contacts.Views.RecentlyMetEngagementListItemView=k;Contacts.Views.NewsAboutNetworkEngagementListItemView=c;Contacts.Views.UpcomingTripEngagementListItemView=i;Contacts.Views.ReminderEngagementListItemView=j;Contacts.Views.MeetingsEngagementListItemView=g;Contacts.Views.ContactYouMayKnowEngagementListItemView=n;Contacts.Views.PeopleYouMayKnowEngagementListItemView=b;Contacts.Views.PonchoPostEngagementListItemView=h})(Backbone,jQuery,_);(function(d,b,a){var c=Contacts.Views.BaseView.extend({tagName:"div",className:"more-bar",template:Contacts.Templates["engagements/more-bar"],events:{click:"onClick"},format:function(){return{contacts:this.contacts,defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL}},render:function(){this.$el.html(this.template(this.format()));return this},onClick:function(){this.trigger("click")}});Contacts.Views.EngagementMoreBarView=c})(Backbone,jQuery,_);(function(d,e,c){var h=Fiber.extend(function(){return{get:function(){throw new Error("::get:: not implemented.")},createView:function(i){throw new Error("::createView:: not implemented.")}}});var b=h.extend(function(){return{init:function(){this.collection=Contacts.DataStore.engagements},configs:{birthday:Contacts.Views.BirthdayEngagementListItemView,job_change:Contacts.Views.JobChangeEngagementListItemView,work_anniversary:Contacts.Views.WorkAnniversaryEngagementListItemView,location_change:Contacts.Views.LocationChangeEngagementListItemView,yesterdays_acquaintance:Contacts.Views.RecentlyMetEngagementListItemView,news_about_network:Contacts.Views.NewsAboutNetworkEngagementListItemView,upcoming_trip:Contacts.Views.UpcomingTripEngagementListItemView,reminder:Contacts.Views.ReminderEngagementListItemView,poncho_post:Contacts.Views.PonchoPostEngagementListItemView},get:function(){var i=e.Deferred();var j=this;var k=function(m){var l=[];c.each(m,function(n){if(j.configs[n.type]){l.push({contact:n.get("contact"),toView:function(o){return j.createView(n,o)}})}});return l};this.collection.fetch().done(function(l){i.resolve(k(l))});return i.promise()},createView:function(k,j){var j=c.extend({},j,{model:k});var i=this.configs[k.type];return new i(j)}}});var g=h.extend(function(){return{init:function(){this.collection=Contacts.DataStore.engagements;this.number_of_events_by_types=0;this.start_point=0},configs:{contact_you_may_know:Contacts.Views.ContactYouMayKnowEngagementListItemView},types:["contact_you_may_know"],get:function(k){k=c.extend({},{additional_size:3,dismissed:0},k);var i=e.Deferred();var j=this;var l=function(n){var m=[];c.each(n,function(o){if(j.configs[o.type]){m.push({contact:o.get("contact"),toView:function(p){return j.createView(o,p)}})}});return m};j.number_of_events_by_types=this.collection.getByType(["contact_you_may_know"]).length;this.start_point=j.number_of_events_by_types;this.collection.fetch({refresh:true,data:{type_list:this.types.join(","),size:k.additional_size,start:this.start_point-k.dismissed,fields:this.collection.fields}}).done(function(m){i.resolve(l(m))});return i.promise()},createView:function(k,j){var j=c.extend({},j,{model:k});var i=this.configs[k.type];return new i(j)}}});var f=h.extend(function(){return{init:function(){this.collection=Contacts.DataStore.engagements;this.number_of_events_by_types=0;this.start_point=0},configs:{people_you_may_know:Contacts.Views.PeopleYouMayKnowEngagementListItemView},types:["people_you_may_know"],get:function(k){k=c.extend({},{additional_size:3,dismissed:0},k);var i=e.Deferred();var j=this;var l=function(n){var m=[];c.each(n,function(o){if(j.configs[o.type]){m.push({contact:o.get("contact"),toView:function(p){return j.createView(o,p)}})}});return m};j.number_of_events_by_types=this.collection.getByType(["people_you_may_know"]).length;this.start_point=j.number_of_events_by_types;this.collection.fetch({refresh:true,data:{type_list:this.types.join(","),size:k.additional_size,start:this.start_point-k.dismissed,fields:this.collection.fields}}).done(function(m){i.resolve(l(m))});return i.promise()},createView:function(k,j){var j=c.extend({},j,{model:k});var i=this.configs[k.type];return new i(j)}}});var a=h.extend(function(){return{init:function(){this.collection=Contacts.DataStore.agenda},get:function(){var i=e.Deferred();var j=this;var k=this.collection;k.fetch().done(function(){i.resolve(k.length?[{contact:(function(){for(var l=0;l<k.length;l++){var m=k.at(l).get("contacts");if(m&&m.length){return m.first()}}return null})(),toView:function(l){return j.createView(k,l)}}]:[])});return i.promise()},createView:function(j,i){var i=c.extend({},i,{collection:j});return new Contacts.Views.MeetingsEngagementListItemView(i)}}});Contacts.Adapters.StaticEngagementsAdapter=b;Contacts.Adapters.MeetingsAdapter=a;Contacts.Adapters.ContactYouMayKnowEngagementsAdapter=g;Contacts.Adapters.PeopleYouMayKnowEngagementsAdapter=f})(window,jQuery,_);(function(k,h,n){var o=Fiber.extend(function(){return{start:function(p){},fetchOldEngageEvent:function(q,p){return h.ajax({url:"/contacts/api/engagements/",type:"GET",data:{contact_id:q,type:p,fields:Contacts.Collections.Engagements.prototype.fields},cache:false})},openDialog:function(p){}}});var f=o.extend(function(p){return{start:function(r){var q=r.id;var s=Contacts.DataStore.agenda;s.fetch().done(function(){var t=new Contacts.Views.AgendaDialogView({collection:s,title:String.format("Meetings for {0}",moment(new Date()).format("dddd, MMMM DD"))});t.render().open();t.setSelectedIndex(q)})}}});var l=o.extend(function(p){return{type:"yesterdays_acquaintance",start:function(r){var q=this.type;var s=Contacts.DataStore.engagements;s.fetch().done(n.bind(function(){var t=s.find(function(u){return u.type===q&&(u.get("contact").id+"")===(r.id+"")});if(t){this.openDialog(t)}else{this.fetchOldEngageEvent(r.id,this.type).done(n.bind(function(v){if(v.engagement){var u=new Contacts.Models.RecentlyMetEngagement(v.engagement,{parse:true});this.openDialog(u)}},this))}},this))},openDialog:function(q){Connected.UI.Dialogs.openLinkedInConnect(q.get("contact").id).done(function(r){r.on("closed",function(t,s){if(s&&s.action==="done"){q.complete()}})})}}});var e=o.extend(function(p){return{type:"birthday",start:function(r){var q=this.type;var s=Contacts.DataStore.engagements;s.fetch().done(n.bind(function(){var t=s.find(function(u){return u.type===q&&(u.get("contact").id+"")===(r.id+"")});if(t){this.openDialog(t)}else{this.fetchOldEngageEvent(r.id,this.type).done(n.bind(function(v){if(v.engagement){var u=new Contacts.Models.BirthdayEngagement(v.engagement,{parse:true});this.openDialog(u)}},this))}},this))},openDialog:function(q){Connected.UI.Dialogs.openMessage(q.get("contact").id,this.type).done(function(r){r.on("closed",function(t,s){if(s&&s.action==="done"){q.complete()}})})}}});var m=o.extend(function(p){return{type:"location_change",start:function(r){var q=this.type;var s=Contacts.DataStore.engagements;s.fetch().done(n.bind(function(){var t=s.find(function(u){return u.type===q&&(u.get("contact").id+"")===(r.id+"")});if(t){this.openDialog(t)}else{this.fetchOldEngageEvent(r.id,this.type).done(n.bind(function(v){if(v.engagement){var u=new Contacts.Models.LocationChangeEngagement(v.engagement,{parse:true});this.openDialog(u)}},this))}},this))},openDialog:function(q){Connected.UI.Dialogs.openLocationChange(q.get("contact").id,q.type,q.get("update_time"),q.get("new_location").get("name"),q.get("old_location")).done(function(r){r.on("closed",function(t,s){if(s&&s.action==="done"){q.complete()}})})}}});var j=o.extend(function(p){return{type:"reminder",start:function(r){var q=this.type;var s=Contacts.DataStore.engagements;s.fetch().done(function(){var t=s.find(function(u){return u.type===q&&(u.get("contact").id+"")===(r.id+"")});if(t){t.complete()}})}}});var c=function(){return{start:function(q){var p=this.type;var r=Contacts.DataStore.engagements;r.fetch().done(n.bind(function(){var s=r.find(function(t){return t.type===p&&(t.get("contact").id+"")===(q.id+"")});if(s){this.openDialog(s)}else{this.fetchOldEngageEvent(q.id,this.type).done(n.bind(function(u){if(u.engagement){var t=new Contacts.Models.WorkAnniversaryEngagement(u.engagement,{parse:true});if(t){this.openDialog(t)}}},this))}},this))},openDialog:function(p){Connected.UI.Dialogs.openMessageByEngageEventId(p.id).done(function(q){q.on("closed",function(s,r){if(r&&r.action==="done"){p.complete()}});q.on("like",function(s,r){p.complete()})})}}};var d=o.extend(function(p){return{type:"work_anniversary"}});Fiber.mixin(d,c);var b=o.extend(function(p){return{type:"job_change"}});Fiber.mixin(b,c);var i=o.extend(function(p){return{type:"poncho_post"}});Fiber.mixin(i,c);var g=o.extend(function(p){return{type:"news_about_network"}});Fiber.mixin(g,c);var a=o.extend(function(p){return{type:"upcoming_trip",start:function(r){var q=this.type;var s=Contacts.DataStore.engagements;s.fetch().done(n.bind(function(){var t=s.find(function(u){return u.type===q&&(u.get("contact").id+"")===(r.id+"")});if(t){this.openDialog(t)}else{this.fetchOldEngageEvent(r.id,this.type).done(n.bind(function(w){var v=w.engagement;if(!v||v.count!==1){return}v=n.extend({},v,v.contacts[0]);var u=new Contacts.Models.UpcomingTripEngagement(v,{parse:true});if(u){this.openDialog(u)}},this))}},this))},openDialog:function(q){Connected.UI.Dialogs.openMessageByEngageEventId(q.id).done(function(r){r.on("closed",function(t,s){if(s&&s.action==="done"){q.complete()}})})}}});Contacts.Triggers={agenda:f,yesterdays_acquaintance:l,birthday:e,work_anniversary:d,job_change:b,news_about_network:g,upcoming_trip:a,location_change:m,reminder:j,poncho_post:i}})(window,jQuery,_);(function(b,e,d,a){var c=Contacts.Views.ListView.extend({defaults:{numRowsToDisplay:1,numItemsPerRow:3,numRemainingItemsBeforeLoadingMore:3,rearrangeWithAnimation:false},className:"engagement-list",tagName:"div",template:Contacts.Templates.engagements,_insertedItems:null,_remainingItems:null,engagementListItemViews:null,startIndex:0,currentHeight:0,itemHeight:186+10,$engagementsContainer:null,$moreBarContainer:null,$moreBarWrapper:null,hasStaticItems:false,staticItemsChecked:false,hasDynamicItems:false,dynamicItemsChecked:false,hasMeetingItem:false,meetingItemChecked:false,cymk_dismissed:0,pymk_dismissed:0,syncPromoRendered:false,syncPromoEngagementView:null,$syncPromoEngagement:null,call_cymk:true,initialize:function(){Contacts.Views.ListView.prototype.initialize.call(this);this.options=a.extend({},this.defaults,{numRowsToDisplay:Contacts.Lix.get("more-engage-events-num-rows")},this.options);this.numRemainingItemsBeforeLoadingMore=this.options.numRowsToDisplay*this.options.numItemsPerRow;this.engagementListItemViews=[];this._insertedItems=[];this._remainingItems=[];this._impressionTrackingEvents=[];this._scoredEntity=[];this._modelId="Legacy";this.currentPage=0;this.initialEngageEventsNumRows=parseInt(d("#lnkd-contacts-base-page-config").data("initialEngageEventsNumRows"));this.renderDfd=d.Deferred();this.loadItems();this.addMoreBarView()},_updateScroller:function(){var h=this._remainingItems.slice(0,this.options.numItemsPerRow);if(!h.length){this.$moreBarWrapper.css("visibility","hidden")}else{this.$moreBarContainer.show();this.$moreBarWrapper.css("visibility","visible")}var f=a.map(h,function(i){return i.contact?i.contact.toJSON():null});var g=Math.ceil(this._insertedItems.length/this.options.numItemsPerRow);if(this.currentHeight!==(g*this.itemHeight)){this.$itemList.css("height",(g*this.itemHeight)+"px");this.currentHeight=g*this.itemHeight;setTimeout(a.bind(function(){this.trigger("engagement-rendered")},this),1000)}this.moreBarView.contacts=f;this.moreBarView.render().$el.appendTo(this.$moreBarWrapper);if(this._remainingItems.length<this.numRemainingItemsBeforeLoadingMore){this._loadDynamicEngageEvents()}},_getSlotsToInsert:function(){var h=this.initialEngageEventsNumRows*this.options.numItemsPerRow,g=(this.currentPage*this.options.numItemsPerRow*this.options.numRowsToDisplay),f=h+g;return f-this._insertedItems.length},_insertIfThereAreAvailableSlots:function(){var f=0,g=this._getSlotsToInsert();if(!g){return}while(f<g&&this._remainingItems.length>0){this._renderNextItem();f++}this._sendImpressionTrackingEvent()},_sendImpressionTrackingEvent:function(){var g=document.getElementById("lnkd-contacts-base-page-config"),f=g.attributes.getNamedItem("module-key").value;Contacts.MetricsTracker.add(Contacts.Constants.PageKey.ENGAGE_EVENTS_SEE_MORE,{pageType:MetricsTracker.PageType.AJAX,eventType:MetricsTracker.EventType.UNIFIED_IMPRESSION_EVENT_TYPE,trackingInfo:d.extend({},{modelId:this._modelId,moduleKey:f,results:this._impressionTrackingEvents})});this._scoredEntity=[];this._impressionTrackingEvents=[]},_renderNextItem:function(){var g=this._insertNextItem(),f;f=this.addItem(g);this._generateScoredEntity(this._insertedItems.length,f);return g},_generateScoredEntity:function(k,l){if(!l||!l.view||!l.view.model){return}if(l.view.model.type==="reminder"){return}var h=l.view.model.get("engage_event_id");var f=l.view.model.get("thread_id");var o=k%this.options.numItemsPerRow;if(o===0){o=this.options.numItemsPerRow}var j=Math.ceil(k/this.options.numItemsPerRow);var m=j+":"+o;var n=l.view.model.get("model_id");if(n!==undefined){this._modelId=n}var i=0;var p=l.view.model.get("score");if(p!==undefined){i=p}var g="";if(l.view.model.get("request_id")!==undefined){g=l.view.model.get("request_id")}this._scoredEntity=d.extend({},{scoredEntity:{engageEventId:h,activityId:f,score:i},position:m,customProperties:{requestId:g,propType:l.view.model.type,alterMemberId:l.view.model.get("contact").get("linkedin_id"),alterContactId:l.view.model.get("contact").get("id")}});this._impressionTrackingEvents.push(this._scoredEntity)},_insertNextItem:function(){var f=this._remainingItems.shift();this._insertedItems.push(f);return f},renderEngagementSyncPromo:function(f){if(!this.syncPromoRendered){this.syncPromoEngagementView=new Contacts.Views.EngagementSyncPromoView(f);this.syncPromoEngagementView.render();this.syncPromoRendered=true}else{this.syncPromoEngagementView.show()}},renderEngagementMobilePromo:function(f){if(!this.mobilePromoRendered){this.mobilePromoEngagementView=new Contacts.Views.EngagementMobilePromoView(f);this.mobilePromoEngagementView.render();this.mobilePromoRendered=true}},loadItems:function(o){var r=this,i=false;var l=function(s,t){r._remainingItems=r._remainingItems.concat(s);r.renderDfd.done(function(){if(s.length){r.$el.show();r._insertIfThereAreAvailableSlots()}else{if(!r.hasStaticItems&&r.staticItemsChecked&&!r.hasDynamicItems&&r.dynamicItemsChecked&&!r.hasMeetingItem&&r.meetingItemChecked){r.trigger("no-engagements");if(this.syncPromoEngagementView){this.syncPromoEngagementView.hide()}}}});if(s.length&&!i){i=true;Contacts.MetricsTracker.add(Contacts.Constants.PageKey.DAILY_PROMO,{pageType:MetricsTracker.PageType.AJAX})}};var g=new Contacts.Adapters.StaticEngagementsAdapter();var h=new Contacts.Adapters.MeetingsAdapter();this.cymkEngagementsAdapter=new Contacts.Adapters.ContactYouMayKnowEngagementsAdapter();this.pymkEngagementsAdapter=new Contacts.Adapters.PeopleYouMayKnowEngagementsAdapter();var f=function(t){var s;return{get:function(u){if(s){return s.promise()}s=d.Deferred();t.get(u).done(function(v){s.resolve(v)});return s.promise()}}};var m=f(g);var k=f(h);var j=f(this.cymkEngagementsAdapter);var q=f(this.pymkEngagementsAdapter);var p=d.Deferred();var n;m.get().done(function(s){r.staticItemsChecked=true;if(s.length){l(s);r.hasStaticItems=true}p.resolve();if(r._getSlotsToInsert()>0||this._remainingItems<r.numRemainingItemsBeforeLoadingMore){j.get({additional_size:r._getSlotsToInsert()+r.numRemainingItemsBeforeLoadingMore}).done(function(t){r.dynamicItemsChecked=true;l(t);if(t.length){r.hasDynamicItems=true}if(r._getSlotsToInsert()>0||this._remainingItems<r.numRemainingItemsBeforeLoadingMore){q.get({additional_size:r._getSlotsToInsert()+r.numRemainingItemsBeforeLoadingMore}).done(function(u){l(u);if(u.length){r.hasDynamicItems=true}setTimeout(function(){r._updateScroller()},100)}).fail(function(){r.dynamicItemsChecked=true;r.hasDynamicItems=false;l([]);setTimeout(function(){r._updateScroller()},100)})}else{setTimeout(function(){r._updateScroller()},100)}}).fail(function(){r.dynamicItemsChecked=true;r.hasDynamicItems=false;l([])})}else{setTimeout(function(){r._updateScroller()},100)}});k.get().done(function(s){p.done(function(){r.meetingItemChecked=true;l(s);if(s.length){r.hasMeetingItem=true}})})},addMoreBarView:function(){this.moreBarView=new Contacts.Views.EngagementMoreBarView();this.addSubView(this.moreBarView);this.listenTo(this.moreBarView,"click",this.onMoreBarViewClicked)},viewForItem:function(h,g){var f=h.toView(g);this.engagementListItemViews.push(f);this.listenTo(f,"closed",this.onItemClosed);return f},next:function(){var f=0;this.currentPage++;this._insertIfThereAreAvailableSlots();this._sendImpressionTrackingEvent();this._updateScroller()},_loadDynamicEngageEvents:function(){var f={additional_size:this._getSlotsToInsert()+this.numRemainingItemsBeforeLoadingMore,dismissed:this.cymk_dismissed};if(this.call_cymk){this.cymkEngagementsAdapter.get(f).done(a.bind(function(g){if(g.length){this._remainingItems=this._remainingItems.concat(g);this._insertIfThereAreAvailableSlots();this._updateScroller()}if(this._getSlotsToInsert()>0||this._remainingItems<this.numRemainingItemsBeforeLoadingMore){this.call_cymk=false;f={additional_size:this._getSlotsToInsert()+this.numRemainingItemsBeforeLoadingMore,dismissed:this.pymk_dismissed};this.pymkEngagementsAdapter.get(f).done(a.bind(function(h){if(h.length){this._remainingItems=this._remainingItems.concat(h);this._insertIfThereAreAvailableSlots();this._updateScroller()}},this))}},this))}else{f={additional_size:this._getSlotsToInsert()+this.numRemainingItemsBeforeLoadingMore,dismissed:this.pymk_dismissed};this.pymkEngagementsAdapter.get(f).done(a.bind(function(g){if(g.length){this._remainingItems=this._remainingItems.concat(g);this._insertIfThereAreAvailableSlots();this._updateScroller()}},this))}},render:function(){Contacts.Views.ListView.prototype.render.call(this);this.$engagementsContainer=d("#engagements-container");this.$engagementsContainer.replaceWith(this.$el);this.$moreBarContainer=d(".more-bar-container");this.$moreBarWrapper=d(".more-bar-wrapper");this.$moreBarContainer.hide();this.renderDfd.resolve();this.$el.hide();return this},onItemClosed:function(q,j){var l=q.$el.index();if(q.model.type==="contact_you_may_know"){this.cymk_dismissed=this.cymk_dismissed+1}else{if(q.model.type==="people_you_may_know"){this.pymk_dismissed=this.pymk_dismissed+1}}if(this._remainingItems.length<this.numRemainingItemsBeforeLoadingMore){this._loadDynamicEngageEvents()}this._insertedItems.splice(l,1);if(this._remainingItems.length){q.$el.addClass("dismissed");var s=this._insertNextItem();var w=this.inserItemAt(s,{render:false},l);w.$el.css({position:"absolute",top:j.top,left:j.left});this.renderItemView(w);var t=this;t.$itemList.css({overflow:"visible"});var r=d('<div class="card-loading-overlay"></div>');w.$el.prepend(r);setTimeout(function(){r.addClass("card-loading")},200);this._generateScoredEntity(l+1,w);this._sendImpressionTrackingEvent();setTimeout(a.bind(function(){q.dispose();w.$el.css({position:"",top:"",left:""});t.$itemList.css({overflow:"hidden"});r.remove()},this),500)}else{if(this.options.rearrangeWithAnimation){var m=this.$itemList.children(),l=q.$el.index(),k=m.length,n=[];for(var h=k-1;h>=l;h--){var v=d(m[h]);var p=v.position();v.css({position:"absolute",top:p.top+"px",left:p.left+"px"});n.unshift({$el:v,pos:p})}for(var h=1;h<n.length;h++){var g=n[h-1];var u=n[h];var o=g.pos.top,f=g.pos.left;u.$el.animate({top:o+"px",left:f+"px"},400)}q.$el.addClass("closed");setTimeout(function(){q.dispose();for(var x=1;x<n.length;x++){n[x].$el.css({position:"",top:"",left:""})}},400)}else{q.dispose()}}this._updateScroller()},onMoreBarViewClicked:function(){this.next();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.ENGAGE_EVENTS_SEE_MORE,{pageType:MetricsTracker.PageType.AJAX})}});Contacts.Views.EngagementListView=c})(window,Backbone,jQuery,_);(function(c,e,d,b){var a=Contacts.Views.BaseView.extend({className:"sync-promo",events:{"click button.close":"onCloseButtonClicked","click button.continue":"onContinueButtonClicked","click a.learn-more":"onLearnMoreClicked"},template:Contacts.Templates["sync-promo"],$emailText:null,$continueButton:null,redirectUrl:"/contacts/manage_sources/",format:function(){return Contacts.DataStore.user.fetch().then(function(){return{name:Contacts.DataStore.user.get("first_name"),email:Contacts.DataStore.user.get("primary_email_address")}})},render:function(){Contacts.Views.BaseView.prototype.render.call(this);this.format().done(b.bind(function(f){this.$el.append(this.template(f));d("#sync-promo").replaceWith(this.$el);this.$emailText=this.$el.find(".sync-promo-email");this.$continueButton=this.$el.find(".continue");this.$emailText.on("keyup",b.debounce(b.bind(this.validateEmail,this),200));this.trigger("rendered")},this));return this},validateEmail:function(){var f=this.$emailText.val();if(this.prevEmail===f){return}this.prevEmail=f;this.enableContinueButton(false);this.emailZeppelinData=null;var g=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;var h=g.test(f);if(h){this.updateZeppelinData()}},updateZeppelinData:function(){var g=this.$emailText.val();var f=this;Connected.API.Integrations.emailResolve(g).done(function(h){f.emailZeppelinData=h}).always(function(){f.enableContinueButton(true)})},enableContinueButton:function(f){if(f){this.$continueButton.removeAttr("disabled")}else{this.$continueButton.attr("disabled","disabled")}},redirectToIntegrationsPage:function(g,i){var f=this.redirectUrl;if(g){var h=d.param({action:g,param:i});f=String.format("{0}?{1}",this.redirectUrl,h)}c.location.href=f},integrate:function(f){var f=f?f:{};var l=b.bind(this.redirectToIntegrationsPage,this);var j=f.onSyncFailed?f.onSyncFailed:function(o){l()};var n=f.onUnknownDomain?f.onUnknownDomain:function(o){var p=k.substring(k.lastIndexOf("@")+1);l("promo_integration_unknown_domain",p)};var g=f.onSyncComplete?f.onSyncComplete:function(o){if(o==="denied"){j(o);return}l("promo_integration_success","")};var i=b.bind(g,this),h=b.bind(j,this),m=b.bind(n,this),k=this.$emailText.val();if(!this.emailZeppelinData){m()}else{if(this.emailZeppelinData.status_details.provider==="exchange"){Connected.UI.IntegrationWindows.open("outlook_ews").done(i).fail(h)}else{if(this.emailZeppelinData.status_details.provider==="google"){Connected.UI.IntegrationWindows.openGoogleConnect().done(i).fail(h)}else{if(this.emailZeppelinData.status_details.provider==="yahoo"&&this.emailZeppelinData.status_details.supported_importer){Connected.UI.IntegrationWindows.openYahooContactsConnect().done(i).fail(h)}else{m()}}}}},onCloseButtonClicked:function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_CLOSE,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{size:"large"}});this.hide()},onContinueButtonClicked:function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_SYNC,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{size:"large"}});this.integrate()},onLearnMoreClicked:function(){Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_LEARN_PROMO,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{size:"large"}})},show:function(){this.$el.addClass("open");this.validateEmail();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_IMPRESSION,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{size:"large"}})},hide:function(){this.$el.removeClass("open")}});Contacts.Views.SyncPromoView=a})(window,Backbone,jQuery,_);(function(d,c,b){var a=Contacts.Views.SyncPromoView.extend({className:"engagement-card engagement-sync-promo",tagName:"li",events:{"click button.close":"onCloseButtonClicked","click button.continue":"onSyncClick","click a.learn-more":"onLearnMoreClick"},template:Contacts.Templates["engagement/sync-promo-a"],types:{A:"a",B:"b"},initialize:function(){this.type=this.options.type?this.options.type:this.types.A;if(this.type===this.types.A){this.template=Contacts.Templates["engagement/sync-promo-a"]}else{if(this.type===this.types.B){this.template=Contacts.Templates["engagement/sync-promo-b"]}}},render:function(){if(c(".engagement-sync-promo").length){return}Contacts.Views.BaseView.prototype.render.call(this);this.format().done(b.bind(function(e){this.$el.append(this.template(e));c(".engagement-list .items").prepend(this.$el);this.$emailText=this.$el.find(".sync-promo-email");this.$continueButton=this.$el.find("button.continue");this.$emailText.on("keyup",b.debounce(b.bind(this.validateEmail,this),200));this.validateEmail();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_IMPRESSION,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{type:this.type,size:"small"}})},this));return this},onSyncClick:function(){this.onContinueButtonClicked();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_SYNC,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{type:this.type,size:"small"}})},onLearnMoreClick:function(){this.onLearnMoreClicked();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_LEARN_PROMO,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{type:this.type,size:"small"}})},onCloseButtonClicked:function(){this.hide();this._setClosedState();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SYNC_PROMO_CLOSE,{pageType:MetricsTracker.PageType.AJAX,trackingInfo:{type:this.type,size:"small"}})},_setClosedState:function(){var f=c.Deferred(),g="/services/close_promo/",e="promo_impression_count_v2",j,h="closed_promo_box_v2";j={promo_close_key:h,promo_count_key:e};g=(window.url_path||"")+(window.CONNECTED_SERVICE_PREFIX||"")+g;function i(k){if(k.status==="success"){f.resolve(k)}else{f.reject(k.status_details||"An unspecified error occured")}}c.ajax({url:g,type:"GET",data:j,cache:false,success:i,error:i});f.promise()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}});Contacts.Views.EngagementSyncPromoView=a})(Backbone,jQuery,_);(function(d,c,b){var a=Contacts.Views.BaseView.extend({className:"engagement-card engagement-mobile-promo",tagName:"li",events:{"click button.close":"onCloseButtonClicked","click button.continue":"onSendClick"},template:Contacts.Templates["engagement/mobile-promo"],render:function(){if(c(".engagement-mobile-promo").length){return}Contacts.Views.BaseView.prototype.render.call(this);this.$el.append(this.template({}));c(".engagement-list .items").prepend(this.$el);this.$phoneText=this.$el.find(".mobile-promo-phone");this.$continueButton=this.$el.find("button.continue");this.$phoneText.on("keyup",b.debounce(b.bind(this.validatePhone,this),200));this.validatePhone();if(this.$el.find(".mobile-promo-phone-label").length){LI.GhostLabel(this.$el.find(".mobile-promo-phone-label")[0])}Contacts.MetricsTracker.add(Contacts.Constants.PageKey.MOBILE_PROMO_IMPRESSION,{pageType:MetricsTracker.PageType.AJAX});return this},validatePhone:function(){this.$el.removeClass("error");var e=this.$phoneText.val(),f=false;if(this.prevPhone===e){return}this.prevPhone=e;this.enableContinueButton(false);if((/[a-zA-Z]/g).test(e)){return}e=e.replace(/\D+/g,"");var f=(e.length===10&&parseInt(e[0])!==1)||(e.length===11&&parseInt(e[0])===1);if(f){this.enableContinueButton(true)}},enableContinueButton:function(e){if(e){this.$continueButton.removeAttr("disabled")}else{this.$continueButton.attr("disabled","disabled")}},onSendClick:function(){var e=c.Deferred(),g="/api/sms/",f=this;params={to:this.$phoneText.val()};g=(window.url_path||"")+(window.CONNECTED_SERVICE_PREFIX||"")+g;function h(i){if(i.status==="success"){e.resolve(i);f.$phoneText.hide();f.$continueButton.hide();f.$el.find(".success-promo-text").show();setTimeout(function(){f.hide()},1000)}else{e.reject(i.status_details||"An unspecified error occured");f.$el.addClass("error")}}c.ajax({url:g,type:"POST",data:JSON.stringify(params),cache:false,success:h,error:h});e.promise();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.MOBILE_PROMO_SEND,{pageType:MetricsTracker.PageType.AJAX})},onCloseButtonClicked:function(){this.hide();this._setClosedState();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.MOBILE_PROMO_CLOSE,{pageType:MetricsTracker.PageType.AJAX})},_setClosedState:function(){var f=c.Deferred(),g="/services/close_promo/",e="mobile_promo_impression_count",j,h="closed_mobile_promo";j={promo_close_key:h,promo_count_key:e};g=(window.url_path||"")+(window.CONNECTED_SERVICE_PREFIX||"")+g;function i(k){if(k.status==="success"){f.resolve(k)}else{f.reject(k.status_details||"An unspecified error occured")}}c.ajax({url:g,type:"GET",data:j,cache:false,success:i,error:i});f.promise()},hide:function(){this.$el.fadeOut(1000)},show:function(){this.$el.show()}});Contacts.Views.EngagementMobilePromoView=a})(Backbone,jQuery,_);(function(d,c,b){var a=Contacts.Views.SyncPromoView.extend({className:"hopscotch-sync-promo",events:{"click button.sync-button":"onSyncButtonClicked","click button.cancel-button":"onCancelButtonClicked"},template:Contacts.Templates["hopscotch-sync-promo"],render:function(){if(c(".hopscotch-sync-promo").length){return}Contacts.Views.BaseView.prototype.render.call(this);this.format().done(b.bind(function(e){e=b.extend(e,{showCancel:this.options.cancelButton==="enabled"});this.$el.append(this.template(e));this.$el.hide().fadeIn(500).appendTo(c(".hopscotch-content"));this.$emailText=this.$el.find(".sync-promo-email");this.$continueButton=this.$el.find("button.next");this.$emailText.on("keyup",b.debounce(b.bind(this.validateEmail,this),200));this.$emailText.on("keyup",b.debounce(b.bind(this.hideError,this),200));this.validateEmail()},this));return this},hideError:function(){var e=this.$el.find("strong.error");this.$emailText.removeClass("error");e.html("");e.hide()},onSyncButtonClicked:function(){var f=this;this.hideError();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_SYNC,{pageType:MetricsTracker.PageType.AJAX});var e=function(i){var j=this.$emailText;j.addClass("error");this.$el.find("strong.error").html("Sorry, there was a problem with the sync.")};var h=function(j){var k=this.$emailText,i=this.$el.find("strong.error"),l=k.val().substring(k.val().lastIndexOf("@")+1);k.addClass("error");i.html("Sorry, we can't sync from "+l+" yet.");i.show()};var g=function(i){if(i==="denied"){e(i);return}if(f.options.redirectOnSuccess==="enabled"){if(Contacts.Apps.MergedContactsPageApp.tourView){Contacts.Apps.MergedContactsPageApp.tourView.closeTour()}setTimeout(function(){b.bind(f.redirectToIntegrationsPage("promo_integration_success",""),f)},1)}else{this.trigger("success");c(".hopscotch-sync-promo").remove()}};this.integrate({onSyncFailed:e,onSyncComplete:g,onUnknownDomain:h})},onCancelButtonClicked:function(){this.trigger("canceled");c(".hopscotch-sync-promo").fadeOut(500,function(){c(".hopscotch-sync-promo").remove()});Contacts.MetricsTracker.add(Contacts.Constants.PageKey.TOUR_PROMO_CANCEL,{pageType:MetricsTracker.PageType.AJAX})}});Contacts.Views.HopscotchSyncPromoView=a})(Backbone,jQuery,_);(function(d,c,a){var b=Contacts.Views.BaseView.extend({tagName:"div",events:{"click .contact-item-view .company":"onCompanyClicked","click .contact-item-view .title":"onTitleClicked","click .contact-item-view .location":"onLocationClicked","click .contact-item-view .source-container a":"onSourceClicked"},template:Contacts.Templates["agenda/dialog"],meetingTemplate:Contacts.Templates["agenda/dialog/meeting"],headerTemplate:Contacts.Templates["agenda/dialog/header"],contactTemplate:Contacts.Templates["contacts/contact"],initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);this.meetings=this.options.collection;this.meetingsListView=new Contacts.Views.ListView({template:Contacts.Templates.list});this.meetingsListView.setData({items:a.map(this.meetings.toJSON(),function(f,e){f.index=e;return{meeting:f}}),itemTemplate:this.meetingTemplate});this.listenTo(this.meetingsListView,"click",this.onMeetingItemClicked);this.contactsListView=new Contacts.Views.ListView({className:[Contacts.Views.ListView.prototype.className,"contacts-list-view"].join(" "),template:Contacts.Templates.list});this.listenTo(this.contactsListView,"click",this.onContactClicked)},render:function(){Contacts.Views.BaseView.prototype.render.call(this);this.$el.attr("id","agenda-content");this.$el.append(this.template());this.dialog=new UIControls.Dialog(this.$el,{title:this.options.title});this.$meetingPanel=this.$el.find(".meetings-panel");this.$detailsPanel=this.$el.find(".details-panel");this.meetingsListView.render().$el.appendTo(this.$meetingPanel);return this},clear:function(){this._$selectedNode=null},_getContactFromEvent:function(f){var e=c(f.target);var g=e.closest(".contact-item-view").data("li-item-id");return Contacts.DataStore.contacts.get(g)},onMeetingItemClicked:function(e){this.setSelectedIndex(e.id)},onTitleClicked:function(f){f.preventDefault();this.close();var e=this._getContactFromEvent(f),g=e.get("title");Contacts.Apps.MergedContactsPageApp.contactsView.onTitleChanged(g)},onCompanyClicked:function(g){g.preventDefault();this.close();var e=this._getContactFromEvent(g),f=e.get("company");Contacts.Apps.MergedContactsPageApp.contactsView.onCompanyChanged(f)},onLocationClicked:function(g){g.preventDefault();this.close();var e=this._getContactFromEvent(g),f=e.get("location");Contacts.Apps.MergedContactsPageApp.contactsView.onLocationChanged(f)},onSourceClicked:function(g){g.preventDefault();this.close();var f=c(g.target),e=this._getContactFromEvent(g),h=f.closest("a").data("li-item-id");Contacts.Apps.MergedContactsPageApp.contactsView.onSourceChanged(e.get("sources").findWhere({name:h}))},setSelectedIndex:function(f){if(this._$selectedMeeting){this._$selectedMeeting.removeClass("selected")}this._$selectedMeeting=this.meetingsListView.itemMap[f].$el;this._$selectedMeeting.addClass("selected");var i=this.meetings.at(f);this.$detailsPanel.empty();var e=c(this.headerTemplate({meeting:i.toJSON()}));e.appendTo(this.$detailsPanel);var h=i.get("contacts").map(function(j){var k=j.get("last_interaction");return a.extend(j.toJSON(),{isConnection:j.isConnection(),displayName:j.displayName(),defaultImageUrl:Contacts.Constants.GHOST_PROFILE_IMAGE_SMALL,last_interaction:k?moment(new Date(k)).fromNow():null,tagTemplate:null,showCheckbox:false})});var g=this.contactTemplate;this.contactsListView.setData({items:h,itemTemplate:function(j){return String.format('<li data-li-item-id="{0}" class="contact-item-view">{1}</li>',j.id,g.call(this,j))}});this.$detailsPanel.empty();e.appendTo(this.$detailsPanel);this.contactsListView.render().$el.appendTo(this.$detailsPanel);this.contactsListView.$el.find(".contact-source").tooltip()},open:function(){this.dialog.open()},close:function(){this.dialog.close()}});Contacts.Views.AgendaDialogView=b})(Backbone,jQuery,_);(function(c,e,d,a){var b=Contacts.Views.BaseView.extend({tagName:"ul",template:Contacts.Templates["page/header/menu"],className:"page-header-menu",events:{'click li[data-li-item-id="sync"]':"onSyncClick",'click li[data-li-item-id="add"]':"onAddClick"},initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments)},render:function(){Contacts.Views.BaseView.prototype.render.call(this);this.$el.append(this.template(this.format()));if(d(".page-header").length>0){this.$el.appendTo(d(".page-header"))}else{this.$el.appendTo(d(".header-dropdown"))}this._createAddDropdown();return this},format:function(){return{secureBaseUrl:Contacts.Constants.SECURE_URL_PATH}},_createAddDropdown:function(){this._addDropdown=new Contacts.Views.DropdownView();this._addDropdown.setElement(this.$el.find(".dropdown"));this._addDropdown.render()},onSyncClick:function(f){this.trigger("click:sync");this._addDropdown.hide()},onAddClick:function(f){this._addDropdown.hide();f.preventDefault();Connected.UI.Dialogs.openAddContact();Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SERVICES_ADD_CONTACT,{pageType:MetricsTracker.PageType.AJAX})}});Contacts.Views.PageHeaderMenuView=b})(window,Backbone,jQuery,_);(function(c,e,d,a){var b=Contacts.Views.BaseView.extend({events:{"click .dismiss":"onCloseButtonClicked","click .more":"onMoreClicked"},dialogTemplate:Contacts.Templates["page/dialogs/profile-organizer"],initialize:function(){Contacts.Views.BaseView.prototype.initialize.apply(this,arguments);this.$el=d("#profile-organizer")},onMoreClicked:function(g){g.preventDefault();var h=d(this.dialogTemplate());var i="Profile Organizer is now part of LinkedIn Contacts!";var f=new UIControls.Dialog(h,{title:i});f.open()},onCloseButtonClicked:function(){d.ajax({url:"/contacts/services/close_promo/",type:"GET",cache:false,data:{promo_close_key:"profile_organizer_promo_closed"}});this.dispose()},show:function(){this.$el.show()},hide:function(){this.$el.hide()}});Contacts.Views.ProfileOrganizerAlertView=b})(window,Backbone,jQuery,_);(function(b,g,c,a){var e={DEFAULT:0,DUPLICATES:1},d;var f=Contacts.Views.BaseView.extend({removeDialogTemplate:Contacts.Templates["contacts/dialogs/remove"],mergeDialogTemplate:Contacts.Templates["contacts/dialogs/merge-confirmation"],groupMessageDialogTemplate:Contacts.Templates["contacts/dialogs/message-confirmation"],groupMessageYieldDialogTemplate:Contacts.Templates["contacts/dialogs/message-yield"],collection:null,contactsListView:null,$footer:null,$loader:null,$ad:null,$contactListActionSection:null,$selectAllCheckbox:null,initialize:function(){Contacts.Views.BaseView.prototype.initialize.call(this);this.setupViews();this.mode=e.DEFAULT;this._page=1},setupViews:function(){this._addHeaderView();this._addContactList()},_addHeaderView:function(){this.headerView=new Contacts.Views.ContactListHeaderView({collection:Contacts.DataStore.contacts});this.addSubView(this.headerView);this.listenTo(this.headerView,"select-all",this.onHeaderSelectAll);this.listenTo(this.headerView,"unselect-all",this.onHeaderUnselectAll);this.listenTo(this.headerView,"action:tags:add",this.onHeaderActionTag);this.listenTo(this.headerView,"action:tags:remove",this.onHeaderActionUntag);this.listenTo(this.headerView,"action:tags:manage",this.onHeaderActionManageTags);this.listenTo(this.headerView,"action:merge",this.onHeaderActionMerge);this.listenTo(this.headerView,"action:message",this.onHeaderActionMessage);this.listenTo(this.headerView,"action:more:hide",this.onHeaderActionHide);this.listenTo(this.headerView,"action:more:unhide",this.onHeaderActionUnhide);this.listenTo(this.headerView,"action:more:remove",this.onHeaderActionRemove);this.listenTo(this.headerView,"sort:change",this.onHeaderSortDropdownChange);if(Contacts.Lix.get("filter-by-letter-enabled")){this.listenTo(this.headerView,"alphabet:change",this.onHeaderAlphabetIndexChange);this.listenTo(this.headerView,"alphabet:clear",this.onHeaderAlphabetIndexClear)}this.listenTo(this.headerView,"filter:change",this.onHeaderFilterNavigationViewChange);this.listenTo(this.headerView,"filter:search",this.onHeaderFilterNavigationViewSearch);this.listenTo(this.headerView,"search:change",this.onHeaderSearchChange);this.listenTo(this.headerView,"click:scroll-top",this.onHeaderScrollToTopClicked)},_addContactList:function(){this.contactsListView=new Contacts.Views.ContactListView({collection:Contacts.DataStore.contacts});this.addSubView(this.contactsListView);this.listenTo(this.contactsListView,"change:select",this.onContactListItemChangeSelect);this.listenTo(this.contactsListView,"source:click",this.onSourceChanged);this.listenTo(this.contactsListView,"company:click",this.onCompanyChanged);this.listenTo(this.contactsListView,"title:click",this.onTitleChanged);this.listenTo(this.contactsListView,"location:click",this.onLocationChanged);this.listenTo(this.contactsListView,"tag:click",this.onContactListItemTagClick);this.listenTo(Contacts.Notification,"change:location",this.onLocationChanged);this.listenTo(Contacts.Notification,"change:company",this.onCompanyChanged);this.listenTo(Contacts.Notification,"change:title",this.onTitleChanged)},render:function(){this.$el=c("#contact-list-container");this.$footer=this.$el.find("footer");this.$loader=this.$footer.find(".loader-container");this.$ad=c("#right-ad-container");this.contactsListView.render().$el.prependTo(this.$el);this.headerView.render().$el.prependTo(this.$el);this.headerTop=this.headerView.$el.position().top;this.headerActionSectionTop=this.headerView.$contactListActionSection.position().top;this._setupScrolling()},onHeaderActionTag:function(h){var i=this.contactsListView.selectedViews();Contacts.DataStore.contacts.bulkTag(a.pluck(i,"model"),{added:h});Contacts.MetricsTracker.add(Contacts.Constants.PageKey.APPS_TAG_CONTACTS,{pageType:MetricsTracker.PageType.AJAX})},onHeaderActionUntag:function(h){var i=this.contactsListView.selectedViews();Contacts.DataStore.contacts.bulkTag(a.pluck(i,"model"),{removed:h});Contacts.MetricsTracker.add(Contacts.Constants.PageKey.APPS_UNTAG_CONTACTS,{pageType:MetricsTracker.PageType.AJAX})},onHeaderActionManageTags:function(){var h=new Contacts.Views.ManageTagsDialogView();h.render().open()},onHeaderActionMessage:function(){var l=this.contactsListView.selectedViews();var j=[];var h=[];if(l.length===1){Connected.UI.Dialogs.openMessage(l[0].model.id);return false}a.each(l,function(m){if(m.model.isConnection()){j.push(m.model.id)}else{h.push(a.extend(m.model.toJSON(),{displayName:m.model.displayName()}))}});var k=function(){b.location.href="/contacts/group_message/?merged_ids="+j.join(",")};if(!j.length){var i=this.showMessageYieldDialog(h);i.on("ok",function(){i.close()})}else{if(h.length){var i=this.showMessageDialog(h);i.on("ok",function(){k()})}else{k()}}},onHeaderActionMerge:function(){var j=this.contactsListView.selectedViews();switch(this.mode){case e.DUPLICATES:if(!j.length){return}Contacts.UI.Loader.show();var i=a.map(j,function(l){return this._viewIdToMergeSetMap[l.cid]},this);Contacts.DataStore.contacts.mergeSets(i).done(a.bind(function(){a.each(j,function(m){delete this._viewIdToMergeSetMap[m.cid]},this);var l=a.keys(this._viewIdToMergeSetMap);if(l.length===0){}},this)).always(function(){Contacts.UI.Loader.hide()});Contacts.MetricsTracker.add(Contacts.Constants.PageKey.SERVICES_MERGED_CONTACTS,{pageType:MetricsTracker.PageType.AJAX});break;case e.DEFAULT:if(j.length<2){return}var k=function(){Contacts.UI.Loader.show();Contacts.DataStore.contacts.merge(a.map(j,function(l){return l.model})).always(function(){Contacts.UI.Loader.hide()})};if(j.length>=5){var h=this.showMergeDialog();h.on("ok",function(){k()})}else{k()}break}this.headerView.actionMenuView.hide()},onHeaderActionHide:function(){var h=this.contactsListView.selectedViews();Contacts.DataStore.contacts.bulkHide(a.pluck(h,"model"));a.each(h,function(i){i.hide()});this.headerView.actionMenuView.hide()},onHeaderActionUnhide:function(){var h=this.contactsListView.selectedViews();Contacts.DataStore.contacts.bulkUnhide(a.pluck(h,"model"));a.each(h,function(i){i.model.unhide();i.hide()});this.headerView.actionMenuView.hide()},onHeaderActionRemove:function(){var i=this.contactsListView.selectedViews();var h=this.showRemoveAllDialog(i);h.on("ok",function(){Contacts.DataStore.contacts.bulkRemove(a.pluck(i,"model"));a.each(i,function(j){j.hide()})});this.headerView.actionMenuView.hide()},onHeaderSelectAll:function(){this.contactsListView.selectAll()},onHeaderUnselectAll:function(){this.contactsListView.unselectAll()},onHeaderSearchChange:function(j){var k={searchQuery:j.name},h=Contacts.DataStore.contacts.getSortOrderKey(),i="";if(h){k.sortOrder=h}this.headerView.resetFilter();i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onHeaderScrollToTopClicked:function(){c("body,html").animate({scrollTop:0},1000)},setPath:function(i,h){this.headerView.filterDropdownView.navigationView.setPath(i,{silent:h})},resetScrubberLetter:function(){this.headerView.alphabetIndexDropdownView.resetAlphabetIndexDisplay()},setScrubberLetter:function(h){Contacts.DataStore.contacts.setSearchQuery({name:h,starts_with:true});this.headerView.alphabetIndexDropdownView.updateAlphabetIndexDisplay(h)},setSortOrder:function(i){this._sortOrder=i;var h=(this._orderMap||(this._orderMap={recent:Contacts.Collections.Contacts.SortOrder.RECENT,alphabetical:Contacts.Collections.Contacts.SortOrder.ALPHABETICAL,"new":Contacts.Collections.Contacts.SortOrder.CREATED,last_name:Contacts.Collections.Contacts.SortOrder.LAST_NAME,first_name:Contacts.Collections.Contacts.SortOrder.FIRST_NAME}))[this._sortOrder];if(Contacts.DataStore.contacts.getSortOrder()===h){return}Contacts.DataStore.contacts.setSortOrder(h);this.headerView.sortDropdownView.updateSortDisplay(this._sortOrder)},buildCurrentParams:function(){var k={},j=Contacts.DataStore.contacts.getFilter(),h=Contacts.DataStore.contacts.getSearchQuery(),i=Contacts.DataStore.contacts.getSortOrderKey();if(j){if(j.source||j.location||j.title){k=c.extend(k,j)}else{if(j.company_id){k.company=j.company_id}else{if(j.tag_id){k.tag=j.tag_id}else{if(j.pathId){k.pathId=j.pathId;k.query=j}}}}}else{if(h){k=this.processSearchQuery(h,k)}}if(i){k.sortOrder=i}return k},onHeaderSortDropdownChange:function(i){var k=this.buildCurrentParams(),j="";this._sortOrder=i.id;var h=(this._orderMap||(this._orderMap={recent:Contacts.Collections.Contacts.SortOrder.RECENT,alphabetical:Contacts.Collections.Contacts.SortOrder.ALPHABETICAL,"new":Contacts.Collections.Contacts.SortOrder.CREATED,last_name:Contacts.Collections.Contacts.SortOrder.LAST_NAME,first_name:Contacts.Collections.Contacts.SortOrder.FIRST_NAME}))[this._sortOrder];if(Contacts.DataStore.contacts.getSortOrder()===h){return}if(i.id){if(k.letter&&Contacts.Lix.get("filter-by-letter-enabled")){if(i.id!==Contacts.Collections.Contacts.SortOrderKey.FIRST_NAME&&i.id!==Contacts.Collections.Contacts.SortOrderKey.LAST_NAME){delete k.letter}}k.sortOrder=i.id}j=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(j)},resetFilters:function(){this.setPath([{type:"filter",id:"all"}])},onHeaderAlphabetIndexChange:function(h){var j=this.buildCurrentParams();this.resetFilters();j.letter=h.id;var i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(j);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onHeaderAlphabetIndexClear:function(h){Contacts.DataStore.contacts.setSearchQuery({});var j=this.buildCurrentParams();j.letter=h.id;var i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(j);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onHeaderFilterNavigationViewChange:function(i){if(Contacts.Lix.get("filter-by-letter-enabled")){this.resetScrubberLetter()}switch(i.data.id){case"duplicates":var l={},h=Contacts.DataStore.contacts.getSortOrderKey(),k="";if(h){l.sortOrder=h}l.merge="true";k=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(l);Contacts.Apps.MergedContactsPageApp.router.goHash(k);break;default:var l={},j=i.data.query,h=Contacts.DataStore.contacts.getSortOrderKey(),k="";this.mode=e.DEFAULT;a.each(["tag","message","more"],function(m){this.headerView.actionMenuView.itemMap[m].$el.show()},this);if(j){l=this.processFilters(j,i.data.query,l)}if(h){l.sortOrder=h}l.fromFilter="true";k=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(l);Contacts.Apps.MergedContactsPageApp.router.goHash(k)}},processFilters:function(h,i,k){if(h.source||h.location||h.title){k=h;if(this.headerView.filterDropdownView.navigationView.getPath()){var j=this.headerView.filterDropdownView.navigationView.getPath();if(j.length&&j[0].id&&j[0].id==="connections"){k.connections="enabled"}else{k.connections="disabled"}}}else{if(h.company_id){k.company=h.company_id}else{if(h.tag_id){k.tag=h.tag_id}else{if(i){k.query=i}}}}return k},processSearchQuery:function(h,i){if(h.starts_with&&Contacts.Lix.get("filter-by-letter-enabled")){i.letter=h.name}else{if(h.name){i.searchQueryType="name";i.searchQuery=h.name}else{if(h.company){i.searchQueryType="company";i.searchQuery=h.company}else{if(h.location){i.searchQueryType="location";i.searchQuery=h.location}else{if(h.title){i.searchQueryType="title";i.searchQuery=h.title}}}}}return i},onHeaderFilterNavigationViewSearch:function(j){var k={},h=Contacts.DataStore.contacts.getSortOrderKey(),i="";if(h){k.sortOrder=h}k=this.processSearchQuery(j,k);k.fromFilter="true";k.connections="disabled";i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onContactListItemChangeSelect:function(){if(this.contactsListView.selectedViews().length>0){this.headerView.actionMenuView.show();if(this.contactsListView.selectedViews().length===1&&this.mode!==e.DUPLICATES){this.headerView.actionMenuView.hideMerge()}else{this.headerView.actionMenuView.showMerge()}}else{this.headerView.actionMenuView.hide()}},onSourceChanged:function(j){var h=Contacts.DataStore.contacts.getSortOrderKey(),k={source:j.get("name")},i="";if(h){k.sortOrder=h}k.fromFilter="false";k.connections="disabled";i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onCompanyChanged:function(h){var i=Contacts.DataStore.contacts.getSortOrderKey(),k={company:h.get("id")},j="";if(i){k.sortOrder=i}j=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(j)},onTitleChanged:function(j){var h=Contacts.DataStore.contacts.getSortOrderKey(),k={title:j},i="";if(h){k.sortOrder=h}i=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(i)},onLocationChanged:function(h){var i=Contacts.DataStore.contacts.getSortOrderKey(),k={location:h.get("region_code")},j="";if(i){k.sortOrder=i}j=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(j)},onContactListItemTagClick:function(h){var i=Contacts.DataStore.contacts.getSortOrderKey(),k={tag:h.get("id")},j="";if(i){k.sortOrder=i}j=Contacts.Apps.MergedContactsPageApp.router.buildNewHash(k);Contacts.Apps.MergedContactsPageApp.router.goHash(j)},_resetHeaderAndLoadNext:function(h){this.headerView.actionMenuView.hide();this.headerView.clearSelection();this._updateAd();this._page=1;return this.loadNext({fireComscore:false,trackTarget:h})},_updateAd:function(){var i=c("#right-ad-container .stickyRightAd").attr("src"),h=c("#right-ad-container");h.html("");var j=document.createElement("IFRAME");j.id="ad-contacts-pymk-fs-2";j.src=i;j.width=160;j.height=600;j.scrolling="no";j.frameborder=0;j.className="stickyRightAd";h.append(c(j))},afterCloseDialog:function(){var h=this.$selectAllCheckbox||(this.$selectAllCheckbox=c("#select-checkbox"));h.prop("checked",false);this.contactsListView.unselectAll()},showRemoveAllDialog:function(h){var k=c(this.removeDialogTemplate({contact:{displayName:h[0].model.displayName(),isConnection:h[0].model.isConnection()},isBulk:h.length>1,removeContacts:a.map(h,function(m){return a.extend(m.model.toJSON(),{displayName:m.model.displayName()})})}));var l=String.format("Remove from Contacts");if(h.length===1&&h[0].model&&h[0].model.displayName()){if(h[0].model.isConnection()){l="Remove "+h[0].model.displayName()+" as a connection"}else{l="Remove "+h[0].model.displayName()+" from Contacts"}}var j=new UIControls.Dialog(k,{title:l});var i=this.$el;k.find(".ok-button").on("click",a.bind(function(){j.close();j.trigger("ok")},this));k.find(".cancel-button").on("click",function(){j.close()});j.open();j.on("closed",c.proxy(this.afterCloseDialog,this));return j},showMergeDialog:function(){var i=c(this.mergeDialogTemplate());var h=new UIControls.Dialog(i,{title:"Merge Contacts"});h.open();h.on("closed",c.proxy(this.afterCloseDialog,this));i.find(".yes-button").on("click",function(){h.close();h.trigger("ok")});i.find(".no-button").on("click",function(){h.close()});return h},showMessageDialog:function(h){return this._showGroupMessageDialog(this.groupMessageDialogTemplate,h)},showMessageYieldDialog:function(h){return this._showGroupMessageDialog(this.groupMessageYieldDialogTemplate,h)},_showGroupMessageDialog:function(j,h){var k=c(j({others:h}));var i=new UIControls.Dialog(k,{title:"Group message"});i.open();k.find(".ok-button").on("click",function(){i.close();i.trigger("ok")});return i},_setupScrolling:function(){var h=b.ScrollEvent.register(document.body,{topTrigger:500,bottomTrigger:750,leftTrigger:500,rightTrigger:500,debouncePeriod:50,eventName:"scrolled",windowScroll:true});c(b).scroll(a.bind(this.dock,this));c(document.body).on("scrolled",a.bind(this._onPageScrolled,this))},_onPageScrolled:function(k,j){var i=750,h=(Contacts.Apps.MergedContactsPageApp.router.isSearching)?Contacts.Constants.PageKey.SEARCH:Contacts.Constants.PageKey.MORE_CONTACTS;if(!j||this.isLoading()){return}if(j.distance.toBottom<i){this.loadNext({hideCount:false,trackTarget:h})}},loadNext:function(i){i=a.extend({hideCount:true,fireComscore:true,trackTarget:Contacts.Constants.PageKey.MORE_CONTACTS},i);var h=c.Deferred(),j=!i.trackLoadMore;if(!Contacts.DataStore.contacts.hasNext()){h.resolve();return h.promise()}this._updateAd();if(i.fireComscore){if(!d&&typeof require==="function"){d=require("externalTracking")}if(d&&d.trackWithComScore){d.trackWithComScore()}}if(i.hideCount){this.headerView.hideCount()}this.showLoader();this.contactsListView.renderNextBatch({trackTarget:i.trackTarget}).done(a.bind(function(){if(this.headerView.isSelectedAllChecked()){this.contactsListView.selectAll()}this.hideLoader();h.resolve()},this));return h.promise()},dock:function(){var h=this._topHeaderHeight||(this._topHeaderHeight=c("#top-header").outerHeight()+5);var k=c(b).scrollTop()+h;var j=this.headerView.$el.position().top;var i=c("#contact-list-navigation").position().top+36;if(k>i){this.headerView.dock()}else{this.headerView.undock()}if(this.$el.height()>600){this.$ad.toggleClass("docked",k>j)}},isLoading:function(){return this._loading},showLoader:function(){this._loading=true;this.$loader.show()},hideLoader:function(){this._loading=false;this.$loader.hide()},changeLocation:function(h){var j=Contacts.DataStore.locations.find(function(k){return k.get("region_code")===h}),i=j?j.get("name"):h;this.contactsListView.clear();Contacts.DataStore.contacts.setFilter({location:h});this.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:"location"},{type:"sub-filter",id:h,text:i}])},changeTag:function(h){this.contactsListView.clear();Contacts.DataStore.contacts.setFilter({tag_id:h});this.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:"tag"},{type:"sub-filter",id:h}])},changeTitle:function(h){this.contactsListView.clear();Contacts.DataStore.contacts.setFilter({title:h});this.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:"title"},{type:"sub-filter",id:h,text:h}])},changeSource:function(j){this.contactsListView.clear();var h=Contacts.Models.Source.getDisplayName(j);var i=Contacts.Models.Source.getSourceName(j);Contacts.DataStore.contacts.setFilter({source:i});this.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:"source"},{type:"sub-filter",id:h,text:h}])},changeCompany:function(h){this.contactsListView.clear();Contacts.DataStore.contacts.setFilter({company_id:h});this.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:"company"},{type:"sub-filter",id:h}])},handlePotentialMerge:function(){var h=this;this.mode=e.DUPLICATES;a.each(["tag","message","more"],function(i){this.headerView.actionMenuView.itemMap[i].$el.hide()},this);this.headerView.actionMenuView.show();this.showLoader();this._viewIdToMergeSetMap={};Contacts.DataStore.contacts.fetchPotentialMerges().done(function(i){a.each(i,function(j){a.each(j,function(l,m){var k=m===0;var n=h.contactsListView.addItem(l,{enableActionMenu:false,showCheckbox:k});if(k){h._viewIdToMergeSetMap[n.view.cid]=j}})});h.contactsListView.selectAll();h.headerView.selectCheckbox()}).always(function(){h.hideLoader()})}});Contacts.Views.ContactsView=f})(window,Backbone,jQuery,_);(function(c,e,d,b){var a=e.Router.extend({routes:{"?*queryString":"requestHandler"},initialize:function(f){this.initialLoad=true},_parseQueryString:function(g){var f={};if(g){b.each(b.map(g.split(/&/g),function(k,j){var h=k.split("="),m={};if(h.length>=1){var l;if(h.length===2){l=decodeURIComponent(h[1])}m[h[0]]=decodeURIComponent(l)}return m}),function(h){b.extend(f,h)})}return f},_parseParams:function(f){var g="?";b.each(f,function(h,i){g+=i+"="+encodeURIComponent(h)+"&"});return g},_getQueryString:function(f){var g;g=f.split("#?");return g[g.length-1]},requestHandler:function(){var i=this._getQueryString(c.location.href);Contacts.MetricsTracker.enabled=false;var w=this._parseQueryString(i);var g=Contacts.Apps.MergedContactsPageApp.contactsView;var q=w.contacts_source||w.source,p=w.company,y=w.title,r=w.tag,f=w.location,v=w.sortOrder,x=w.letter,t=w.searchQuery,s=w.searchQueryType,n=w.connections,l=w.fromFilter,u=w.hasQuery,h=w.pathId,m=w.filter,k=w.merge,j={};g.contactsListView.clear();if(v){g.setSortOrder(v)}if(!x&&Contacts.Lix.get("filter-by-letter-enabled")){g.resetScrubberLetter()}if(k){g.setPath([{type:"filter",id:"duplicates"}]);g.handlePotentialMerge()}else{if(x&&Contacts.Lix.get("filter-by-letter-enabled")){g.resetFilters();g.setScrubberLetter(x)}else{if(t){var o={};s=s?s:"name";o[s]=t;if(s==="name"){}else{g.headerView.filterDropdownView.navigationView.setPath([{type:"filter",id:s},{type:"sub-filter",text:t}],{silent:true});g.headerView.filterDropdownView.setMenuSubtext(t)}Contacts.DataStore.contacts.setSearchQuery(o)}else{if(q){if(n==="enabled"){g.setPath([{type:"filter",id:"connections"}],true);g.headerView.filterDropdownView.updateMenuSubtext();Contacts.DataStore.contacts.setFilter({sortOrder:Contacts.DataStore.contacts.getSortOrderKey(),source:q})}else{g.changeSource(q)}}else{if(p){g.changeCompany(parseInt(p,10)||p)}else{if(y){g.changeTitle(y)}else{if(r){g.changeTag(parseInt(r,10)||r)}else{if(f){f=f.replace(/\+/g," ");g.changeLocation(f)}else{if(!!u){d.each(w,function(z,A){if(!(z==="fromFilter"||z==="hasQuery"||z==="sortOrder")){j[z]=A}});g.setPath([{type:"filter",id:h?h:"all"}],true);g.headerView.filterDropdownView.updateMenuSubtext();Contacts.DataStore.contacts.setFilter(j)}else{if(m){if(m==="saved"){g.setPath([{type:"filter",id:"saved"}],true);Contacts.DataStore.contacts.setFilter({bookmarked:true});g.headerView._updateCount();g.headerView.filterDropdownView.updateMenuSubtext()}else{g.setPath([{type:"filter",id:"all"}],true);Contacts.DataStore.contacts.setFilter()}}else{g.setPath([{type:"filter",id:"all"}]);Contacts.DataStore.contacts.setFilter()}}}}}}}}}}if(x){this.isSearching=true}else{this.isSearching=false}if(!k){if(this.initialLoad){g._resetHeaderAndLoadNext(false)}else{if(t||x){g._resetHeaderAndLoadNext(Contacts.Constants.PageKey.SEARCH)}else{g._resetHeaderAndLoadNext(Contacts.Constants.PageKey.CONTACTS)}}}Contacts.MetricsTracker.enabled=true;this.initialLoad=false},goHash:function(f){this.navigate(f,true)},buildNewHash:function(v){var h=Contacts.Apps.MergedContactsPageApp.contactsView,o=c.location.hash.replace("#?",""),s=this._parseQueryString(o),y={},t=v.contacts_source,n=v.source,m=v.company,x=v.title,p=v.tag,f=v.location,u=v.sortOrder,w=v.letter,r=v.searchQuery,q=v.searchQueryType,l=v.connections,k=v.fromFilter,i=v.query,g=v.pathId,j=v.merge;if(u){y.sortOrder=u}if(k){y.fromFilter=k}if(l){y.connections=l}else{if(s.connections){y.connections=s.connections}}if(j){y.merge=j}else{if(w&&Contacts.Lix.get("filter-by-letter-enabled")){y.letter=w}else{if(r){y.searchQuery=r;y.searchQueryType=q?q:"name"}else{if(t){y.contacts_source=t}else{if(n){y.source=n}else{if(m){y.company=m}else{if(x){y.title=x}else{if(p){y.tag=p}else{if(f){y.location=f}else{if(i){d.each(i,function(z,A){y[z]=A});y.hasQuery=true;if(g){y.pathId=g}else{if(h.headerView.filterDropdownView.navigationView.getPath()){y.pathId=h.headerView.filterDropdownView.navigationView.getPath()[0].id}}}}}}}}}}}}return this._parseParams(y)},checkEngageEvent:function(){var h=Connected.Utils.queryStringAsObject();if(h.id&&h.type){var g=Contacts.Triggers[h.type];if(g){var f=new g();f.start(h)}}}});Contacts.Routers.ContactsRouter=a})(window,Backbone,jQuery,_);(function(c,f,e,a){var b=Fiber.extend(function(){return{init:function(){e(a.bind(this.onDomReady,this))},onDomReady:function(){this.bindEvents()},bindEvents:function(){}}});var d=new (b.extend(function(g){return{version:"1.0.0",init:function(){Contacts.MetricsTracker=new MetricsTracker();this.setupUser();this.setupCollections();this.setupControllers();g.init.call(this)},setupUser:function(){Contacts.DataStore.user=new Contacts.Models.User();Contacts.DataStore.user.fetch()},setupControllers:function(){this.pageHeaderMenu=new Contacts.Views.PageHeaderMenuView();this.contactsView=new Contacts.Views.ContactsView();this.engagementView=new Contacts.Views.EngagementListView();this.router=new Contacts.Routers.ContactsRouter();this.syncPromo=new Contacts.Views.SyncPromoView();this.tourView=new Contacts.Views.TourView()},onDomReady:function(){this.pageHeaderMenu.render();this.contactsView.render();this.engagementView.render();this.engagementView.on("engagement-rendered",a.bind(function(){if(Contacts.Lix.get("display-promo")){this.showPromo(true)}else{if(Contacts.Lix.get("display-tour-promo")){if(!this.tourView.hasStarted()){if(Contacts.Lix.get("display-second-tour-promo")){this.tourView.startTour(false)}else{this.tourView.startTour(true)}}else{this.tourView.refresh()}}else{if(Contacts.Lix.get("display-mobile-promo")){this.engagementView.renderEngagementMobilePromo()}}}},this));this.engagementView.on("no-engagements",a.bind(function(){if(Contacts.Lix.get("display-promo")){this.showPromo(false)}else{if(Contacts.Lix.get("display-tour-promo")){if(!this.tourView.hasStarted()){this.tourView.startTour(false)}else{this.tourView.refresh()}}}},this));this.syncPromo.render();this.pageHeaderMenu.on("click:sync",a.bind(function(){if(this.tourView&&this.tourView.hasStarted()){this.tourView.closeTour()}if(this.engagementView&&this.engagementView.syncPromoEngagementView){this.engagementView.syncPromoEngagementView.hide()}this.syncPromo.show()},this));if(Contacts.Lix.get("display-profile-organizer-alert")){this.profileOrganizerAlert=new Contacts.Views.ProfileOrganizerAlertView()}f.history.start();if(!c.location.hash&&c.location.search){this.router.goHash("#"+c.location.search)}if(!c.location.hash&&!c.location.search){this.router.goHash("#?filter=recent")}this.router.checkEngageEvent();g.onDomReady.call(this)},showPromo:function(h){var j=Contacts.Lix.get("promo-shown"),i=Contacts.Lix.get("promo-type");if(this.engagementView.syncPromoEngagementView){this.engagementView.syncPromoEngagementView.hide()}if(this.syncPromo){this.syncPromo.hide()}if(!j){this.syncPromo.show()}else{if(!h){this.syncPromo.show()}else{this.engagementView.renderEngagementSyncPromo({type:i})}}},bindEvents:function(){},setupCollections:function(){Contacts.DataStore.contacts=new Contacts.Collections.Contacts();Contacts.DataStore.tags=new Contacts.Collections.Tags([],{isContactItemTags:true});Contacts.DataStore.companies=new Contacts.Collections.Companies();Contacts.DataStore.locations=new Contacts.Collections.Locations();Contacts.DataStore.toplocations=new Contacts.Collections.Locations();Contacts.DataStore.sources=new Contacts.Collections.Sources();Contacts.DataStore.engagements=new Contacts.Collections.Engagements();Contacts.DataStore.agenda=new Contacts.Collections.Agenda()}}}))();Contacts.Apps.MergedContactsPageApp=d})(window,Backbone,jQuery,_);